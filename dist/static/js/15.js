webpackJsonp([15,32],{288:function(e,a,t){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(a,"__esModule",{value:!0});var r=t(45),l=i(r),o=t(37),n=i(o),c=t(36),s=i(c),u=t(10),d=i(u),p=t(33),g=(i(p),t(30)),A=i(g),f=t(13),v=(i(f),t(11)),m=i(v),h=t(14),C=(i(h),t(12)),b=i(C),w=t(9),x=(i(w),t(5)),B=(i(x),t(8)),y=i(B),_=t(4),R=i(_),k=t(1),E=i(k),S=t(22),D=i(S),I=t(17),z=i(I),P=t(7),T=i(P),O=t(19),G=i(O);E.default.use(y.default),E.default.use(b.default),E.default.use(m.default),z.default.use(D.default),E.default.use(A.default),E.default.component("gv-scuoladigitale-ricerca-results",function(){return new d.default(function(e){t.e(39,function(a){e(t(681))})})}),E.default.component("gv-scuoladigitale-info",function(){return new d.default(function(e){t.e(35,function(a){e(t(189))})})}),a.default={name:"gv-scuoladigitale-ricerca",data:function(){return{tipi:[{id:"scuola",label:"Ricerca per nome scuola"},{id:"temi",label:"Ricerca per parole chiave"}],tipo:"scuola",ordini:[],scuole:[],layers:["scuole_01","scuole_02","scuole_03","scuole_04","scuole_06","scuole_07"],propertyName:"DENOMINAZIONE",results:[],listaOrdini:[],parole:[],listaParole:[],listaProgetti:[],scuola:null,listaScuole:[],loading:!1,show:!1,showRicercaScuola:!0,showRicercaTemi:!1,markerArray:[]}},mounted:function(){var e=this;return(0,s.default)(n.default.mark(function a(){var t,i;return n.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,R.default.get("/geoservices/REST/scuola/ordini");case 2:return t=a.sent,a.next=5,t.data.data;case 5:return e.listaOrdini=a.sent,a.next=8,R.default.get("/geoservices/REST/scuola/parole");case 8:return i=a.sent,a.next=11,i.data.data;case 11:e.listaParole=a.sent,GV.eventBus.$on("scuoladigitale-close-panel",function(a){a.flagRicerca&&e.reset()});case 13:case"end":return a.stop()}},a,e)}))()},methods:{changeTipo:function(e){this.reset(),"scuola"===e&&(this.showRicercaScuola=!0,this.showRicercaTemi=!1),"temi"===e&&(this.showRicercaScuola=!1,this.showRicercaTemi=!0)},search:function(e){this.results=[],e.length<3||(this.results=this.filterData(e))},filterData:function(e){var a=this,t=[];return e=e.replace(/[*+?^${}()|[\]\\]/g,""),""===e?[]:(this.layers.forEach(function(i){GV.app.map.eachLayer(function(r){r.name===i&&r instanceof L.LayerGroup&&r.eachLayer(function(i){var r=i.getLatLng();r.layer=i;var l=i.feature.properties[a.propertyName];if(new RegExp(e,"i").test(l)){var o=a.additionalLabel?i.feature.properties[a.additionalLabel]:null,n=a.additionalLabel?l+" ("+o+")":l,c=i.feature.properties.COD_MECC;t.push({label:n,value:c,location:r})}})})}),t)},onChange:function(e){this.scuola=e,this.listaScuole=[e]},submit:function(){var e=this;return(0,s.default)(n.default.mark(function a(){var t,i,r,l,o,c;return n.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(e.closeResultPanels(),"temi"!==e.tipo){a.next=19;break}if(0!==e.parole.length){a.next=5;break}return(0,G.default)("Selezionare almeno una parola chiave","warning"),a.abrupt("return");case 5:return t=document.getElementById("gv-scuoladigitale-ricerca"),i=A.default.service({text:"Ricerca in corso...",target:t}),r=e.ordini.join(","),l=e.parole.join(","),a.next=11,R.default.get("/geoservices/REST/scuola/ricerca?ordini="+r+"&parole="+l);case 11:return o=a.sent,i&&i.close(),a.next=15,o.data.data;case 15:c=a.sent,c&&(e.listaProgetti=c.progetti,e.listaScuole=c.scuole,e.showResults(),e.filtraMappa(!1)),a.next=24;break;case 19:if(e.scuola){a.next=22;break}return(0,G.default)("Selezionare una scuola tramite la ricerca","warning"),a.abrupt("return");case 22:e.showInfo(),e.filtraMappa(!0);case 24:case"end":return a.stop()}},a,e)}))()},reset:function(){GV.globals.SCUOLA_DIGITALE_LAYERS.forEach(function(e){GV.config.removeLayer(e.name),e.filter=function(){return!0},GV.config.addLayerToMap(e,0)}),this.listaProgetti=[],this.listaScuole=[],this.scuole=[],this.scuola=null,this.results=[],this.ordini=[],this.parole=[],this.closeResultPanels()},closeResultPanels:function(){var e=document.getElementById("gv-scuoladigitale-ricerca-results");e&&e.parentNode.removeChild(e);var a=document.getElementById("gv-scuoladigitale-info");a&&a.parentNode.removeChild(a)},showInfo:function(){(0,T.default)({elId:"gv-scuoladigitale-info",clear:!0,vm:new E.default({template:'<gv-scuoladigitale-info :id="id" title="RISULTATO RICERCA" :flagRicerca="flagRicerca"></gv-scuoladigitale-info>',data:{id:this.scuola,flagRicerca:!0}})})},showResults:function(){(0,T.default)({elId:"gv-scuoladigitale-ricerca-results",clear:!0,vm:new E.default({template:'<gv-scuoladigitale-ricerca-results :listaProgetti="listaProgetti"></gv-scuoladigitale-ricerca-results>',data:{listaProgetti:this.listaProgetti}})})},filtraMappa:function(e){var a=this;this.markerArray=[],GV.globals.SCUOLA_DIGITALE_LAYERS.forEach(function(t){GV.config.removeLayer(t.name),t.filter=function(t){if(a.scuolaInListaScuole(t,e))return!0},GV.config.addLayerToMap(t,0)})},scuolaInListaScuole:function(e,a){var t=!1,i=!0,r=!1,o=void 0;try{for(var n,c=(0,l.default)(this.listaScuole);!(i=(n=c.next()).done);i=!0){var s=n.value;if(e.properties.COD_MECC===s){t=!0,a&&GV.app.map.setView([e.geometry.coordinates[1],e.geometry.coordinates[0]],14);break}}}catch(e){r=!0,o=e}finally{try{!i&&c.return&&c.return()}finally{if(r)throw o}}return t},handleLink:function(e,a){window.open(a)},hidePanel:function(e){this.show?(document.getElementById("gv-scuoladigitale-ricerca-body").style.display="block",document.getElementById("gv-scuoladigitale-ricerca").style.width="480px"):(document.getElementById("gv-scuoladigitale-ricerca-body").style.display="none",document.getElementById("gv-scuoladigitale-ricerca").style.width="190px"),this.show=!this.show},toggleCollapseClass:function(){return this.show?"gv-scuoladigitale-ricerca-collapse gv-color-scheme el-icon-arrow-down":"gv-scuoladigitale-ricerca-collapse gv-color-scheme el-icon-arrow-up"}}}},459:function(e,a,t){a=e.exports=t(2)(),a.push([e.id,".el-tree-node__label{font-size:12px!important}.el-tabs__header,.el-tabs__item.is-active{color:#24386c!important}.el-tabs__header{margin:0 0 5px!important}.el-select .el-input .el-select__caret{color:#000!important;font-size:16px!important;font-weight:800}","",{version:3,sources:["/./src/components/ScuolaDigitaleRicerca.vue"],names:[],mappings:"AACA,qBACE,wBAA2B,CAC5B,AAID,0CAFE,uBAA0B,CAK3B,AAHD,iBACE,wBAA2B,CAE5B,AACD,uCACE,qBAAwB,AACxB,yBAA2B,AAC3B,eAAiB,CAClB",file:"ScuolaDigitaleRicerca.vue",sourcesContent:["\n.el-tree-node__label {\r\n  font-size: 12px !important;\n}\n.el-tabs__item.is-active {\r\n  color: #24386c !important;\n}\n.el-tabs__header {\r\n  margin: 0 0 5px !important;\r\n  color: #24386c !important;\n}\n.el-select .el-input .el-select__caret {\r\n  color: black !important;\r\n  font-size: 16px !important;\r\n  font-weight: 800;\n}\r\n"],sourceRoot:"webpack://"}])},460:function(e,a,t){a=e.exports=t(2)(),a.push([e.id,".gv-scuoladigitale-ricerca[data-v-620305d3]{position:absolute;left:0;top:0;width:480px;margin-left:10px;margin-top:50px;z-index:800}.gv-scuoladigitale-ricerca-title[data-v-620305d3]{position:relative;display:block;padding:.3rem 0 .3rem .5rem;margin-bottom:-1px;color:#000;cursor:default;font-weight:800;font-family:Raleway,Arial,sans-serif!important;font-size:14px}.gv-scuoladigitale-ricerca-title [data-v-620305d3]:focus{outline:0 auto -webkit-focus-ring-color}.gv-scuoladigitale-ricerca-body[data-v-620305d3]{margin:10px}.gv-scuoladigitale-ricerca-label[data-v-620305d3]{display:inline-block;width:150px}.gv-scuoladigitale-ricerca-buttons[data-v-620305d3],.gv-scuoladigitale-ricerca-result[data-v-620305d3]{margin-top:10px;margin-left:5px}.gv-scuoladigitale-ricerca-collapse[data-v-620305d3]{cursor:pointer;border:0;-webkit-appearance:none;float:right;font-size:14px;margin-top:3px;opacity:1}","",{version:3,sources:["/./src/components/ScuolaDigitaleRicerca.vue"],names:[],mappings:"AACA,4CACE,kBAAmB,AACnB,OAAQ,AACR,MAAO,AACP,YAAa,AACb,iBAAkB,AAClB,gBAAiB,AACjB,WAAa,CACd,AACD,kDACE,kBAAmB,AACnB,cAAe,AAIf,4BAAqB,AACrB,mBAAoB,AACpB,WAAa,AACb,eAAgB,AAChB,gBAAiB,AACjB,+CAAqD,AACrD,cAAgB,CACjB,AACD,yDACE,uCAA2C,CAC5C,AACD,iDACE,WAAa,CACd,AACD,kDACE,qBAAsB,AACtB,WAAa,CACd,AAKD,uGACE,gBAAiB,AACjB,eAAiB,CAClB,AACD,qDACE,eAAgB,AAChB,SAAU,AACV,wBAAyB,AACzB,YAAa,AACb,eAAgB,AAChB,eAAgB,AAChB,SAAW,CACZ",file:"ScuolaDigitaleRicerca.vue",sourcesContent:["\n.gv-scuoladigitale-ricerca[data-v-620305d3] {\r\n  position: absolute;\r\n  left: 0;\r\n  top: 0;\r\n  width: 480px;\r\n  margin-left: 10px;\r\n  margin-top: 50px;\r\n  z-index: 800;\n}\n.gv-scuoladigitale-ricerca-title[data-v-620305d3] {\r\n  position: relative;\r\n  display: block;\r\n  padding-top: 0.3rem;\r\n  padding-bottom: 0.3rem;\r\n  padding-right: 0rem;\r\n  padding-left: 0.5rem;\r\n  margin-bottom: -1px;\r\n  color: black;\r\n  cursor: default;\r\n  font-weight: 800;\r\n  font-family: 'Raleway', Arial, sans-serif !important;\r\n  font-size: 14px;\n}\n.gv-scuoladigitale-ricerca-title [data-v-620305d3]:focus {\r\n  outline: -webkit-focus-ring-color auto 0px;\n}\n.gv-scuoladigitale-ricerca-body[data-v-620305d3] {\r\n  margin: 10px;\n}\n.gv-scuoladigitale-ricerca-label[data-v-620305d3] {\r\n  display: inline-block;\r\n  width: 150px;\n}\n.gv-scuoladigitale-ricerca-buttons[data-v-620305d3] {\r\n  margin-top: 10px;\r\n  margin-left: 5px;\n}\n.gv-scuoladigitale-ricerca-result[data-v-620305d3] {\r\n  margin-top: 10px;\r\n  margin-left: 5px;\n}\n.gv-scuoladigitale-ricerca-collapse[data-v-620305d3] {\r\n  cursor: pointer;\r\n  border: 0;\r\n  -webkit-appearance: none;\r\n  float: right;\r\n  font-size: 14px;\r\n  margin-top: 3px;\r\n  opacity: 1;\n}\r\n"],sourceRoot:"webpack://"}])},564:function(e,a,t){var i=t(459);"string"==typeof i&&(i=[[e.id,i,""]]);t(3)(i,{});i.locals&&(e.exports=i.locals)},565:function(e,a,t){var i=t(460);"string"==typeof i&&(i=[[e.id,i,""]]);t(3)(i,{});i.locals&&(e.exports=i.locals)},680:function(e,a,t){var i,r;t(565),t(564),i=t(288);var l=t(760);r=i=i||{},"object"!=typeof i.default&&"function"!=typeof i.default||(r=i=i.default),"function"==typeof r&&(r=r.options),r.render=l.render,r.staticRenderFns=l.staticRenderFns,r._scopeId="data-v-620305d3",e.exports=i},760:function(e,a){e.exports={render:function(){var e=this;e.$createElement;return e._c("div",{staticClass:"gv-scuoladigitale-ricerca gv-inverted-color-scheme",attrs:{id:"gv-scuoladigitale-ricerca"}},[e._c("div",{directives:[{name:"draggable",rawName:"v-draggable"}],staticClass:"gv-scuoladigitale-ricerca-title gv-color-scheme",attrs:{id:"gv-scuoladigitale-ricerca-title"}},[e._c("b",[e._v("RICERCHE TEMATICHE")]),e._v(" "),e._c("button",{class:e.toggleCollapseClass(),attrs:{size:"mini",title:"Nascondi Pannello"},on:{click:e.hidePanel}})]),e._v(" "),e._c("div",{staticClass:"gv-scuoladigitale-ricerca-body",attrs:{id:"gv-scuoladigitale-ricerca-body"}},[e._c("el-select",{staticStyle:{"margin-bottom":"5px !important"},attrs:{placeholder:"Scegli Visualizzazione",size:"small"},on:{change:e.changeTipo},model:{value:e.tipo,callback:function(a){e.tipo=a},expression:"tipo"}},e._l(e.tipi,function(a){return e._c("el-option",{key:a.id,attrs:{value:a.id,label:a.label}})})),e._v(" "),e._c("div",{directives:[{name:"show",rawName:"v-show",value:e.showRicercaScuola,expression:"showRicercaScuola"}],attrs:{id:"gv-scuoladigitale-ricerca-scuola"}},[e._c("el-select",{staticStyle:{width:"370px !important"},attrs:{id:"gv-seach-input",filterable:"",clearable:"",remote:"",size:"small",placeholder:"Ricerca per nome scuola...","remote-method":e.search,loading:e.loading,"loading-text":"Caricamento... ","no-match-text":"Nessun elemento trovato","no-data-text":"Nessun elemento trovato"},on:{change:e.onChange},model:{value:e.scuola,callback:function(a){e.scuola=a},expression:"scuola"}},e._l(e.results,function(a){return e._c("el-option",{key:a.value,attrs:{label:a.label,value:a.value}})}))],1),e._v(" "),e._c("div",{directives:[{name:"show",rawName:"v-show",value:e.showRicercaTemi,expression:"showRicercaTemi"}],attrs:{id:"gv-scuoladigitale-ricerca-temi"}},[e._c("el-select",{staticStyle:{width:"170px !important"},attrs:{size:"small","collapse-tags":"",multiple:"",placeholder:"Ordine Scuola"},model:{value:e.ordini,callback:function(a){e.ordini=a},expression:"ordini"}},e._l(e.listaOrdini,function(a){return e._c("el-option",{key:a.id,attrs:{value:a.id,label:a.label}})})),e._v(" "),e._c("el-select",{staticStyle:{width:"270px !important"},attrs:{size:"small",multiple:"",filterable:"","collapse-tags":"",placeholder:"Parole Chiave"},model:{value:e.parole,callback:function(a){e.parole=a},expression:"parole"}},e._l(e.listaParole,function(a){return e._c("el-option",{key:a.id,attrs:{value:a.id,label:a.label}})}))],1),e._v(" "),e._c("div",{staticClass:"gv-scuoladigitale-ricerca-buttons"},[e._c("el-button",{attrs:{id:"gv-scuoladigitale-ricerca-submit",type:"info",size:"mini"},on:{click:e.submit}},[e._v("Conferma")]),e._v(" "),e._c("el-button",{attrs:{id:"gv-scuoladigitale-ricerca-reset",type:"info",size:"mini"},on:{click:e.reset}},[e._v("Annulla Selezione")])],1)],1)])},staticRenderFns:[]}}});
//# sourceMappingURL=15.js.map