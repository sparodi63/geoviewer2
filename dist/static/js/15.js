webpackJsonp([15,38],{320:function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(32),l=i(r),o=a(22),n=i(o),c=a(21),s=i(c),u=a(10),d=i(u),p=a(24),f=(i(p),a(23)),A=i(f),g=a(14),m=(i(g),a(12)),v=i(m),h=a(15),C=(i(h),a(13)),b=i(C),B=a(9),x=(i(B),a(5)),w=(i(x),a(8)),y=i(w),_=a(2),R=i(_),k=a(1),E=i(k),D=a(17),S=i(D),I=a(11),z=i(I),T=a(7),P=i(T),O=a(16),N=i(O);E.default.use(y.default),E.default.use(b.default),E.default.use(v.default),z.default.use(S.default),E.default.use(A.default),E.default.component("gv-scuoladigitale-ricerca-results",function(){return new d.default(function(e){a.e(42,function(t){e(a(207))})})}),E.default.component("gv-scuoladigitale-info",function(){return new d.default(function(e){a.e(41,function(t){e(a(148))})})}),t.default={name:"gv-scuoladigitale-ricerca",data:function(){return{tipi:[{id:"scuola",label:"Ricerca per nome scuola"},{id:"temi",label:"Ricerca per parole chiave"}],tipo:"scuola",ordini:[],scuole:[],layers:["scuole_01","scuole_02","scuole_03","scuole_04","scuole_06","scuole_07"],propertyName:"DENOMINAZIONE",results:[],listaOrdini:[],parole:[],listaParole:[],listaProgetti:[],scuola:null,listaScuole:[],loading:!1,show:!1,showRicercaScuola:!0,showRicercaTemi:!1,markerArray:[]}},mounted:function(){var e=this;return(0,s.default)(n.default.mark(function t(){var a,i;return n.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,R.default.get("/geoservices/REST/scuola/ordini");case 2:return a=t.sent,t.next=5,a.data.data;case 5:return e.listaOrdini=t.sent,t.next=8,R.default.get("/geoservices/REST/scuola/parole");case 8:return i=t.sent,t.next=11,i.data.data;case 11:e.listaParole=t.sent,GV.eventBus.$on("scuoladigitale-close-panel",function(t){t.flagRicerca&&e.reset()});case 13:case"end":return t.stop()}},t,e)}))()},methods:{changeTipo:function(e){this.reset(),"scuola"===e&&(this.showRicercaScuola=!0,this.showRicercaTemi=!1),"temi"===e&&(this.showRicercaScuola=!1,this.showRicercaTemi=!0)},search:function(e){this.results=[],e.length<3||(this.results=this.filterData(e))},filterData:function(e){var t=this,a=[];return e=e.replace(/[*+?^${}()|[\]\\]/g,""),""===e?[]:(this.layers.forEach(function(i){GV.app.map.eachLayer(function(r){r.name===i&&r instanceof L.LayerGroup&&r.eachLayer(function(i){var r=i.getLatLng();r.layer=i;var l=i.feature.properties[t.propertyName];if(new RegExp(e,"i").test(l)){var o=t.additionalLabel?i.feature.properties[t.additionalLabel]:null,n=t.additionalLabel?l+" ("+o+")":l,c=i.feature.properties.COD_MECC;a.push({label:n,value:c,location:r})}})})}),a)},onChange:function(e){this.scuola=e,this.listaScuole=[e]},submit:function(){var e=this;return(0,s.default)(n.default.mark(function t(){var a,i,r,l,o,c;return n.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.closeResultPanels(),"temi"!==e.tipo){t.next=19;break}if(0!==e.parole.length){t.next=5;break}return(0,N.default)("Selezionare almeno una parola chiave","warning"),t.abrupt("return");case 5:return a=document.getElementById("gv-scuoladigitale-ricerca"),i=A.default.service({text:"Ricerca in corso...",target:a}),r=e.ordini.join(","),l=e.parole.join(","),t.next=11,R.default.get("/geoservices/REST/scuola/ricerca?ordini="+r+"&parole="+l);case 11:return o=t.sent,i&&i.close(),t.next=15,o.data.data;case 15:c=t.sent,c&&(e.listaProgetti=c.progetti,e.listaScuole=c.scuole,e.showResults(),e.filtraMappa(!1)),t.next=24;break;case 19:if(e.scuola){t.next=22;break}return(0,N.default)("Selezionare una scuola tramite la ricerca","warning"),t.abrupt("return");case 22:e.showInfo(),e.filtraMappa(!0);case 24:case"end":return t.stop()}},t,e)}))()},reset:function(){GV.globals.SCUOLA_DIGITALE_LAYERS.forEach(function(e){GV.config.removeLayer(e.name),e.filter=function(){return!0},GV.config.addLayerToMap(e,0)}),this.listaProgetti=[],this.listaScuole=[],this.scuole=[],this.scuola=null,this.results=[],this.ordini=[],this.parole=[],this.closeResultPanels()},closeResultPanels:function(){var e=document.getElementById("gv-scuoladigitale-ricerca-results");e&&e.parentNode.removeChild(e);var t=document.getElementById("gv-scuoladigitale-info");t&&t.parentNode.removeChild(t)},showInfo:function(){(0,P.default)({elId:"gv-scuoladigitale-info",clear:!0,vm:new E.default({template:'<gv-scuoladigitale-info :id="id" title="RISULTATO RICERCA" :flagRicerca="flagRicerca"></gv-scuoladigitale-info>',data:{id:this.scuola,flagRicerca:!0}})})},showResults:function(){(0,P.default)({elId:"gv-scuoladigitale-ricerca-results",clear:!0,vm:new E.default({template:'<gv-scuoladigitale-ricerca-results :listaProgetti="listaProgetti"></gv-scuoladigitale-ricerca-results>',data:{listaProgetti:this.listaProgetti}})})},filtraMappa:function(e){var t=this;this.markerArray=[],GV.globals.SCUOLA_DIGITALE_LAYERS.forEach(function(a){GV.config.removeLayer(a.name),a.filter=function(a){if(t.scuolaInListaScuole(a,e))return!0},GV.config.addLayerToMap(a,0)})},scuolaInListaScuole:function(e,t){var a=!1,i=!0,r=!1,o=void 0;try{for(var n,c=(0,l.default)(this.listaScuole);!(i=(n=c.next()).done);i=!0){var s=n.value;if(e.properties.COD_MECC===s){a=!0,t&&GV.app.map.setView([e.geometry.coordinates[1],e.geometry.coordinates[0]],14);break}}}catch(e){r=!0,o=e}finally{try{!i&&c.return&&c.return()}finally{if(r)throw o}}return a},handleLink:function(e,t){window.open(t)},hidePanel:function(e){this.show?(document.getElementById("gv-scuoladigitale-ricerca-body").style.display="block",document.getElementById("gv-scuoladigitale-ricerca").style.width="480px"):(document.getElementById("gv-scuoladigitale-ricerca-body").style.display="none",document.getElementById("gv-scuoladigitale-ricerca").style.width="190px"),this.show=!this.show},toggleCollapseClass:function(){return this.show?"gv-scuoladigitale-ricerca-collapse gv-color-scheme el-icon-arrow-down":"gv-scuoladigitale-ricerca-collapse gv-color-scheme el-icon-arrow-up"}}}},476:function(e,t,a){t=e.exports=a(3)(),t.push([e.id,".el-tree-node__label{font-size:12px!important}.el-tabs__header,.el-tabs__item.is-active{color:#24386c!important}.el-tabs__header{margin:0 0 5px!important}.el-select .el-input .el-select__caret{color:#000!important;font-size:16px!important;font-weight:800}","",{version:3,sources:["/./src/components/ScuolaDigitaleRicerca.vue"],names:[],mappings:"AACA,qBACE,wBAA2B,CAC5B,AAID,0CAFE,uBAA0B,CAK3B,AAHD,iBACE,wBAA2B,CAE5B,AACD,uCACE,qBAAwB,AACxB,yBAA2B,AAC3B,eAAiB,CAClB",file:"ScuolaDigitaleRicerca.vue",sourcesContent:["\n.el-tree-node__label {\r\n  font-size: 12px !important;\n}\n.el-tabs__item.is-active {\r\n  color: #24386c !important;\n}\n.el-tabs__header {\r\n  margin: 0 0 5px !important;\r\n  color: #24386c !important;\n}\n.el-select .el-input .el-select__caret {\r\n  color: black !important;\r\n  font-size: 16px !important;\r\n  font-weight: 800;\n}\r\n"],sourceRoot:"webpack://"}])},477:function(e,t,a){t=e.exports=a(3)(),t.push([e.id,".gv-scuoladigitale-ricerca[data-v-1e219fef]{position:absolute;left:0;top:0;width:480px;margin-left:10px;margin-top:50px;z-index:800}.gv-scuoladigitale-ricerca-title[data-v-1e219fef]{position:relative;display:block;padding:.3rem 0 .3rem .5rem;margin-bottom:-1px;color:#fff;cursor:default;font-weight:800;font-family:Titillium Web,Arial,sans-serif!important;font-size:14px}.gv-scuoladigitale-ricerca-title [data-v-1e219fef]:focus{outline:0 auto -webkit-focus-ring-color}.gv-scuoladigitale-ricerca-body[data-v-1e219fef]{margin:10px}.gv-scuoladigitale-ricerca-label[data-v-1e219fef]{display:inline-block;width:150px}.gv-scuoladigitale-ricerca-buttons[data-v-1e219fef]{margin-top:10px;margin-left:5px}.gv-scuoladigitale-ricerca-buttons button[data-v-1e219fef]{font-family:Titillium Web,Arial,sans-serif!important;font-weight:800;color:#fff;background-color:#105b70;border:none;padding:2px 10px;padding-bottom:4px;margin-right:10px;border-radius:3px}.gv-scuoladigitale-ricerca-result[data-v-1e219fef]{margin-top:10px;margin-left:5px}.gv-scuoladigitale-ricerca-collapse[data-v-1e219fef]{cursor:pointer;border:0;-webkit-appearance:none;float:right;font-size:14px;margin-top:3px;opacity:1}","",{version:3,sources:["/./src/components/ScuolaDigitaleRicerca.vue"],names:[],mappings:"AACA,4CACE,kBAAmB,AACnB,OAAQ,AACR,MAAO,AACP,YAAa,AACb,iBAAkB,AAClB,gBAAiB,AACjB,WAAa,CACd,AACD,kDACE,kBAAmB,AACnB,cAAe,AAIf,4BAAqB,AACrB,mBAAoB,AACpB,WAAa,AACb,eAAgB,AAChB,gBAAiB,AACjB,qDAA2D,AAC3D,cAAgB,CACjB,AACD,yDACE,uCAA2C,CAC5C,AACD,iDACE,WAAa,CACd,AACD,kDACE,qBAAsB,AACtB,WAAa,CACd,AACD,oDACE,gBAAiB,AACjB,eAAiB,CAClB,AACD,2DACE,qDAA2D,AAC3D,gBAAiB,AACjB,WAAa,AACb,yBAA0B,AAC1B,YAAa,AACb,iBAAkB,AAClB,mBAAoB,AACpB,kBAAmB,AACnB,iBAAmB,CACpB,AACD,mDACE,gBAAiB,AACjB,eAAiB,CAClB,AACD,qDACE,eAAgB,AAChB,SAAU,AACV,wBAAyB,AACzB,YAAa,AACb,eAAgB,AAChB,eAAgB,AAChB,SAAW,CACZ",file:"ScuolaDigitaleRicerca.vue",sourcesContent:["\n.gv-scuoladigitale-ricerca[data-v-1e219fef] {\r\n  position: absolute;\r\n  left: 0;\r\n  top: 0;\r\n  width: 480px;\r\n  margin-left: 10px;\r\n  margin-top: 50px;\r\n  z-index: 800;\n}\n.gv-scuoladigitale-ricerca-title[data-v-1e219fef] {\r\n  position: relative;\r\n  display: block;\r\n  padding-top: 0.3rem;\r\n  padding-bottom: 0.3rem;\r\n  padding-right: 0rem;\r\n  padding-left: 0.5rem;\r\n  margin-bottom: -1px;\r\n  color: white;\r\n  cursor: default;\r\n  font-weight: 800;\r\n  font-family: 'Titillium Web', Arial, sans-serif !important;\r\n  font-size: 14px;\n}\n.gv-scuoladigitale-ricerca-title [data-v-1e219fef]:focus {\r\n  outline: -webkit-focus-ring-color auto 0px;\n}\n.gv-scuoladigitale-ricerca-body[data-v-1e219fef] {\r\n  margin: 10px;\n}\n.gv-scuoladigitale-ricerca-label[data-v-1e219fef] {\r\n  display: inline-block;\r\n  width: 150px;\n}\n.gv-scuoladigitale-ricerca-buttons[data-v-1e219fef] {\r\n  margin-top: 10px;\r\n  margin-left: 5px;\n}\n.gv-scuoladigitale-ricerca-buttons button[data-v-1e219fef] {\r\n  font-family: 'Titillium Web', Arial, sans-serif !important;\r\n  font-weight: 800;\r\n  color: white;\r\n  background-color: #105b70;\r\n  border: none;\r\n  padding: 2px 10px;\r\n  padding-bottom: 4px;\r\n  margin-right: 10px;\r\n  border-radius: 3px;\n}\n.gv-scuoladigitale-ricerca-result[data-v-1e219fef] {\r\n  margin-top: 10px;\r\n  margin-left: 5px;\n}\n.gv-scuoladigitale-ricerca-collapse[data-v-1e219fef] {\r\n  cursor: pointer;\r\n  border: 0;\r\n  -webkit-appearance: none;\r\n  float: right;\r\n  font-size: 14px;\r\n  margin-top: 3px;\r\n  opacity: 1;\n}\r\n"],sourceRoot:"webpack://"}])},572:function(e,t,a){var i=a(476);"string"==typeof i&&(i=[[e.id,i,""]]);a(4)(i,{});i.locals&&(e.exports=i.locals)},573:function(e,t,a){var i=a(477);"string"==typeof i&&(i=[[e.id,i,""]]);a(4)(i,{});i.locals&&(e.exports=i.locals)},781:function(e,t,a){var i,r;a(573),a(572),i=a(320);var l=a(830);r=i=i||{},"object"!=typeof i.default&&"function"!=typeof i.default||(r=i=i.default),"function"==typeof r&&(r=r.options),r.render=l.render,r.staticRenderFns=l.staticRenderFns,r._scopeId="data-v-1e219fef",e.exports=i},830:function(e,t){e.exports={render:function(){var e=this;e.$createElement;return e._c("div",{staticClass:"gv-scuoladigitale-ricerca gv-inverted-color-scheme",attrs:{id:"gv-scuoladigitale-ricerca"}},[e._c("div",{directives:[{name:"draggable",rawName:"v-draggable"}],staticClass:"gv-scuoladigitale-ricerca-title gv-color-scheme",attrs:{id:"gv-scuoladigitale-ricerca-title"}},[e._c("b",[e._v("RICERCHE TEMATICHE")]),e._v(" "),e._c("button",{class:e.toggleCollapseClass(),attrs:{size:"mini",title:"Nascondi Pannello"},on:{click:e.hidePanel}})]),e._v(" "),e._c("div",{staticClass:"gv-scuoladigitale-ricerca-body",attrs:{id:"gv-scuoladigitale-ricerca-body"}},[e._c("el-select",{staticStyle:{"margin-bottom":"5px !important"},attrs:{placeholder:"Scegli Visualizzazione",size:"small"},on:{change:e.changeTipo},model:{value:e.tipo,callback:function(t){e.tipo=t},expression:"tipo"}},e._l(e.tipi,function(t){return e._c("el-option",{key:t.id,attrs:{value:t.id,label:t.label}})})),e._v(" "),e._c("div",{directives:[{name:"show",rawName:"v-show",value:e.showRicercaScuola,expression:"showRicercaScuola"}],attrs:{id:"gv-scuoladigitale-ricerca-scuola"}},[e._c("el-select",{staticStyle:{width:"370px !important"},attrs:{id:"gv-seach-input",filterable:"",clearable:"",remote:"",size:"small",placeholder:"Ricerca per nome scuola...","remote-method":e.search,loading:e.loading,"loading-text":"Caricamento... ","no-match-text":"Nessun elemento trovato","no-data-text":"Nessun elemento trovato"},on:{change:e.onChange},model:{value:e.scuola,callback:function(t){e.scuola=t},expression:"scuola"}},e._l(e.results,function(t){return e._c("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),e._v(" "),e._c("div",{directives:[{name:"show",rawName:"v-show",value:e.showRicercaTemi,expression:"showRicercaTemi"}],attrs:{id:"gv-scuoladigitale-ricerca-temi"}},[e._c("el-select",{staticStyle:{width:"170px !important"},attrs:{size:"small","collapse-tags":"",multiple:"",placeholder:"Ordine Scuola"},model:{value:e.ordini,callback:function(t){e.ordini=t},expression:"ordini"}},e._l(e.listaOrdini,function(t){return e._c("el-option",{key:t.id,attrs:{value:t.id,label:t.label}})})),e._v(" "),e._c("el-select",{staticStyle:{width:"270px !important"},attrs:{size:"small",multiple:"",filterable:"","collapse-tags":"",placeholder:"Parole Chiave"},model:{value:e.parole,callback:function(t){e.parole=t},expression:"parole"}},e._l(e.listaParole,function(t){return e._c("el-option",{key:t.id,attrs:{value:t.id,label:t.label}})}))],1),e._v(" "),e._c("div",{staticClass:"gv-scuoladigitale-ricerca-buttons"},[e._c("button",{attrs:{id:"gv-scuoladigitale-ricerca-submit",type:"info",size:"mini"},on:{click:e.submit}},[e._v("\n        Conferma\n      ")]),e._v(" "),e._c("button",{attrs:{id:"gv-scuoladigitale-ricerca-reset",type:"info",size:"mini"},on:{click:e.reset}},[e._v("\n        Annulla Selezione\n      ")])])],1)])},staticRenderFns:[]}}});
//# sourceMappingURL=15.js.map