{"version":3,"sources":["webpack:///static/js/24.js","webpack:///Draw.vue","webpack:///./D:/node-prj/geoviewer2/src/services/getCoordTransformPoly.js","webpack:///./src/components/Draw.vue?628d","webpack:///./src/components/Draw.vue?95d5","webpack:///./src/components/Draw.vue","webpack:///./src/components/Draw.vue?bad6"],"names":["webpackJsonp","256","module","exports","__webpack_require__","_interopRequireDefault","obj","__esModule","default","Object","defineProperty","value","_loading","_loading3","_loading4","_keys","_keys2","_notification","_notification3","_notification4","_col","_col3","_col4","_row","_row3","_row4","_button","_base","_button3","_button4","_vue","_vue2","_getCoordTransform","_getCoordTransform2","_getCoordTransformPoly","_getCoordTransformPoly2","_getWFSFeature","_getWFSFeature2","use","name","data","options","GV","config","getToolOptions","title","defaultColor","results","requestCount","numRequests","drawnItems","editing","deletedItems","submitButton","buttons","submit","cancelButton","cancel","refreshButton","refresh","computed","methods","this","r","confirm","initWfsRequests","addLayerFeatures","submitOK","_this","type","duration","offset","dangerouslyUseHTMLString","position","message","_layers","map","key","properties","id","layerName","latlngs","_latlng","_latlngs","length","loading","service","text","background","forEach","item","convertCoords","submitRefresh","checkEndRequests","convertCoordsPoint","convertCoordsLine","convertCoordsPolygon","_this2","epsg","geom","lng","toFixed","lat","then","response","points","split","_this3","resultLine","latlng","push","srsIn","srsOut","poly","_this4","setEditOptions","editOptions","tools","edit","remove","featureGroup","allowIntersection","L","EditToolbar","Delete","include","removeAllLayers","setDrawOptions","drawOptions","draw","rectangle","marker","circle","point","circlemarker","radius","color","polyline","shapeOptions","polygon","addDrawControl","controlDraw","Control","Draw","app","addControl","addDrawToolbar","addEditToolbar","drawPanel","document","getElementById","appendChild","_toolbars","_toolbarContainer","_actionsContainer","getElementsByClassName","className","el","_el","_this5","clearLayers","request","wfsURL","features","feature","createGeometry","bounds","getBounds","_northEast","_southWest","fitBounds","maxZoom","catch","error","console","geometry","circleMarker","latLng","coordinates","reverse","weight","opacity","fillOpacity","addTo","reverseCoordsLine","warn","reverseCoordsPoly","reversedGeom","coords","coord","hideLayer","eachLayer","layer","getElement","style","display","showLayer","mounted","_this6","on","e","eventBus","$on","ev","off","layers","getLayerByName","355","_axios2","post","_globals2","RL_TRANSFORM_POLY_SERVICE","headers","Accept","_axios","_globals","496","version","sources","names","mappings","file","sourcesContent","sourceRoot","623","content","locals","695","__vue_exports__","__vue_options__","__vue_template__","render","staticRenderFns","840","_vm","$createElement","_c","staticClass","attrs","directives","rawName","divId","noClose","_v","_m","justify","size","click","expression"],"mappings":"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","file":"static/js/24.js","sourcesContent":["webpackJsonp([24,36],{\n\n/***/ 256:\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _loading = __webpack_require__(30);\n\t\n\tvar _loading2 = _interopRequireDefault(_loading);\n\t\n\tvar _loading3 = __webpack_require__(29);\n\t\n\tvar _loading4 = _interopRequireDefault(_loading3);\n\t\n\tvar _keys = __webpack_require__(56);\n\t\n\tvar _keys2 = _interopRequireDefault(_keys);\n\t\n\tvar _notification = __webpack_require__(84);\n\t\n\tvar _notification2 = _interopRequireDefault(_notification);\n\t\n\tvar _notification3 = __webpack_require__(78);\n\t\n\tvar _notification4 = _interopRequireDefault(_notification3);\n\t\n\tvar _col = __webpack_require__(68);\n\t\n\tvar _col2 = _interopRequireDefault(_col);\n\t\n\tvar _col3 = __webpack_require__(66);\n\t\n\tvar _col4 = _interopRequireDefault(_col3);\n\t\n\tvar _row = __webpack_require__(44);\n\t\n\tvar _row2 = _interopRequireDefault(_row);\n\t\n\tvar _row3 = __webpack_require__(40);\n\t\n\tvar _row4 = _interopRequireDefault(_row3);\n\t\n\tvar _button = __webpack_require__(9);\n\t\n\tvar _button2 = _interopRequireDefault(_button);\n\t\n\tvar _base = __webpack_require__(5);\n\t\n\tvar _base2 = _interopRequireDefault(_base);\n\t\n\tvar _button3 = __webpack_require__(8);\n\t\n\tvar _button4 = _interopRequireDefault(_button3);\n\t\n\tvar _vue = __webpack_require__(1);\n\t\n\tvar _vue2 = _interopRequireDefault(_vue);\n\t\n\tvar _getCoordTransform = __webpack_require__(46);\n\t\n\tvar _getCoordTransform2 = _interopRequireDefault(_getCoordTransform);\n\t\n\tvar _getCoordTransformPoly = __webpack_require__(355);\n\t\n\tvar _getCoordTransformPoly2 = _interopRequireDefault(_getCoordTransformPoly);\n\t\n\tvar _getWFSFeature = __webpack_require__(38);\n\t\n\tvar _getWFSFeature2 = _interopRequireDefault(_getWFSFeature);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t_vue2.default.use(_button4.default);\n\t_vue2.default.use(_row4.default);\n\t_vue2.default.use(_col4.default);\n\t\n\texports.default = {\n\t  name: 'gv-draw-panel',\n\t  data: function data() {\n\t    var options = GV.config.getToolOptions('gv-draw-button');\n\t    return {\n\t      options: options,\n\t      title: 'Acquisizione Geometrie',\n\t      defaultColor: '#3388ff',\n\t      results: [],\n\t      requestCount: 0,\n\t      numRequests: 0,\n\t      drawnItems: null,\n\t      editing: false,\n\t      deletedItems: [],\n\t      submitButton: options.buttons && options.buttons.submit,\n\t      cancelButton: options.buttons && options.buttons.cancel,\n\t      refreshButton: options.buttons && options.buttons.refresh\n\t    };\n\t  },\n\t\n\t  computed: {},\n\t  methods: {\n\t    cancel: function cancel() {\n\t      if (this.options.cancel) this.options.cancel(this.results);\n\t    },\n\t    refresh: function refresh() {\n\t      var r = confirm(\"L'operazione cancella eventuali modifiche non salvate su DB.\\n\\nSei sicuro?\");\n\t      if (r == true) {\n\t        this.results = [];\n\t        this.deletedItems = [];\n\t        if (this.options.initWfsRequests) this.addLayerFeatures(this.options.initWfsRequests);\n\t      }\n\t      return;\n\t    },\n\t    submit: function submit() {\n\t      var r = confirm('Sei sicuro?');\n\t      if (r == true) {\n\t        this.submitOK();\n\t      }\n\t      return;\n\t    },\n\t    submitOK: function submitOK() {\n\t      var _this = this;\n\t\n\t      if (this.editing) {\n\t        (0, _notification4.default)({\n\t          title: 'Attenzione',\n\t          type: 'warning',\n\t          duration: 5000,\n\t          offset: 70,\n\t          dangerouslyUseHTMLString: true,\n\t          position: 'bottom-left',\n\t          message: 'Modifiche in corso, salva o annulla le modifiche prima di inviare i dati'\n\t        });\n\t        return;\n\t      }\n\t      this.requestCount = 0;\n\t      this.results = (0, _keys2.default)(this.drawnItems._layers).map(function (key) {\n\t        return {\n\t          type: _this.drawnItems._layers[key].options.type,\n\t          properties: _this.drawnItems._layers[key].options.properties,\n\t          id: _this.drawnItems._layers[key].options.id,\n\t          layerName: _this.drawnItems._layers[key].options.layerName,\n\t          latlngs: _this.drawnItems._layers[key].options.type === 'point' ? _this.drawnItems._layers[key]._latlng : _this.drawnItems._layers[key]._latlngs\n\t        };\n\t      });\n\t      this.numRequests = this.results.length;\n\t      if (this.results.length === 0 && this.deletedItems.length === 0) {\n\t        (0, _notification4.default)({\n\t          title: 'Attenzione',\n\t          type: 'warning',\n\t          duration: 5000,\n\t          offset: 70,\n\t          position: 'bottom-left',\n\t          message: \"Nessuna geometria da salvare, insersci le geometrie oppure premi il tasto 'Annulla'\"\n\t        });\n\t        return;\n\t      }\n\t\n\t      this.loading = _loading4.default.service({\n\t        text: 'Salvataggio...',\n\t        background: 'rgba(0, 0, 0, 0.8)'\n\t      });\n\t      if (this.results.length === 0) {\n\t        this.options.submit(this.results, this.deletedItems, this.loading);\n\t      } else {\n\t        this.results.forEach(function (item) {\n\t          _this.convertCoords(item);\n\t        });\n\t      }\n\t    },\n\t    submitRefresh: function submitRefresh() {\n\t      this.results = [];\n\t      this.deletedItems = [];\n\t      if (this.options.initWfsRequests) this.addLayerFeatures(this.options.initWfsRequests);\n\t    },\n\t    checkEndRequests: function checkEndRequests() {\n\t      if (this.requestCount === this.numRequests) {\n\t        this.options.submit(this.results, this.deletedItems, this.loading, this.submitRefresh);\n\t      }\n\t    },\n\t    convertCoords: function convertCoords(item) {\n\t      switch (item.type) {\n\t        case 'point':\n\t          this.convertCoordsPoint(item);\n\t          break;\n\t        case 'polyline':\n\t          this.convertCoordsLine(item);\n\t          break;\n\t        case 'polygon':\n\t          this.convertCoordsPolygon(item);\n\t          break;\n\t      }\n\t    },\n\t    convertCoordsPoint: function convertCoordsPoint(item) {\n\t      var _this2 = this;\n\t\n\t      if (this.options.epsg === '4326') {\n\t        this.requestCount++;\n\t        item.geom = [item.latlngs.lng.toFixed(6), item.latlngs.lat.toFixed(6)];\n\t        this.checkEndRequests();\n\t      } else {\n\t        (0, _getCoordTransform2.default)('4326', this.options.epsg, item.latlngs.lng, item.latlngs.lat).then(function (response) {\n\t          _this2.requestCount++;\n\t          if (response.data.points) {\n\t            item.geom = response.data.points[0].split(',');\n\t          }\n\t          _this2.checkEndRequests();\n\t        });\n\t      }\n\t    },\n\t    convertCoordsLine: function convertCoordsLine(item) {\n\t      var _this3 = this;\n\t\n\t      var resultLine = [];\n\t      item.latlngs.forEach(function (latlng) {\n\t        resultLine.push([latlng.lng, latlng.lat]);\n\t      });\n\t      if (this.options.epsg === '4326') {\n\t        this.requestCount++;\n\t        item.geom = resultLine;\n\t        this.checkEndRequests();\n\t      } else {\n\t        var data = {\n\t          srsIn: '4326',\n\t          srsOut: this.options.epsg,\n\t          poly: resultLine\n\t        };\n\t        (0, _getCoordTransformPoly2.default)(data).then(function (response) {\n\t          _this3.requestCount++;\n\t          item.geom = response.poly;\n\t          _this3.checkEndRequests();\n\t        });\n\t      }\n\t    },\n\t    convertCoordsPolygon: function convertCoordsPolygon(item) {\n\t      var _this4 = this;\n\t\n\t      var resultLine = [];\n\t      item.latlngs.forEach(function (poly) {\n\t        poly.forEach(function (latlng) {\n\t          resultLine.push([latlng.lng, latlng.lat]);\n\t        });\n\t      });\n\t      if (this.options.epsg === '4326') {\n\t        this.requestCount++;\n\t        item.geom = resultLine;\n\t        this.checkEndRequests();\n\t      } else {\n\t        var data = {\n\t          srsIn: '4326',\n\t          srsOut: this.options.epsg,\n\t          poly: resultLine\n\t        };\n\t        (0, _getCoordTransformPoly2.default)(data).then(function (response) {\n\t          _this4.requestCount++;\n\t          item.geom = response.poly;\n\t          _this4.checkEndRequests();\n\t        });\n\t      }\n\t    },\n\t    setEditOptions: function setEditOptions() {\n\t      var editOptions = null;\n\t      if (this.options.tools.edit) {\n\t        if (this.options.tools.edit.edit || this.options.tools.edit.remove) {\n\t          editOptions = {\n\t            featureGroup: this.drawnItems,\n\t            poly: {\n\t              allowIntersection: false\n\t            }\n\t          };\n\t          if (!this.options.tools.edit.remove) {\n\t            editOptions.remove = false;\n\t          }\n\t          if (!this.options.tools.edit.edit) {\n\t            editOptions.edit = false;\n\t          }\n\t          L.EditToolbar.Delete.include({\n\t            removeAllLayers: false\n\t          });\n\t        }\n\t      }\n\t      return editOptions;\n\t    },\n\t    setDrawOptions: function setDrawOptions() {\n\t      var drawOptions = null;\n\t      if (this.options.tools.draw) {\n\t        drawOptions = {\n\t          rectangle: false,\n\t          marker: false,\n\t          circle: false\n\t        };\n\t\n\t        if (this.options.tools.draw.point) {\n\t          drawOptions.circlemarker = {\n\t            type: 'point',\n\t            radius: 4,\n\t            color: this.options.color || this.defaultColor\n\t          };\n\t        } else {\n\t          drawOptions.circlemarker = false;\n\t        }\n\t        if (this.options.tools.draw.polyline) {\n\t          drawOptions.polyline = {\n\t            shapeOptions: {\n\t              type: 'polyline',\n\t              color: this.options.color || this.defaultColor\n\t            }\n\t          };\n\t        } else {\n\t          drawOptions.polyline = false;\n\t        }\n\t        if (this.options.tools.draw.polygon) {\n\t          drawOptions.polygon = {\n\t            shapeOptions: {\n\t              type: 'polygon',\n\t              color: this.options.color || this.defaultColor\n\t            },\n\t            allowIntersection: false\n\t          };\n\t        } else {\n\t          drawOptions.polygon = false;\n\t        }\n\t      }\n\t      return drawOptions;\n\t    },\n\t    addDrawControl: function addDrawControl() {\n\t      var editOptions = this.setEditOptions();\n\t      var drawOptions = this.setDrawOptions();\n\t\n\t      this.controlDraw = new L.Control.Draw({\n\t        draw: drawOptions,\n\t        edit: editOptions\n\t      });\n\t      GV.app.map.addControl(this.controlDraw);\n\t\n\t      this.addDrawToolbar();\n\t      this.addEditToolbar();\n\t    },\n\t    addDrawToolbar: function addDrawToolbar() {\n\t      if (this.options.tools.draw) {\n\t        var drawPanel = document.getElementById('gv-draw-panel-draw');\n\t        drawPanel.appendChild(this.controlDraw._toolbars['draw']._toolbarContainer);\n\t        drawPanel.appendChild(this.controlDraw._toolbars['draw']._actionsContainer);\n\t        if (this.options.tools.draw.point) {\n\t          document.getElementsByClassName('leaflet-draw-draw-circlemarker')[0].className = 'gv-draw-buttons ms ms-draw-point';\n\t        }\n\t        if (this.options.tools.draw.polyline) {\n\t          document.getElementsByClassName('leaflet-draw-draw-polyline')[0].className = 'gv-draw-buttons ms ms-draw-line';\n\t        }\n\t        if (this.options.tools.draw.polygon) {\n\t          document.getElementsByClassName('leaflet-draw-draw-polygon')[0].className = 'gv-draw-buttons ms ms-draw-polygon';\n\t        }\n\t      }\n\t    },\n\t    addEditToolbar: function addEditToolbar() {\n\t      if (this.options.tools.edit) {\n\t        var drawPanel = document.getElementById('gv-draw-panel-draw');\n\t        if (this.options.tools.edit.edit || this.options.tools.edit.remove) {\n\t          drawPanel.appendChild(this.controlDraw._toolbars['edit']._toolbarContainer);\n\t          drawPanel.appendChild(this.controlDraw._toolbars['edit']._actionsContainer);\n\t        }\n\t        if (this.options.tools.edit.edit) {\n\t          var el = document.getElementsByClassName('leaflet-draw-edit-edit')[0];\n\t          el.className = 'gv-draw-buttons fa fa-edit';\n\t        }\n\t        if (this.options.tools.edit.remove) {\n\t          var _el = document.getElementsByClassName('leaflet-draw-edit-remove')[0];\n\t          _el.className = 'gv-draw-buttons fa fa-trash';\n\t        }\n\t      }\n\t    },\n\t    addLayerFeatures: function addLayerFeatures(initWfsRequests) {\n\t      var _this5 = this;\n\t\n\t      this.drawnItems.clearLayers();\n\t      initWfsRequests.forEach(function (request) {\n\t        (0, _getWFSFeature2.default)(null, null, request.wfsURL).then(function (features) {\n\t          features.forEach(function (feature) {\n\t            _this5.createGeometry(feature, request.layerName);\n\t          });\n\t          var bounds = _this5.drawnItems.getBounds();\n\t          if (bounds._northEast && bounds._southWest) {\n\t            GV.app.map.fitBounds(_this5.drawnItems.getBounds(), {\n\t              maxZoom: 17\n\t            });\n\t          }\n\t        }).catch(function (error) {\n\t          console.error(error);\n\t        });\n\t      });\n\t    },\n\t    createGeometry: function createGeometry(feature, layerName) {\n\t      var geom = null;\n\t      switch (feature.geometry.type) {\n\t        case 'Point':\n\t          geom = L.circleMarker(L.latLng(feature.geometry.coordinates.reverse()), {\n\t            type: 'point',\n\t            color: this.options.color || this.defaultColor,\n\t            radius: 4,\n\t            weight: 4,\n\t            opacity: 0.5,\n\t            fillOpacity: 0.5,\n\t            id: feature.id,\n\t            layerName: layerName,\n\t            properties: feature.properties\n\t          });\n\t          if (geom) geom.addTo(this.drawnItems);\n\t          break;\n\t        case 'LineString':\n\t          var polyline = this.reverseCoordsLine(feature.geometry.coordinates);\n\t          geom = L.polyline(polyline, {\n\t            type: 'polyline',\n\t            color: this.options.color || this.defaultColor,\n\t            id: feature.id,\n\t            layerName: layerName,\n\t            properties: feature.properties\n\t          });\n\t          if (geom) geom.addTo(this.drawnItems);\n\t          break;\n\t        case 'MultiLineString':\n\t          console.warn('ATTENZIONE: geometria di tipo MultiLineString', feature);\n\t\n\t          break;\n\t        case 'Polygon':\n\t          var poly = this.reverseCoordsPoly(feature.geometry.coordinates);\n\t          geom = L.polygon(poly, {\n\t            type: 'polygon',\n\t            color: this.options.color || this.defaultColor,\n\t            id: feature.id,\n\t            layerName: layerName,\n\t            properties: feature.properties\n\t          });\n\t          if (geom) geom.addTo(this.drawnItems);\n\t          break;\n\t        case 'MultiPolygon':\n\t          console.warn('ATTENZIONE: geometria di tipo MultiPolygon', feature);\n\t\n\t          break;\n\t      }\n\t    },\n\t    reverseCoordsLine: function reverseCoordsLine(geom) {\n\t      var reversedGeom = [];\n\t      geom.forEach(function (el) {\n\t        var coords = el.reverse();\n\t\n\t        reversedGeom.push(coords);\n\t      });\n\t      return reversedGeom;\n\t    },\n\t    reverseCoordsPoly: function reverseCoordsPoly(geom) {\n\t      var reversedGeom = [];\n\t      geom.forEach(function (el) {\n\t        var coords = el.map(function (coord) {\n\t          return [coord[1], coord[0]];\n\t        });\n\t        reversedGeom.push(coords);\n\t      });\n\t      return reversedGeom;\n\t    },\n\t    hideLayer: function hideLayer() {\n\t      this.drawnItems.eachLayer(function (layer) {\n\t        layer.getElement().style.display = 'none';\n\t      });\n\t    },\n\t    showLayer: function showLayer() {\n\t      this.drawnItems.eachLayer(function (layer) {\n\t        layer.getElement().style.display = 'block';\n\t      });\n\t    }\n\t  },\n\t  mounted: function mounted() {\n\t    var _this6 = this;\n\t\n\t    GV.app.map.on('draw:created', function (e) {\n\t      e.layer.addTo(_this6.drawnItems);\n\t    });\n\t    GV.eventBus.$on('gv-control-draw-deactivate', function (ev) {\n\t      GV.app.map.off('draw:created');\n\t      _this6.hideLayer();\n\t    });\n\t    GV.eventBus.$on('gv-control-draw-activate', function (ev) {\n\t      GV.app.map.on('draw:created', function (e) {\n\t        e.layer.addTo(_this6.drawnItems);\n\t      });\n\t      _this6.showLayer();\n\t      _this6.submitRefresh();\n\t    });\n\t\n\t    GV.app.map.on('draw:editstart', function (e) {\n\t      _this6.editing = true;\n\t    });\n\t    GV.app.map.on('draw:editstop', function (e) {\n\t      _this6.editing = false;\n\t    });\n\t\n\t    GV.app.map.on('draw:deletestart', function (e) {\n\t      _this6.editing = true;\n\t    });\n\t    GV.app.map.on('draw:deletestop', function (e) {\n\t      _this6.editing = false;\n\t    });\n\t\n\t    GV.app.map.on('draw:drawstart', function (e) {\n\t      _this6.editing = true;\n\t    });\n\t    GV.app.map.on('draw:drawstop', function (e) {\n\t      _this6.editing = false;\n\t    });\n\t\n\t    GV.app.map.on('draw:deleted', function (e) {\n\t      (0, _keys2.default)(e.layers._layers).forEach(function (key) {\n\t        var item = {\n\t          type: e.layers._layers[key].options.type,\n\t          properties: e.layers._layers[key].options.properties,\n\t          id: e.layers._layers[key].options.id,\n\t          layerName: e.layers._layers[key].options.layerName,\n\t          latlngs: e.layers._layers[key].options.type === 'point' ? e.layers._layers[key]._latlng : e.layers._layers[key]._latlngs\n\t        };\n\t        _this6.deletedItems.push(item);\n\t      });\n\t    });\n\t\n\t    this.drawnItems = L.featureGroup();\n\t    this.drawnItems.addTo(GV.app.map);\n\t\n\t    if (this.options.initWfsRequests) this.addLayerFeatures(this.options.initWfsRequests);\n\t\n\t    this.addDrawControl();\n\t\n\t    GV.app.map.getLayerByName('InfoWmsHilite').clearLayers();\n\t  }\n\t};\n\n/***/ }),\n\n/***/ 355:\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\texports.default = function (data) {\n\t  return _axios2.default.post(_globals2.default.RL_TRANSFORM_POLY_SERVICE, {\n\t    headers: {\n\t      Accept: 'text/xml'\n\t    },\n\t    data: data\n\t  }).then(function (response) {\n\t    return response.data;\n\t  });\n\t};\n\t\n\tvar _axios = __webpack_require__(4);\n\t\n\tvar _axios2 = _interopRequireDefault(_axios);\n\t\n\tvar _globals = __webpack_require__(6);\n\t\n\tvar _globals2 = _interopRequireDefault(_globals);\n\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/***/ }),\n\n/***/ 496:\n/***/ (function(module, exports, __webpack_require__) {\n\n\texports = module.exports = __webpack_require__(2)();\n\t// imports\n\t\n\t\n\t// module\n\texports.push([module.id, \".gv-draw-panel{position:absolute;width:260px;left:0;top:0;margin-left:10px;margin-top:50px;z-index:800}.gv-draw-panel-body{padding:10px;overflow-y:auto;width:240px;height:80px}.gv-draw-panel-result{position:absolute;padding-left:3px;margin:0;width:230px}.gv-draw-buttons{width:20px;float:left;margin:4px}.gv-draw-buttons-reset{width:36px;padding-left:2px}.leaflet-bar{box-shadow:none}.leaflet-draw-actions{left:2px;top:54px!important}.leaflet-draw-actions a{padding:7px;margin:2px}.leaflet-draw-actions li:last-child a{border-radius:0 0 0 0}.leaflet-draw-actions li:first-child a{margin-left:4px}.leaflet-draw-toolbar a{background-image:none}.leaflet-draw-toolbar .leaflet-draw-draw-polyline{background-position:-2px -2px}.leaflet-bar a:first-child{border-top-left-radius:0;border-top-right-radius:0}.leaflet-bar a:last-child{border-bottom-left-radius:0;border-bottom-right-radius:0;margin-right:20px}\", \"\", {\"version\":3,\"sources\":[\"/./src/components/Draw.vue\"],\"names\":[],\"mappings\":\"AACA,eACE,kBAAmB,AACnB,YAAa,AACb,OAAU,AACV,MAAS,AACT,iBAAkB,AAClB,gBAAiB,AACjB,WAAa,CACd,AACD,oBACE,aAAc,AACd,gBAAiB,AACjB,YAAa,AACb,WAAa,CACd,AACD,sBACE,kBAAmB,AACnB,iBAAkB,AAClB,SAAY,AACZ,WAAa,CACd,AACD,iBACE,WAAY,AACZ,WAAY,AACZ,UAAY,CACb,AACD,uBACE,WAAY,AACZ,gBAAkB,CACnB,AACD,aACE,eAAiB,CAClB,AACD,sBACE,SAAU,AACV,kBAAqB,CACtB,AACD,wBACE,YAAa,AACb,UAAY,CACb,AACD,sCACE,qBAAuB,CACxB,AACD,uCACE,eAAiB,CAClB,AACD,wBACE,qBAAuB,CACxB,AACD,kDACE,6BAA+B,CAChC,AACD,2BACE,yBAA4B,AAC5B,yBAA6B,CAC9B,AACD,0BACE,4BAA+B,AAC/B,6BAAgC,AAChC,iBAAmB,CACpB\",\"file\":\"Draw.vue\",\"sourcesContent\":[\"\\n.gv-draw-panel {\\r\\n  position: absolute;\\r\\n  width: 260px;\\r\\n  left: 0px;\\r\\n  top: 0px;\\r\\n  margin-left: 10px;\\r\\n  margin-top: 50px;\\r\\n  z-index: 800;\\n}\\n.gv-draw-panel-body {\\r\\n  padding: 10px;\\r\\n  overflow-y: auto;\\r\\n  width: 240px;\\r\\n  height: 80px;\\n}\\n.gv-draw-panel-result {\\r\\n  position: absolute;\\r\\n  padding-left: 3px;\\r\\n  margin: 0px;\\r\\n  width: 230px;\\n}\\n.gv-draw-buttons {\\r\\n  width: 20px;\\r\\n  float: left;\\r\\n  margin: 4px;\\n}\\n.gv-draw-buttons-reset {\\r\\n  width: 36px;\\r\\n  padding-left: 2px;\\n}\\n.leaflet-bar {\\r\\n  box-shadow: none;\\n}\\n.leaflet-draw-actions {\\r\\n  left: 2px;\\r\\n  top: 54px !important;\\n}\\n.leaflet-draw-actions a {\\r\\n  padding: 7px;\\r\\n  margin: 2px;\\n}\\n.leaflet-draw-actions li:last-child a {\\r\\n  border-radius: 0 0 0 0;\\n}\\n.leaflet-draw-actions li:first-child a {\\r\\n  margin-left: 4px;\\n}\\n.leaflet-draw-toolbar a {\\r\\n  background-image: none;\\n}\\n.leaflet-draw-toolbar .leaflet-draw-draw-polyline {\\r\\n  background-position: -2px -2px;\\n}\\n.leaflet-bar a:first-child {\\r\\n  border-top-left-radius: 0px;\\r\\n  border-top-right-radius: 0px;\\n}\\n.leaflet-bar a:last-child {\\r\\n  border-bottom-left-radius: 0px;\\r\\n  border-bottom-right-radius: 0px;\\r\\n  margin-right: 20px;\\n}\\r\\n\"],\"sourceRoot\":\"webpack://\"}]);\n\t\n\t// exports\n\n\n/***/ }),\n\n/***/ 623:\n/***/ (function(module, exports, __webpack_require__) {\n\n\t// style-loader: Adds some css to the DOM by adding a <style> tag\n\t\n\t// load the styles\n\tvar content = __webpack_require__(496);\n\tif(typeof content === 'string') content = [[module.id, content, '']];\n\t// add the styles to the DOM\n\tvar update = __webpack_require__(3)(content, {});\n\tif(content.locals) module.exports = content.locals;\n\t// Hot Module Replacement\n\tif(false) {\n\t\t// When the styles change, update the <style> tags\n\t\tif(!content.locals) {\n\t\t\tmodule.hot.accept(\"!!./../../node_modules/css-loader/index.js?sourceMap!./../../node_modules/vue-loader/lib/style-rewriter.js?id=data-v-782c17e8!./../../node_modules/vue-loader/lib/selector.js?type=styles&index=0!./Draw.vue\", function() {\n\t\t\t\tvar newContent = require(\"!!./../../node_modules/css-loader/index.js?sourceMap!./../../node_modules/vue-loader/lib/style-rewriter.js?id=data-v-782c17e8!./../../node_modules/vue-loader/lib/selector.js?type=styles&index=0!./Draw.vue\");\n\t\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\t\tupdate(newContent);\n\t\t\t});\n\t\t}\n\t\t// When the module is disposed, remove the <style> tags\n\t\tmodule.hot.dispose(function() { update(); });\n\t}\n\n/***/ }),\n\n/***/ 695:\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __vue_exports__, __vue_options__\n\tvar __vue_styles__ = {}\n\t\n\t/* styles */\n\t__webpack_require__(623)\n\t\n\t/* script */\n\t__vue_exports__ = __webpack_require__(256)\n\t\n\t/* template */\n\tvar __vue_template__ = __webpack_require__(840)\n\t__vue_options__ = __vue_exports__ = __vue_exports__ || {}\n\tif (\n\t  typeof __vue_exports__.default === \"object\" ||\n\t  typeof __vue_exports__.default === \"function\"\n\t) {\n\t__vue_options__ = __vue_exports__ = __vue_exports__.default\n\t}\n\tif (typeof __vue_options__ === \"function\") {\n\t  __vue_options__ = __vue_options__.options\n\t}\n\t\n\t__vue_options__.render = __vue_template__.render\n\t__vue_options__.staticRenderFns = __vue_template__.staticRenderFns\n\t\n\tmodule.exports = __vue_exports__\n\n\n/***/ }),\n\n/***/ 840:\n/***/ (function(module, exports) {\n\n\tmodule.exports={render:function (){var _vm=this;var _h=_vm.$createElement;\n\t  return _vm._c('div', {\n\t    staticClass: \"gv-draw-panel\",\n\t    attrs: {\n\t      \"id\": \"gv-draw-panel\"\n\t    }\n\t  }, [_vm._c('gv-title', {\n\t    directives: [{\n\t      name: \"draggable\",\n\t      rawName: \"v-draggable\"\n\t    }],\n\t    attrs: {\n\t      \"title\": _vm.title,\n\t      \"divId\": 'gv-draw-panel',\n\t      \"noClose\": true\n\t    }\n\t  }), _vm._v(\" \"), _vm._m(0), _vm._v(\" \"), _vm._c('el-row', {\n\t    staticClass: \"row-bg\",\n\t    attrs: {\n\t      \"type\": \"flex\",\n\t      \"justify\": \"left\"\n\t    }\n\t  }, [_vm._c('el-button', {\n\t    staticClass: \"gv-color-scheme\",\n\t    attrs: {\n\t      \"id\": \"gv-draw-submit\",\n\t      \"title\": \"Salva i dati sul DB\",\n\t      \"size\": \"mini\"\n\t    },\n\t    on: {\n\t      \"click\": _vm.submit\n\t    }\n\t  }, [_vm._v(\"Salva su DB\")]), _vm._v(\" \"), _vm._c('el-button', {\n\t    directives: [{\n\t      name: \"show\",\n\t      rawName: \"v-show\",\n\t      value: (_vm.cancelButton),\n\t      expression: \"cancelButton\"\n\t    }],\n\t    staticClass: \"gv-color-scheme\",\n\t    attrs: {\n\t      \"id\": \"gv-draw-cancel\",\n\t      \"title\": \"Ritorno alla applicazione\",\n\t      \"size\": \"mini\"\n\t    },\n\t    on: {\n\t      \"click\": _vm.cancel\n\t    }\n\t  }, [_vm._v(\"Annulla\")]), _vm._v(\" \"), _vm._c('el-button', {\n\t    directives: [{\n\t      name: \"show\",\n\t      rawName: \"v-show\",\n\t      value: (_vm.refreshButton),\n\t      expression: \"refreshButton\"\n\t    }],\n\t    staticClass: \"gv-color-scheme\",\n\t    attrs: {\n\t      \"id\": \"gv-draw-cancel\",\n\t      \"title\": \"Ricarica dati salvati sul DB\",\n\t      \"size\": \"mini\"\n\t    },\n\t    on: {\n\t      \"click\": _vm.refresh\n\t    }\n\t  }, [_vm._v(\"Ricarica\")])], 1)], 1)\n\t},staticRenderFns: [function (){var _vm=this;var _h=_vm.$createElement;\n\t  return _vm._c('div', {\n\t    staticClass: \"gv-draw-panel-body gv-inverted-color-scheme\",\n\t    attrs: {\n\t      \"id\": \"gv-draw-panel-body\"\n\t    }\n\t  }, [_vm._c('div', {\n\t    staticClass: \"gv-draw-panel-result gv-inverted-color-scheme\"\n\t  }, [_vm._c('div', {\n\t    attrs: {\n\t      \"id\": \"gv-draw-panel-draw\"\n\t    }\n\t  })])])\n\t}]}\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// static/js/24.js","<template>\r\n  <div id=\"gv-draw-panel\" class=\"gv-draw-panel\">\r\n    <gv-title :title=\"title\" :divId=\"'gv-draw-panel'\" v-draggable :noClose=\"true\"></gv-title>\r\n    <div id=\"gv-draw-panel-body\" class=\"gv-draw-panel-body gv-inverted-color-scheme\">\r\n      <div class=\"gv-draw-panel-result gv-inverted-color-scheme\">\r\n        <div id=\"gv-draw-panel-draw\"></div>\r\n      </div>\r\n    </div>\r\n    <el-row type=\"flex\" class=\"row-bg\" justify=\"left\">\r\n      <el-button\r\n        id=\"gv-draw-submit\"\r\n        title=\"Salva i dati sul DB\"\r\n        @click=\"submit\"\r\n        class=\"gv-color-scheme\"\r\n        size=\"mini\"\r\n        >Salva su DB</el-button\r\n      >\r\n      <el-button\r\n        id=\"gv-draw-cancel\"\r\n        v-show=\"cancelButton\"\r\n        title=\"Ritorno alla applicazione\"\r\n        @click=\"cancel\"\r\n        class=\"gv-color-scheme\"\r\n        size=\"mini\"\r\n        >Annulla</el-button\r\n      >\r\n      <el-button\r\n        id=\"gv-draw-cancel\"\r\n        v-show=\"refreshButton\"\r\n        title=\"Ricarica dati salvati sul DB\"\r\n        @click=\"refresh\"\r\n        class=\"gv-color-scheme\"\r\n        size=\"mini\"\r\n        >Ricarica</el-button\r\n      >\r\n    </el-row>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Vue from 'vue';\r\nimport getCoordTransform from '../services/getCoordTransform';\r\nimport getCoordTransformPoly from '../services/getCoordTransformPoly';\r\nimport getWFSFeature from '../services/getWFSFeature';\r\n\r\nimport { Button, Row, Col, Loading, Notification } from 'element-ui';\r\nVue.use(Button);\r\nVue.use(Row);\r\nVue.use(Col);\r\n\r\nexport default {\r\n  name: 'gv-draw-panel',\r\n  data() {\r\n    const options = GV.config.getToolOptions('gv-draw-button');\r\n    return {\r\n      options: options,\r\n      title: 'Acquisizione Geometrie',\r\n      defaultColor: '#3388ff',\r\n      results: [],\r\n      requestCount: 0,\r\n      numRequests: 0,\r\n      drawnItems: null,\r\n      editing: false,\r\n      deletedItems: [],\r\n      submitButton: options.buttons && options.buttons.submit,\r\n      cancelButton: options.buttons && options.buttons.cancel,\r\n      refreshButton: options.buttons && options.buttons.refresh,\r\n    };\r\n  },\r\n  computed: {},\r\n  methods: {\r\n    cancel() {\r\n      if (this.options.cancel) this.options.cancel(this.results);\r\n    },\r\n    refresh() {\r\n      var r = confirm(\r\n        \"L'operazione cancella eventuali modifiche non salvate su DB.\\n\\nSei sicuro?\"\r\n      );\r\n      if (r == true) {\r\n        this.results = [];\r\n        this.deletedItems = [];\r\n        if (this.options.initWfsRequests) this.addLayerFeatures(this.options.initWfsRequests);\r\n      }\r\n      return;\r\n    },\r\n    submit() {\r\n      var r = confirm('Sei sicuro?');\r\n      if (r == true) {\r\n        this.submitOK();\r\n      }\r\n      return;\r\n    },\r\n    submitOK() {\r\n      if (this.editing) {\r\n        Notification({\r\n          title: 'Attenzione',\r\n          type: 'warning',\r\n          duration: 5000,\r\n          offset: 70,\r\n          dangerouslyUseHTMLString: true,\r\n          position: 'bottom-left',\r\n          message: 'Modifiche in corso, salva o annulla le modifiche prima di inviare i dati',\r\n        });\r\n        return;\r\n      }\r\n      this.requestCount = 0;\r\n      this.results = Object.keys(this.drawnItems._layers).map(key => {\r\n        return {\r\n          type: this.drawnItems._layers[key].options.type,\r\n          properties: this.drawnItems._layers[key].options.properties,\r\n          id: this.drawnItems._layers[key].options.id,\r\n          layerName: this.drawnItems._layers[key].options.layerName,\r\n          latlngs:\r\n            this.drawnItems._layers[key].options.type === 'point'\r\n              ? this.drawnItems._layers[key]._latlng\r\n              : this.drawnItems._layers[key]._latlngs,\r\n        };\r\n      });\r\n      this.numRequests = this.results.length;\r\n      if (this.results.length === 0 && this.deletedItems.length === 0) {\r\n        Notification({\r\n          title: 'Attenzione',\r\n          type: 'warning',\r\n          duration: 5000,\r\n          offset: 70,\r\n          position: 'bottom-left',\r\n          message:\r\n            \"Nessuna geometria da salvare, insersci le geometrie oppure premi il tasto 'Annulla'\",\r\n        });\r\n        return;\r\n      }\r\n\r\n      // console.log('results', this.results[0]);\r\n      // console.log('deleted', this.deletedItems);\r\n      // return;\r\n\r\n      this.loading = Loading.service({\r\n        text: 'Salvataggio...',\r\n        background: 'rgba(0, 0, 0, 0.8)',\r\n      });\r\n      if (this.results.length === 0) {\r\n        this.options.submit(this.results, this.deletedItems, this.loading);\r\n      } else {\r\n        this.results.forEach(item => {\r\n          this.convertCoords(item);\r\n        });\r\n      }\r\n    },\r\n    submitRefresh() {\r\n      this.results = [];\r\n      this.deletedItems = [];\r\n      if (this.options.initWfsRequests) this.addLayerFeatures(this.options.initWfsRequests);\r\n    },\r\n    checkEndRequests() {\r\n      // Se sono finite le conversioni faccio submit\r\n      if (this.requestCount === this.numRequests) {\r\n        this.options.submit(this.results, this.deletedItems, this.loading, this.submitRefresh);\r\n      }\r\n    },\r\n    convertCoords(item) {\r\n      switch (item.type) {\r\n        case 'point':\r\n          this.convertCoordsPoint(item);\r\n          break;\r\n        case 'polyline':\r\n          this.convertCoordsLine(item);\r\n          break;\r\n        case 'polygon':\r\n          this.convertCoordsPolygon(item);\r\n          break;\r\n      }\r\n    },\r\n    convertCoordsPoint(item) {\r\n      if (this.options.epsg === '4326') {\r\n        this.requestCount++;\r\n        item.geom = [item.latlngs.lng.toFixed(6), item.latlngs.lat.toFixed(6)];\r\n        this.checkEndRequests();\r\n      } else {\r\n        getCoordTransform('4326', this.options.epsg, item.latlngs.lng, item.latlngs.lat).then(\r\n          response => {\r\n            this.requestCount++;\r\n            if (response.data.points) {\r\n              item.geom = response.data.points[0].split(',');\r\n            }\r\n            this.checkEndRequests();\r\n          }\r\n        );\r\n      }\r\n    },\r\n    convertCoordsLine(item) {\r\n      // console.log(item);\r\n      let resultLine = [];\r\n      item.latlngs.forEach(latlng => {\r\n        resultLine.push([latlng.lng, latlng.lat]);\r\n      });\r\n      if (this.options.epsg === '4326') {\r\n        this.requestCount++;\r\n        item.geom = resultLine;\r\n        this.checkEndRequests();\r\n      } else {\r\n        const data = {\r\n          srsIn: '4326',\r\n          srsOut: this.options.epsg,\r\n          poly: resultLine,\r\n        };\r\n        getCoordTransformPoly(data).then(response => {\r\n          this.requestCount++;\r\n          item.geom = response.poly;\r\n          this.checkEndRequests();\r\n        });\r\n      }\r\n    },\r\n    convertCoordsPolygon(item) {\r\n      let resultLine = [];\r\n      item.latlngs.forEach(poly => {\r\n        // console.log(poly);\r\n        // if (!Array.isArray(poly)) return;\r\n        poly.forEach(latlng => {\r\n          resultLine.push([latlng.lng, latlng.lat]);\r\n        });\r\n      });\r\n      if (this.options.epsg === '4326') {\r\n        this.requestCount++;\r\n        item.geom = resultLine;\r\n        this.checkEndRequests();\r\n      } else {\r\n        const data = {\r\n          srsIn: '4326',\r\n          srsOut: this.options.epsg,\r\n          poly: resultLine,\r\n        };\r\n        getCoordTransformPoly(data).then(response => {\r\n          this.requestCount++;\r\n          item.geom = response.poly;\r\n          this.checkEndRequests();\r\n        });\r\n      }\r\n    },\r\n    setEditOptions() {\r\n      let editOptions = null;\r\n      if (this.options.tools.edit) {\r\n        if (this.options.tools.edit.edit || this.options.tools.edit.remove) {\r\n          editOptions = {\r\n            featureGroup: this.drawnItems,\r\n            poly: {\r\n              allowIntersection: false,\r\n            },\r\n          };\r\n          if (!this.options.tools.edit.remove) {\r\n            editOptions.remove = false;\r\n          }\r\n          if (!this.options.tools.edit.edit) {\r\n            editOptions.edit = false;\r\n          }\r\n          L.EditToolbar.Delete.include({\r\n            removeAllLayers: false,\r\n          });\r\n        }\r\n      }\r\n      return editOptions;\r\n    },\r\n    setDrawOptions() {\r\n      let drawOptions = null;\r\n      if (this.options.tools.draw) {\r\n        drawOptions = {\r\n          rectangle: false,\r\n          marker: false,\r\n          circle: false,\r\n        };\r\n\r\n        if (this.options.tools.draw.point) {\r\n          drawOptions.circlemarker = {\r\n            type: 'point',\r\n            radius: 4,\r\n            color: this.options.color || this.defaultColor,\r\n          };\r\n        } else {\r\n          drawOptions.circlemarker = false;\r\n        }\r\n        if (this.options.tools.draw.polyline) {\r\n          drawOptions.polyline = {\r\n            shapeOptions: {\r\n              type: 'polyline',\r\n              color: this.options.color || this.defaultColor,\r\n            },\r\n          };\r\n        } else {\r\n          drawOptions.polyline = false;\r\n        }\r\n        if (this.options.tools.draw.polygon) {\r\n          drawOptions.polygon = {\r\n            shapeOptions: {\r\n              type: 'polygon',\r\n              color: this.options.color || this.defaultColor,\r\n            },\r\n            allowIntersection: false,\r\n          };\r\n        } else {\r\n          drawOptions.polygon = false;\r\n        }\r\n      }\r\n      return drawOptions;\r\n    },\r\n    addDrawControl() {\r\n      let editOptions = this.setEditOptions();\r\n      let drawOptions = this.setDrawOptions();\r\n\r\n      this.controlDraw = new L.Control.Draw({\r\n        draw: drawOptions,\r\n        edit: editOptions,\r\n      });\r\n      GV.app.map.addControl(this.controlDraw);\r\n\r\n      this.addDrawToolbar();\r\n      this.addEditToolbar();\r\n    },\r\n    addDrawToolbar() {\r\n      if (this.options.tools.draw) {\r\n        var drawPanel = document.getElementById('gv-draw-panel-draw');\r\n        drawPanel.appendChild(this.controlDraw._toolbars['draw']._toolbarContainer);\r\n        drawPanel.appendChild(this.controlDraw._toolbars['draw']._actionsContainer);\r\n        if (this.options.tools.draw.point) {\r\n          document.getElementsByClassName('leaflet-draw-draw-circlemarker')[0].className =\r\n            'gv-draw-buttons ms ms-draw-point';\r\n        }\r\n        if (this.options.tools.draw.polyline) {\r\n          document.getElementsByClassName('leaflet-draw-draw-polyline')[0].className =\r\n            'gv-draw-buttons ms ms-draw-line';\r\n        }\r\n        if (this.options.tools.draw.polygon) {\r\n          document.getElementsByClassName('leaflet-draw-draw-polygon')[0].className =\r\n            'gv-draw-buttons ms ms-draw-polygon';\r\n        }\r\n      }\r\n    },\r\n    addEditToolbar() {\r\n      if (this.options.tools.edit) {\r\n        var drawPanel = document.getElementById('gv-draw-panel-draw');\r\n        if (this.options.tools.edit.edit || this.options.tools.edit.remove) {\r\n          drawPanel.appendChild(this.controlDraw._toolbars['edit']._toolbarContainer);\r\n          drawPanel.appendChild(this.controlDraw._toolbars['edit']._actionsContainer);\r\n        }\r\n        if (this.options.tools.edit.edit) {\r\n          const el = document.getElementsByClassName('leaflet-draw-edit-edit')[0];\r\n          el.className = 'gv-draw-buttons fa fa-edit';\r\n        }\r\n        if (this.options.tools.edit.remove) {\r\n          const el = document.getElementsByClassName('leaflet-draw-edit-remove')[0];\r\n          el.className = 'gv-draw-buttons fa fa-trash';\r\n        }\r\n      }\r\n    },\r\n    addLayerFeatures(initWfsRequests) {\r\n      // console.log('initWfsRequests', initWfsRequests);\r\n      this.drawnItems.clearLayers();\r\n      initWfsRequests.forEach(request => {\r\n        getWFSFeature(null, null, request.wfsURL)\r\n          .then(features => {\r\n            features.forEach(feature => {\r\n              this.createGeometry(feature, request.layerName);\r\n            });\r\n            const bounds = this.drawnItems.getBounds();\r\n            if (bounds._northEast && bounds._southWest) {\r\n              GV.app.map.fitBounds(this.drawnItems.getBounds(), {\r\n                maxZoom: 17,\r\n              });\r\n            }\r\n          })\r\n          .catch(error => {\r\n            console.error(error);\r\n          });\r\n      });\r\n    },\r\n    createGeometry(feature, layerName) {\r\n      // Creo geometrie a partire da GeoJSON\r\n      let geom = null;\r\n      switch (feature.geometry.type) {\r\n        case 'Point':\r\n          geom = L.circleMarker(L.latLng(feature.geometry.coordinates.reverse()), {\r\n            type: 'point',\r\n            color: this.options.color || this.defaultColor,\r\n            radius: 4,\r\n            weight: 4,\r\n            opacity: 0.5,\r\n            fillOpacity: 0.5,\r\n            id: feature.id,\r\n            layerName: layerName,\r\n            properties: feature.properties,\r\n          });\r\n          if (geom) geom.addTo(this.drawnItems);\r\n          break;\r\n        case 'LineString':\r\n          const polyline = this.reverseCoordsLine(feature.geometry.coordinates);\r\n          geom = L.polyline(polyline, {\r\n            type: 'polyline',\r\n            color: this.options.color || this.defaultColor,\r\n            id: feature.id,\r\n            layerName: layerName,\r\n            properties: feature.properties,\r\n          });\r\n          if (geom) geom.addTo(this.drawnItems);\r\n          break;\r\n        case 'MultiLineString':\r\n          console.warn('ATTENZIONE: geometria di tipo MultiLineString', feature);\r\n          // feature.geometry.coordinates.forEach(el => {\r\n          //   geom = L.polygon(this.reverseCoordsLine(el), {\r\n          //     type: \"polyline\",\r\n          //     color: this.options.color || this.defaultColor,\r\n          //     id: feature.id,\r\n          //     layerName: layerName,\r\n          //     properties: feature.properties\r\n          //   });\r\n          //   if (geom) geom.addTo(this.drawnItems);\r\n          // });\r\n          break;\r\n        case 'Polygon':\r\n          const poly = this.reverseCoordsPoly(feature.geometry.coordinates);\r\n          geom = L.polygon(poly, {\r\n            type: 'polygon',\r\n            color: this.options.color || this.defaultColor,\r\n            id: feature.id,\r\n            layerName: layerName,\r\n            properties: feature.properties,\r\n          });\r\n          if (geom) geom.addTo(this.drawnItems);\r\n          break;\r\n        case 'MultiPolygon':\r\n          console.warn('ATTENZIONE: geometria di tipo MultiPolygon', feature);\r\n          // feature.geometry.coordinates.forEach(el => {\r\n          //   geom = L.polygon(this.reverseCoordsPoly(el), {\r\n          //     type: \"polygon\",\r\n          //     color: this.options.color || this.defaultColor,\r\n          //     id: feature.id,\r\n          //     layerName: layerName,\r\n          //     properties: feature.properties\r\n          //   });\r\n          //   if (geom) geom.addTo(this.drawnItems);\r\n          // });\r\n          break;\r\n      }\r\n    },\r\n    reverseCoordsLine(geom) {\r\n      // console.log(geom);\r\n      let reversedGeom = [];\r\n      geom.forEach(el => {\r\n        const coords = el.reverse();\r\n        // console.log(coords);\r\n        reversedGeom.push(coords);\r\n      });\r\n      return reversedGeom;\r\n    },\r\n    reverseCoordsPoly(geom) {\r\n      let reversedGeom = [];\r\n      geom.forEach(el => {\r\n        const coords = el.map(coord => {\r\n          return [coord[1], coord[0]];\r\n        });\r\n        reversedGeom.push(coords);\r\n      });\r\n      return reversedGeom;\r\n    },\r\n    hideLayer() {\r\n      this.drawnItems.eachLayer(layer => {\r\n        layer.getElement().style.display = 'none';\r\n      });\r\n    },\r\n    showLayer() {\r\n      this.drawnItems.eachLayer(layer => {\r\n        layer.getElement().style.display = 'block';\r\n      });\r\n    },\r\n  },\r\n  mounted: function() {\r\n    GV.app.map.on('draw:created', e => {\r\n      e.layer.addTo(this.drawnItems);\r\n    });\r\n    GV.eventBus.$on('gv-control-draw-deactivate', ev => {\r\n      GV.app.map.off('draw:created');\r\n      this.hideLayer();\r\n    });\r\n    GV.eventBus.$on('gv-control-draw-activate', ev => {\r\n      GV.app.map.on('draw:created', e => {\r\n        e.layer.addTo(this.drawnItems);\r\n      });\r\n      this.showLayer();\r\n      this.submitRefresh();\r\n    });\r\n\r\n    GV.app.map.on('draw:editstart', e => {\r\n      this.editing = true;\r\n    });\r\n    GV.app.map.on('draw:editstop', e => {\r\n      this.editing = false;\r\n    });\r\n\r\n    GV.app.map.on('draw:deletestart', e => {\r\n      this.editing = true;\r\n    });\r\n    GV.app.map.on('draw:deletestop', e => {\r\n      this.editing = false;\r\n    });\r\n\r\n    GV.app.map.on('draw:drawstart', e => {\r\n      this.editing = true;\r\n    });\r\n    GV.app.map.on('draw:drawstop', e => {\r\n      this.editing = false;\r\n    });\r\n\r\n    GV.app.map.on('draw:deleted', e => {\r\n      Object.keys(e.layers._layers).forEach(key => {\r\n        const item = {\r\n          type: e.layers._layers[key].options.type,\r\n          properties: e.layers._layers[key].options.properties,\r\n          id: e.layers._layers[key].options.id,\r\n          layerName: e.layers._layers[key].options.layerName,\r\n          latlngs:\r\n            e.layers._layers[key].options.type === 'point'\r\n              ? e.layers._layers[key]._latlng\r\n              : e.layers._layers[key]._latlngs,\r\n        };\r\n        this.deletedItems.push(item);\r\n      });\r\n    });\r\n\r\n    // GV.eventBus.$on('draw-saved-data', ev => {\r\n    //   // effettuo refresh\r\n    //   if (this.options.initWfsRequests) this.addLayerFeatures(this.options.initWfsRequests);\r\n    // });\r\n\r\n    this.drawnItems = L.featureGroup();\r\n    this.drawnItems.addTo(GV.app.map);\r\n\r\n    if (this.options.initWfsRequests) this.addLayerFeatures(this.options.initWfsRequests);\r\n\r\n    this.addDrawControl();\r\n\r\n    // rispulisco eventuali hilite\r\n    GV.app.map.getLayerByName('InfoWmsHilite').clearLayers();\r\n  },\r\n};\r\n</script>\r\n\r\n<style>\r\n.gv-draw-panel {\r\n  position: absolute;\r\n  width: 260px;\r\n  left: 0px;\r\n  top: 0px;\r\n  margin-left: 10px;\r\n  margin-top: 50px;\r\n  z-index: 800;\r\n}\r\n\r\n.gv-draw-panel-body {\r\n  padding: 10px;\r\n  overflow-y: auto;\r\n  width: 240px;\r\n  height: 80px;\r\n}\r\n\r\n.gv-draw-panel-result {\r\n  position: absolute;\r\n  padding-left: 3px;\r\n  margin: 0px;\r\n  width: 230px;\r\n}\r\n\r\n.gv-draw-buttons {\r\n  width: 20px;\r\n  float: left;\r\n  margin: 4px;\r\n}\r\n\r\n.gv-draw-buttons-reset {\r\n  width: 36px;\r\n  padding-left: 2px;\r\n}\r\n\r\n.leaflet-bar {\r\n  box-shadow: none;\r\n}\r\n.leaflet-draw-actions {\r\n  left: 2px;\r\n  top: 54px !important;\r\n}\r\n.leaflet-draw-actions a {\r\n  padding: 7px;\r\n  margin: 2px;\r\n}\r\n.leaflet-draw-actions li:last-child a {\r\n  -webkit-border-radius: 0 0 0 0;\r\n  border-radius: 0 0 0 0;\r\n}\r\n\r\n.leaflet-draw-actions li:first-child a {\r\n  margin-left: 4px;\r\n}\r\n.leaflet-draw-toolbar a {\r\n  background-image: none;\r\n}\r\n.leaflet-draw-toolbar .leaflet-draw-draw-polyline {\r\n  background-position: -2px -2px;\r\n}\r\n\r\n.leaflet-bar a:first-child {\r\n  border-top-left-radius: 0px;\r\n  border-top-right-radius: 0px;\r\n}\r\n.leaflet-bar a:last-child {\r\n  border-bottom-left-radius: 0px;\r\n  border-bottom-right-radius: 0px;\r\n  margin-right: 20px;\r\n}\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// Draw.vue?4e4291db","import axios from 'axios'\r\nimport globals from '../globals'\r\n\r\nexport default function (data) {\r\n  return axios\r\n    .post(globals.RL_TRANSFORM_POLY_SERVICE, {\r\n      headers: {\r\n        Accept: 'text/xml'\r\n      },\r\n      data: data,\r\n    })\r\n    .then(response => response.data)\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./D:/node-prj/geoviewer2/src/services/getCoordTransformPoly.js","exports = module.exports = require(\"./../../node_modules/css-loader/lib/css-base.js\")();\n// imports\n\n\n// module\nexports.push([module.id, \".gv-draw-panel{position:absolute;width:260px;left:0;top:0;margin-left:10px;margin-top:50px;z-index:800}.gv-draw-panel-body{padding:10px;overflow-y:auto;width:240px;height:80px}.gv-draw-panel-result{position:absolute;padding-left:3px;margin:0;width:230px}.gv-draw-buttons{width:20px;float:left;margin:4px}.gv-draw-buttons-reset{width:36px;padding-left:2px}.leaflet-bar{box-shadow:none}.leaflet-draw-actions{left:2px;top:54px!important}.leaflet-draw-actions a{padding:7px;margin:2px}.leaflet-draw-actions li:last-child a{border-radius:0 0 0 0}.leaflet-draw-actions li:first-child a{margin-left:4px}.leaflet-draw-toolbar a{background-image:none}.leaflet-draw-toolbar .leaflet-draw-draw-polyline{background-position:-2px -2px}.leaflet-bar a:first-child{border-top-left-radius:0;border-top-right-radius:0}.leaflet-bar a:last-child{border-bottom-left-radius:0;border-bottom-right-radius:0;margin-right:20px}\", \"\", {\"version\":3,\"sources\":[\"/./src/components/Draw.vue\"],\"names\":[],\"mappings\":\"AACA,eACE,kBAAmB,AACnB,YAAa,AACb,OAAU,AACV,MAAS,AACT,iBAAkB,AAClB,gBAAiB,AACjB,WAAa,CACd,AACD,oBACE,aAAc,AACd,gBAAiB,AACjB,YAAa,AACb,WAAa,CACd,AACD,sBACE,kBAAmB,AACnB,iBAAkB,AAClB,SAAY,AACZ,WAAa,CACd,AACD,iBACE,WAAY,AACZ,WAAY,AACZ,UAAY,CACb,AACD,uBACE,WAAY,AACZ,gBAAkB,CACnB,AACD,aACE,eAAiB,CAClB,AACD,sBACE,SAAU,AACV,kBAAqB,CACtB,AACD,wBACE,YAAa,AACb,UAAY,CACb,AACD,sCACE,qBAAuB,CACxB,AACD,uCACE,eAAiB,CAClB,AACD,wBACE,qBAAuB,CACxB,AACD,kDACE,6BAA+B,CAChC,AACD,2BACE,yBAA4B,AAC5B,yBAA6B,CAC9B,AACD,0BACE,4BAA+B,AAC/B,6BAAgC,AAChC,iBAAmB,CACpB\",\"file\":\"Draw.vue\",\"sourcesContent\":[\"\\n.gv-draw-panel {\\r\\n  position: absolute;\\r\\n  width: 260px;\\r\\n  left: 0px;\\r\\n  top: 0px;\\r\\n  margin-left: 10px;\\r\\n  margin-top: 50px;\\r\\n  z-index: 800;\\n}\\n.gv-draw-panel-body {\\r\\n  padding: 10px;\\r\\n  overflow-y: auto;\\r\\n  width: 240px;\\r\\n  height: 80px;\\n}\\n.gv-draw-panel-result {\\r\\n  position: absolute;\\r\\n  padding-left: 3px;\\r\\n  margin: 0px;\\r\\n  width: 230px;\\n}\\n.gv-draw-buttons {\\r\\n  width: 20px;\\r\\n  float: left;\\r\\n  margin: 4px;\\n}\\n.gv-draw-buttons-reset {\\r\\n  width: 36px;\\r\\n  padding-left: 2px;\\n}\\n.leaflet-bar {\\r\\n  box-shadow: none;\\n}\\n.leaflet-draw-actions {\\r\\n  left: 2px;\\r\\n  top: 54px !important;\\n}\\n.leaflet-draw-actions a {\\r\\n  padding: 7px;\\r\\n  margin: 2px;\\n}\\n.leaflet-draw-actions li:last-child a {\\r\\n  border-radius: 0 0 0 0;\\n}\\n.leaflet-draw-actions li:first-child a {\\r\\n  margin-left: 4px;\\n}\\n.leaflet-draw-toolbar a {\\r\\n  background-image: none;\\n}\\n.leaflet-draw-toolbar .leaflet-draw-draw-polyline {\\r\\n  background-position: -2px -2px;\\n}\\n.leaflet-bar a:first-child {\\r\\n  border-top-left-radius: 0px;\\r\\n  border-top-right-radius: 0px;\\n}\\n.leaflet-bar a:last-child {\\r\\n  border-bottom-left-radius: 0px;\\r\\n  border-bottom-right-radius: 0px;\\r\\n  margin-right: 20px;\\n}\\r\\n\"],\"sourceRoot\":\"webpack://\"}]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/css-loader?sourceMap!./~/vue-loader/lib/style-rewriter.js?id=data-v-782c17e8!./~/vue-loader/lib/selector.js?type=styles&index=0!./src/components/Draw.vue\n// module id = 496\n// module chunks = 24","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!./../../node_modules/css-loader/index.js?sourceMap!./../../node_modules/vue-loader/lib/style-rewriter.js?id=data-v-782c17e8!./../../node_modules/vue-loader/lib/selector.js?type=styles&index=0!./Draw.vue\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// add the styles to the DOM\nvar update = require(\"!./../../node_modules/vue-style-loader/addStyles.js\")(content, {});\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!./../../node_modules/css-loader/index.js?sourceMap!./../../node_modules/vue-loader/lib/style-rewriter.js?id=data-v-782c17e8!./../../node_modules/vue-loader/lib/selector.js?type=styles&index=0!./Draw.vue\", function() {\n\t\t\tvar newContent = require(\"!!./../../node_modules/css-loader/index.js?sourceMap!./../../node_modules/vue-loader/lib/style-rewriter.js?id=data-v-782c17e8!./../../node_modules/vue-loader/lib/selector.js?type=styles&index=0!./Draw.vue\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/extract-text-webpack-plugin/loader.js?{\"omit\":1,\"extract\":true,\"remove\":true}!./~/vue-style-loader!./~/css-loader?sourceMap!./~/vue-loader/lib/style-rewriter.js?id=data-v-782c17e8!./~/vue-loader/lib/selector.js?type=styles&index=0!./src/components/Draw.vue\n// module id = 623\n// module chunks = 24","var __vue_exports__, __vue_options__\nvar __vue_styles__ = {}\n\n/* styles */\nrequire(\"!!./../../node_modules/extract-text-webpack-plugin/loader.js?{\\\"omit\\\":1,\\\"extract\\\":true,\\\"remove\\\":true}!vue-style-loader!css-loader?sourceMap!vue-loader/lib/style-rewriter?id=data-v-782c17e8!vue-loader/lib/selector?type=styles&index=0!./Draw.vue\")\n\n/* script */\n__vue_exports__ = require(\"!!babel-loader!vue-loader/lib/selector?type=script&index=0!./Draw.vue\")\n\n/* template */\nvar __vue_template__ = require(\"!!vue-loader/lib/template-compiler?id=data-v-782c17e8!vue-loader/lib/selector?type=template&index=0!./Draw.vue\")\n__vue_options__ = __vue_exports__ = __vue_exports__ || {}\nif (\n  typeof __vue_exports__.default === \"object\" ||\n  typeof __vue_exports__.default === \"function\"\n) {\n__vue_options__ = __vue_exports__ = __vue_exports__.default\n}\nif (typeof __vue_options__ === \"function\") {\n  __vue_options__ = __vue_options__.options\n}\n\n__vue_options__.render = __vue_template__.render\n__vue_options__.staticRenderFns = __vue_template__.staticRenderFns\n\nmodule.exports = __vue_exports__\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/Draw.vue\n// module id = 695\n// module chunks = 24","module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;\n  return _vm._c('div', {\n    staticClass: \"gv-draw-panel\",\n    attrs: {\n      \"id\": \"gv-draw-panel\"\n    }\n  }, [_vm._c('gv-title', {\n    directives: [{\n      name: \"draggable\",\n      rawName: \"v-draggable\"\n    }],\n    attrs: {\n      \"title\": _vm.title,\n      \"divId\": 'gv-draw-panel',\n      \"noClose\": true\n    }\n  }), _vm._v(\" \"), _vm._m(0), _vm._v(\" \"), _vm._c('el-row', {\n    staticClass: \"row-bg\",\n    attrs: {\n      \"type\": \"flex\",\n      \"justify\": \"left\"\n    }\n  }, [_vm._c('el-button', {\n    staticClass: \"gv-color-scheme\",\n    attrs: {\n      \"id\": \"gv-draw-submit\",\n      \"title\": \"Salva i dati sul DB\",\n      \"size\": \"mini\"\n    },\n    on: {\n      \"click\": _vm.submit\n    }\n  }, [_vm._v(\"Salva su DB\")]), _vm._v(\" \"), _vm._c('el-button', {\n    directives: [{\n      name: \"show\",\n      rawName: \"v-show\",\n      value: (_vm.cancelButton),\n      expression: \"cancelButton\"\n    }],\n    staticClass: \"gv-color-scheme\",\n    attrs: {\n      \"id\": \"gv-draw-cancel\",\n      \"title\": \"Ritorno alla applicazione\",\n      \"size\": \"mini\"\n    },\n    on: {\n      \"click\": _vm.cancel\n    }\n  }, [_vm._v(\"Annulla\")]), _vm._v(\" \"), _vm._c('el-button', {\n    directives: [{\n      name: \"show\",\n      rawName: \"v-show\",\n      value: (_vm.refreshButton),\n      expression: \"refreshButton\"\n    }],\n    staticClass: \"gv-color-scheme\",\n    attrs: {\n      \"id\": \"gv-draw-cancel\",\n      \"title\": \"Ricarica dati salvati sul DB\",\n      \"size\": \"mini\"\n    },\n    on: {\n      \"click\": _vm.refresh\n    }\n  }, [_vm._v(\"Ricarica\")])], 1)], 1)\n},staticRenderFns: [function (){var _vm=this;var _h=_vm.$createElement;\n  return _vm._c('div', {\n    staticClass: \"gv-draw-panel-body gv-inverted-color-scheme\",\n    attrs: {\n      \"id\": \"gv-draw-panel-body\"\n    }\n  }, [_vm._c('div', {\n    staticClass: \"gv-draw-panel-result gv-inverted-color-scheme\"\n  }, [_vm._c('div', {\n    attrs: {\n      \"id\": \"gv-draw-panel-draw\"\n    }\n  })])])\n}]}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/vue-loader/lib/template-compiler.js?id=data-v-782c17e8!./~/vue-loader/lib/selector.js?type=template&index=0!./src/components/Draw.vue\n// module id = 840\n// module chunks = 24"],"sourceRoot":""}