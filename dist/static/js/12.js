webpackJsonp([12,36],{296:function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=o(399),r=n(i),l=o(9),a=(n(l),o(5)),s=(n(a),o(8)),u=n(s),p=o(1),c=n(p);c.default.use(u.default),t.default={name:"gv-measure-panel",data:function(){var e,t=GV.config.getToolOptions("gv-measure-button");return e={options:t,title:t.title||"Misurazioni",pointClass:"el-button--default el-button--mini el-button gv-color-scheme fg-measure",lineClass:"el-button--default el-button--mini el-button gv-color-scheme fg-measure-line",areaClass:"el-button--default el-button--mini el-button gv-color-scheme fg-measure-area",layer:null,type:null,sketch:null,helpTooltipElement:null,helpTooltip:null,measureTooltipElement:null,measureTooltip:null,continuePolygonMsg:"Click per continuare il disegno del poligono",continueLineMsg:"Click per continuare il disegno della linea"},(0,r.default)(e,"measureTooltip",null),(0,r.default)(e,"draw",null),(0,r.default)(e,"style",new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255, 255, 255, 0.2)"}),stroke:new ol.style.Stroke({color:"#ffcc33",width:2}),image:new ol.style.Circle({radius:7,fill:new ol.style.Fill({color:"#ffcc33"})})})),e},methods:{pointerMoveHandler:function(e){if(!e.dragging){var t="Click per disegnare";if(this.sketch){var o=this.sketch.getGeometry();o instanceof ol.geom.Polygon?t=this.continuePolygonMsg:o instanceof ol.geom.LineString&&(t=this.continueLineMsg)}this.helpTooltipElement.innerHTML=t,this.helpTooltip.setPosition(e.coordinate),this.helpTooltipElement.classList.remove("hidden")}},addInteraction:function(e){var t=this;this.draw=new ol.interaction.Draw({source:this.layer.getSource(),type:e,style:this.style}),GV.app.map.addInteraction(this.draw),this.createMeasureTooltip(),this.createHelpTooltip();var o=void 0;this.draw.on("drawstart",function(e){t.sketch=e.feature;var n=e.coordinate;o=t.sketch.getGeometry().on("change",function(e){var o=e.target,i=void 0;o instanceof ol.geom.Polygon?(i=t.formatArea(o),n=o.getInteriorPoint().getCoordinates()):o instanceof ol.geom.LineString&&(i=t.formatLength(o),n=o.getLastCoordinate()),t.measureTooltipElement.innerHTML=i,t.measureTooltip.setPosition(n)})}),this.draw.on("drawend",function(e){var n=t.sketch.getGeometry();n instanceof ol.geom.Point?t.printPointToolTip(n.getCoordinates(),o):(t.measureTooltipElement.className="ol-tooltip ol-tooltip-static",t.measureTooltip.setOffset([0,-7]),t.sketch=null,t.measureTooltipElement=null,t.createMeasureTooltip(),ol.Observable.unByKey(o))})},printPointToolTip:function(e,t){var o=this;this.measureTooltipElement.innerHTML="Trasformazione coordinate.<br>Attendere...",this.measureTooltip.setPosition(e),fetch("http://srvcarto.regione.liguria.it/geoservices/REST/coordinate/measure/"+e.join(",")).then(function(e){return e.json()}).then(function(n){console.log(n);var i=n.points[4326],r=n.points[3003],l=n.points[25832],a=n.elevation,s='\n              <table width="90%">\n              <tr><td>WGS84</td><td>'+i+"</td></tr>\n              <tr><td>GAUSS-BOAGA</td> <td>"+r+"</td></tr>\n              <tr><td>ETRS89/UTM32N</td> <td>"+l+"</td></tr> \n              <tr><td>QUOTA (s.l.m.)</td> <td>"+a+"</td>\n              </tr></table>          \n          ";o.measureTooltipElement.innerHTML=s,o.measureTooltip.setPosition(e),o.measureTooltipElement.className="ol-tooltip ol-tooltip-static",o.measureTooltip.setOffset([0,-12]),o.sketch=null,o.measureTooltipElement=null,o.createMeasureTooltip(),ol.Observable.unByKey(t)})},createMeasureTooltip:function(){this.measureTooltipElement&&this.measureTooltipElement.parentNode.removeChild(this.measureTooltipElement),this.measureTooltipElement=document.createElement("div"),this.measureTooltipElement.className="ol-tooltip ol-tooltip-measure",this.measureTooltip=new ol.Overlay({element:this.measureTooltipElement,offset:[0,-15],positioning:"bottom-center",stopEvent:!1,insertFirst:!1}),GV.app.map.addOverlay(this.measureTooltip)},createHelpTooltip:function(){this.helpTooltipElement&&this.helpTooltipElement.parentNode.removeChild(this.helpTooltipElement),this.helpTooltipElement=document.createElement("div"),this.helpTooltipElement.className="ol-tooltip hidden",this.helpTooltip=new ol.Overlay({element:this.helpTooltipElement,offset:[15,0],positioning:"center-left"}),GV.app.map.addOverlay(this.helpTooltip)},formatLength:function(e){var t=ol.sphere.getLength(e),o=void 0;return o=t>100?Math.round(t/1e3*100)/100+" km":Math.round(100*t)/100+" m"},formatArea:function(e){var t=ol.sphere.getArea(e),o=void 0;return o=t>1e4?Math.round(t/1e6*100)/100+" km<sup>2</sup>":Math.round(100*t)/100+" m<sup>2</sup>"},measure:function(e){this.type=e,this.setButtonClass(null),this.setButtonClass(e),this.layer.getSource().clear(!0),GV.app.map.getOverlays().clear(),GV.app.map.on("pointermove",this.pointerMoveHandler),this.draw&&GV.app.map.removeInteraction(this.draw),this.addInteraction(e)},setButtonClass:function(e){switch(document.getElementById("gv-measure-point").className=this.pointClass,document.getElementById("gv-measure-line").className=this.lineClass,document.getElementById("gv-measure-area").className=this.areaClass,e){case"Point":document.getElementById("gv-measure-point").className=this.pointClass+" gv-button-selected";break;case"LineString":document.getElementById("gv-measure-line").className=this.lineClass+" gv-button-selected";break;case"Polygon":document.getElementById("gv-measure-area").className=this.areaClass+" gv-button-selected"}},clear:function(){this.layer.getSource().clear(!0),GV.app.map.getOverlays().clear(),GV.app.map.removeInteraction(this.draw),this.setButtonClass(null)}},mounted:function(){var e=this;GV.eventBus.$on("gv-control-measure-activate",function(e){console.log("gv-control-measure-activate")}),GV.eventBus.$on("gv-control-measure-deactivate",function(t){console.log("gv-control-measure-deactivate"),e.clear()}),this.layer=new ol.layer.Vector({source:new ol.source.Vector,style:this.style,zIndex:800}),GV.app.map.addLayer(this.layer)}}},394:function(e,t,o){e.exports={default:o(405),__esModule:!0}},399:function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var i=o(394),r=n(i);t.default=function(e,t,o){return t in e?(0,r.default)(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}},405:function(e,t,o){o(442);var n=o(25).Object;e.exports=function(e,t,o){return n.defineProperty(e,t,o)}},442:function(e,t,o){var n=o(49);n(n.S+n.F*!o(48),"Object",{defineProperty:o(50).f})},457:function(e,t,o){t=e.exports=o(2)(),t.push([e.id,".gv-measure-panel{position:absolute;width:150px;left:0;top:0;margin-left:10px;margin-top:50px;z-index:800}.gv-measure-panel-body{position:absolute;padding:10px;overflow-y:auto;width:130px;height:25px}.ol-tooltip{position:relative;background:rgba(0,0,0,.5);border-radius:4px;color:#fff;padding:4px 8px;opacity:.7;white-space:nowrap;font-size:12px}.ol-tooltip-measure{opacity:1;font-weight:700}.ol-tooltip-static{background-color:#fc3;color:#000;border:1px solid #fff}.ol-tooltip-measure:before,.ol-tooltip-static:before{border-top:6px solid rgba(0,0,0,.5);border-right:6px solid transparent;border-left:6px solid transparent;content:'';position:absolute;bottom:-6px;margin-left:-7px;left:50%}.ol-tooltip-static:before{border-top-color:#fc3}","",{version:3,sources:["/./src/components/MeasureOL.vue"],names:[],mappings:"AACA,kBACE,kBAAmB,AACnB,YAAa,AACb,OAAU,AACV,MAAS,AACT,iBAAkB,AAClB,gBAAiB,AACjB,WAAa,CACd,AACD,uBACE,kBAAmB,AACnB,aAAc,AACd,gBAAiB,AACjB,YAAa,AACb,WAAa,CACd,AACD,YACE,kBAAmB,AACnB,0BAA+B,AAC/B,kBAAmB,AACnB,WAAa,AACb,gBAAiB,AACjB,WAAa,AACb,mBAAoB,AACpB,cAAgB,CACjB,AACD,oBACE,UAAW,AACX,eAAkB,CACnB,AACD,mBACE,sBAA0B,AAC1B,WAAa,AACb,qBAAwB,CACzB,AACD,qDAEE,oCAAyC,AACzC,mCAAoC,AACpC,kCAAmC,AACnC,WAAY,AACZ,kBAAmB,AACnB,YAAa,AACb,iBAAkB,AAClB,QAAU,CACX,AACD,0BACE,qBAA0B,CAC3B",file:"MeasureOL.vue",sourcesContent:["\n.gv-measure-panel {\r\n  position: absolute;\r\n  width: 150px;\r\n  left: 0px;\r\n  top: 0px;\r\n  margin-left: 10px;\r\n  margin-top: 50px;\r\n  z-index: 800;\n}\n.gv-measure-panel-body {\r\n  position: absolute;\r\n  padding: 10px;\r\n  overflow-y: auto;\r\n  width: 130px;\r\n  height: 25px;\n}\n.ol-tooltip {\r\n  position: relative;\r\n  background: rgba(0, 0, 0, 0.5);\r\n  border-radius: 4px;\r\n  color: white;\r\n  padding: 4px 8px;\r\n  opacity: 0.7;\r\n  white-space: nowrap;\r\n  font-size: 12px;\n}\n.ol-tooltip-measure {\r\n  opacity: 1;\r\n  font-weight: bold;\n}\n.ol-tooltip-static {\r\n  background-color: #ffcc33;\r\n  color: black;\r\n  border: 1px solid white;\n}\n.ol-tooltip-measure:before,\r\n.ol-tooltip-static:before {\r\n  border-top: 6px solid rgba(0, 0, 0, 0.5);\r\n  border-right: 6px solid transparent;\r\n  border-left: 6px solid transparent;\r\n  content: '';\r\n  position: absolute;\r\n  bottom: -6px;\r\n  margin-left: -7px;\r\n  left: 50%;\n}\n.ol-tooltip-static:before {\r\n  border-top-color: #ffcc33;\n}\r\n"],sourceRoot:"webpack://"}])},549:function(e,t,o){var n=o(457);"string"==typeof n&&(n=[[e.id,n,""]]);o(3)(n,{});n.locals&&(e.exports=n.locals)},730:function(e,t,o){var n,i;o(549),n=o(296);var r=o(779);i=n=n||{},"object"!=typeof n.default&&"function"!=typeof n.default||(i=n=n.default),"function"==typeof i&&(i=i.options),i.render=r.render,i.staticRenderFns=r.staticRenderFns,e.exports=n},779:function(e,t){e.exports={render:function(){var e=this;e.$createElement;return e._c("div",{staticClass:"gv-measure-panel",attrs:{id:"gv-measure-panel"}},[e._c("gv-title",{attrs:{title:e.title,divId:"gv-measure-panel",noClose:!0}}),e._v(" "),e._c("div",{staticClass:"gv-measure-panel-body gv-inverted-color-scheme"},[e._c("el-button",{staticClass:"gv-color-scheme fg-measure",attrs:{id:"gv-measure-point",title:"Misure Puntuali (Coordinate)",size:"mini"},on:{click:function(t){e.measure("Point")}}}),e._v(" "),e._c("el-button",{staticClass:"gv-color-scheme fg-measure-line",attrs:{id:"gv-measure-line",title:"Misure Lineari",size:"mini"},on:{click:function(t){e.measure("LineString")}}}),e._v(" "),e._c("el-button",{staticClass:"gv-color-scheme fg-measure-area",attrs:{id:"gv-measure-area",title:"Misure Areali",size:"mini"},on:{click:function(t){e.measure("Polygon")}}})],1)],1)},staticRenderFns:[]}}});
//# sourceMappingURL=12.js.map