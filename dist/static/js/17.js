webpackJsonp([17,38],{70:function(e,t,i){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var i="/geoservices/REST/sigmater/fogli/"+e+"/"+t;return n.default.get(i).then(function(e){return e.data.data})};var a=i(2),n=l(a),o=i(6);l(o)},71:function(e,t,i){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,i){var l="/geoservices/REST/sigmater/particelle/"+e+"/"+t+"/"+i;return n.default.get(l).then(function(e){return e.data.data})};var a=i(2),n=l(a),o=i(6);l(o)},253:function(e,t,i){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=i(141),n=(l(a),i(133)),o=l(n),r=i(36),c=(l(r),i(34)),s=l(c),u=i(9),d=(l(u),i(5)),p=(l(d),i(8)),f=l(p),g=i(1),v=l(g),h=i(31),A=l(h),y=i(91),m=l(y),_=i(37),C=l(_),b=i(70),x=l(b),z=i(71),B=l(z);v.default.use(f.default),v.default.use(s.default),v.default.use(o.default),t.default={name:"gv-cdu-seleziona-particelle-panel",data:function(){var e=GV.config.getToolOptions("gv-cdu-seleziona-particelle-button");return{comune:e.codComBelfiore,idLayerParticelle:"L6592",particelleSelezionate:[],hiliteLayer:null,sezione:"_",fogli:null,foglio:null,particelle:null,particella:null,options:e}},computed:{},methods:{subscribeMapEvent:function(e){var t=this;GV.app.map.on("click",function(e){if(t.layerConfig.visible){var i=t.getWmsUrl(e);(0,m.default)(i).then(function(e){e&&e[0]&&e[0].properties&&e[0].properties.ct24_id&&t.add(e[0].properties.ct24_id)})}})},getWmsUrl:function(e){return this.layerConfig?(this.layerConfig.wmsParams.infoFormat="application/json",this.layerConfig.infoBuffer=0,A.default.getGetFeatureInfoUrl(this.layerConfig,e)):void console.error("Configurazione Layer non trovata")},updateParticelleSelezionate:function(e){var t=this;e.forEach(function(e){t.alreadySelected(e)?(t.particelleSelezionate=t.particelleSelezionate.filter(function(t){return t.id!==e.id}),t.hiliteLayer.eachLayer(function(t){t.feature.id==e.id&&GV.app.map.removeLayer(t)})):t.addParticella(e)})},alreadySelected:function(e){var t=!1;return this.particelleSelezionate.forEach(function(i){e.id===i.id&&(t=!0)}),t},changeFoglio:function(e){var t=this;this.particelle=null,this.particella=null,(0,B.default)(this.comune,this.sezione,e).then(function(e){t.particelle=e})},add:function(e){var t=this;if(e||this.particella){e||(e=this.particella);var i="ct24_id = "+e,l="M2002:"+this.idLayerParticelle,a="https://geoservizi.regione.liguria.it/geoserver/wfs?service=WFS&version=2.0.0&request=GetFeature&srsName=EPSG%3A4326&outputFormat=application%2Fjson&typeName="+l+"&cql_filter="+i;(0,C.default)(null,null,a).then(function(e){t.updateParticelleSelezionate(e)})}},addParticella:function(e){this.particelleSelezionate.push(e),this.hiliteLayer.addData(e);var t=this.hiliteLayer.getBounds();GV.app.map.fitBounds(t,{maxZoom:18})},handleDelete:function(e,t){this.particelleSelezionate=this.particelleSelezionate.filter(function(e){return e.id!==t.id}),this.hiliteLayer.eachLayer(function(e){e.feature.id==t.id&&GV.app.map.removeLayer(e)})},submit:function(){confirm("Sei sicuro?")},loadLayer:function(){GV.app.map.loadLayers([{name:"SelezioneParticelle",type:"JSON",style:{color:"#ffcc00",fillOpacity:0,weight:5,opacity:.6},visible:!0}]),this.hiliteLayer=GV.app.map.getLayerByName("SelezioneParticelle")},hideLayer:function(){this.hiliteLayer.eachLayer(function(e){e.getElement().style.display="none"})},showLayer:function(){this.hiliteLayer.eachLayer(function(e){e.getElement().style.display="block"})}},mounted:function(){var e=this;(0,x.default)(this.comune,this.sezione).then(function(t){e.fogli=t}),this.layerConfig=GV.config.getLayerConfig(this.idLayerParticelle),this.layerConfig||GV.eventBus.$on("gv-config-init",function(t){e.layerConfig=GV.config.getLayerConfig(e.idLayerParticelle)}),this.loadLayer(),GV.eventBus.$on("gv-control-cdu-seleziona-particelle-activate",function(t){e.subscribeMapEvent(t),e.showLayer()}),GV.eventBus.$on("gv-control-cdu-seleziona-particelle-deactivate",function(t){GV.app.map.off("click"),e.hideLayer()}),this.subscribeMapEvent(event)}}},521:function(e,t,i){t=e.exports=i(3)(),t.push([e.id,".gv-cdu-seleziona-particelle-panel{position:absolute;width:340px;left:0;top:0;margin-left:10px;margin-top:50px;z-index:800}.gv-cdu-seleziona-particelle-body{padding:5px;width:330px;height:350px}.gv-cdu-seleziona-particelle-table{width:320px;height:200px;min-height:200px;max-height:200px}.gv-cdu-seleziona-padding-left{padding-left:5px}.el-row{padding:5px}.el-table{overflow-y:scroll;max-height:200px}","",{version:3,sources:["/./src/components/CduSelezionaParticelle.vue"],names:[],mappings:"AACA,mCACE,kBAAmB,AACnB,YAAa,AACb,OAAU,AACV,MAAS,AACT,iBAAkB,AAClB,gBAAiB,AACjB,WAAa,CACd,AACD,kCACE,YAAa,AACb,YAAa,AACb,YAAc,CACf,AACD,mCACE,YAAa,AACb,aAAc,AACd,iBAAkB,AAClB,gBAAkB,CACnB,AACD,+BACE,gBAAkB,CACnB,AACD,QACE,WAAyB,CAC1B,AACD,UACE,kBAAmB,AACnB,gBAAkB,CACnB",file:"CduSelezionaParticelle.vue",sourcesContent:["\n.gv-cdu-seleziona-particelle-panel {\n  position: absolute;\n  width: 340px;\n  left: 0px;\n  top: 0px;\n  margin-left: 10px;\n  margin-top: 50px;\n  z-index: 800;\n}\n.gv-cdu-seleziona-particelle-body {\n  padding: 5px;\n  width: 330px;\n  height: 350px;\n}\n.gv-cdu-seleziona-particelle-table {\n  width: 320px;\n  height: 200px;\n  min-height: 200px;\n  max-height: 200px;\n}\n.gv-cdu-seleziona-padding-left {\n  padding-left: 5px;\n}\n.el-row {\n  padding: 5px 5px 5px 5px;\n}\n.el-table {\n  overflow-y: scroll;\n  max-height: 200px;\n}\n"],sourceRoot:"webpack://"}])},660:function(e,t,i){var l=i(521);"string"==typeof l&&(l=[[e.id,l,""]]);i(4)(l,{});l.locals&&(e.exports=l.locals)},721:function(e,t,i){var l,a;i(660),l=i(253);var n=i(901);a=l=l||{},"object"!=typeof l.default&&"function"!=typeof l.default||(a=l=l.default),"function"==typeof a&&(a=a.options),a.render=n.render,a.staticRenderFns=n.staticRenderFns,e.exports=l},901:function(e,t){e.exports={render:function(){var e=this;e.$createElement;return e._c("div",{staticClass:"gv-cdu-seleziona-particelle-panel",attrs:{id:"gv-cdu-seleziona-particelle-panel"}},[e._c("gv-title",{attrs:{title:"Stampa C.D.U.",divId:"gv-cdu-seleziona-particelle-panel",noClose:!0}}),e._v(" "),e._c("div",{staticClass:"gv-cdu-seleziona-particelle-body gv-inverted-color-scheme"},[e._c("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"left"}},[e._c("div",{staticClass:"gv-cdu-seleziona-padding-left"},[e._c("b",[e._v("PARTICELLE SELEZIONATE")])])]),e._v(" "),e._c("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"left"}},[e._c("div",{staticClass:"gv-cdu-seleziona-particelle-table"},[e._c("el-table",{attrs:{data:e.particelleSelezionate,border:"","cell-style":{padding:"2px",maxHeight:"10px"}}},[e._c("el-table-column",{attrs:{label:"FOGLIO",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._c("span",[e._v(e._s(t.row.properties.ct24_foglio))])]}}])}),e._v(" "),e._c("el-table-column",{attrs:{label:"MAPPALE",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._c("span",[e._v(e._s(t.row.properties.ct24_numero))])]}}])}),e._v(" "),e._c("el-table-column",{attrs:{width:"50"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._c("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(i){e.handleDelete(t.$index,t.row)}}})]}}])})],1)],1)]),e._v(" "),e._c("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"left"}},[e._c("div",{staticClass:"gv-cdu-seleziona-padding-left"},[e._v("Aggiungi una particella:")])]),e._v(" "),e._c("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"left"}},[e._c("el-select",{attrs:{id:"gv-cdu-seleziona-fogli-select",size:"mini",placeholder:"Foglio","no-data-text":"Seleziona una Sezione",filterable:""},on:{change:e.changeFoglio},model:{value:e.foglio,callback:function(t){e.foglio=t},expression:"foglio"}},e._l(e.fogli,function(t){return e._c("el-option",{key:t.id,attrs:{label:t.id,value:t.id}})})),e._v(" "),e._c("el-select",{attrs:{id:"gv-cdu-seleziona-particelle-select",size:"mini",placeholder:"Particella","no-data-text":"Seleziona una Foglio",filterable:""},model:{value:e.particella,callback:function(t){e.particella=t},expression:"particella"}},e._l(e.particelle,function(t){return e._c("el-option",{key:t.id,attrs:{label:t.label,value:t.id}})})),e._v(" "),e._c("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-plus"},on:{click:function(t){e.add()}}})],1),e._v(" "),e._c("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"left"}},[e._c("div",{staticClass:"gv-cdu-seleziona-padding-left"},[e._v("\n        E' anche possibile aggiungere/cancellare particelle selezionandole sulla mappa.\n      ")])])],1),e._v(" "),e._c("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"left"}},[e._c("div",{staticClass:"gv-cdu-seleziona-padding-left"},[e._c("el-button",{ref:"button",attrs:{id:"gv-cdu-seleziona-particelle-panel-submit",title:"Salva i dati sul DB",type:"primary",size:"mini",disabled:e.buttonDisabled},on:{click:function(t){e.submit()}}},[e._c("span",[e._v("Stampa PDF")])])],1)])],1)},staticRenderFns:[]}}});
//# sourceMappingURL=17.js.map