{"version":3,"sources":["webpack:///static/js/20.js","webpack:///./E:/node-prj/geoviewer2/src/services/getCoordTransformPoly.js?ea88","webpack:///Draw.vue","webpack:///./src/components/Draw.vue?2516","webpack:///./src/components/Draw.vue?604a","webpack:///./src/components/Draw.vue","webpack:///./src/components/Draw.vue?a666"],"names":["webpackJsonp","99","module","exports","__webpack_require__","_interopRequireDefault","obj","__esModule","default","Object","defineProperty","value","data","_axios2","post","_globals2","RL_TRANSFORM_POLY_SERVICE","headers","Accept","then","response","_axios","_globals","232","_loading","_loading3","_loading4","_keys","_keys2","_notification","_notification3","_notification4","_col","_col3","_col4","_row","_row3","_row4","_button","_base","_button3","_button4","_vue","_vue2","_getCoordTransform","_getCoordTransform2","_getCoordTransformPoly","_getCoordTransformPoly2","_getWFSFeature","_getWFSFeature2","use","name","options","GV","config","getToolOptions","title","defaultColor","results","requestCount","numRequests","drawnItems","editing","deletedItems","submitButton","buttons","submit","cancelButton","cancel","refreshButton","refresh","computed","methods","this","r","confirm","initWfsRequests","addLayerFeatures","submitOK","_this","type","duration","offset","dangerouslyUseHTMLString","position","message","_layers","map","key","properties","id","layerName","latlngs","_latlng","_latlngs","length","loading","service","text","background","forEach","item","convertCoords","submitRefresh","checkEndRequests","convertCoordsPoint","convertCoordsLine","convertCoordsPolygon","_this2","epsg","geom","lng","toFixed","lat","points","split","_this3","resultLine","latlng","push","srsIn","srsOut","poly","_this4","setEditOptions","editOptions","tools","edit","remove","featureGroup","allowIntersection","L","EditToolbar","Delete","include","removeAllLayers","setDrawOptions","drawOptions","draw","rectangle","marker","circle","point","circlemarker","radius","color","polyline","shapeOptions","polygon","addDrawControl","controlDraw","Control","Draw","app","addControl","addDrawToolbar","addEditToolbar","drawPanel","document","getElementById","appendChild","_toolbars","_toolbarContainer","_actionsContainer","getElementsByClassName","className","el","_el","_this5","clearLayers","request","wfsURL","features","feature","createGeometry","bounds","getBounds","_northEast","_southWest","fitBounds","maxZoom","catch","error","console","geometry","circleMarker","latLng","coordinates","reverse","weight","opacity","fillOpacity","addTo","reverseCoordsLine","warn","reverseCoordsPoly","reversedGeom","coords","coord","hideLayer","eachLayer","layer","getElement","style","display","showLayer","mounted","_this6","on","e","eventBus","$on","ev","off","layers","getLayerByName","448","version","sources","names","mappings","file","sourcesContent","sourceRoot","561","content","locals","631","__vue_exports__","__vue_options__","__vue_template__","render","staticRenderFns","755","_vm","$createElement","_c","staticClass","attrs","directives","rawName","divId","noClose","_v","_m","justify","size","click","expression"],"mappings":"AAAAA,cAAc,GAAG,KAEXC,GACA,SAAUC,EAAQC,EAASC,GAEhC,YAyBA,SAASC,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,QAASF,GAvBvFG,OAAOC,eAAeP,EAAS,cAC7BQ,OAAO,IAGTR,EAAQK,QCRM,SAAUI,GACvB,MAAOC,GAAAL,QACJM,KAAKC,EAAAP,QAAQQ,2BACZC,SACEC,OAAQ,YAEVN,KAAMA,IAEPO,KAAK,SAAAC,GAAA,MAAYA,GAASR,OAX/B,IAAAS,GAAAjB,EAAA,GDwBKS,EAAUR,EAAuBgB,GCvBtCC,EAAAlB,EAAA,GD2BKW,EAAYV,EAAuBiB,IAMlCC,IACA,SAAUrB,EAAQC,EAASC,GAEhC,YAsEA,SAASC,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,QAASF,GApEvFG,OAAOC,eAAeP,EAAS,cAC7BQ,OAAO,GAGT,IAAIa,GAAWpB,EAAoB,IAI/BqB,GAFYpB,EAAuBmB,GAEvBpB,EAAoB,KAEhCsB,EAAYrB,EAAuBoB,GAEnCE,EAAQvB,EAAoB,IAE5BwB,EAASvB,EAAuBsB,GAEhCE,EAAgBzB,EAAoB,IAIpC0B,GAFiBzB,EAAuBwB,GAEvBzB,EAAoB,KAErC2B,EAAiB1B,EAAuByB,GAExCE,EAAO5B,EAAoB,IAI3B6B,GAFQ5B,EAAuB2B,GAEvB5B,EAAoB,KAE5B8B,EAAQ7B,EAAuB4B,GAE/BE,EAAO/B,EAAoB,IAI3BgC,GAFQ/B,EAAuB8B,GAEvB/B,EAAoB,KAE5BiC,EAAQhC,EAAuB+B,GAE/BE,EAAUlC,EAAoB,GAI9BmC,GAFWlC,EAAuBiC,GAE1BlC,EAAoB,IAI5BoC,GAFSnC,EAAuBkC,GAErBnC,EAAoB,IAE/BqC,EAAWpC,EAAuBmC,GEjDvCE,EAAAtC,EAAA,GFqDKuC,EAAQtC,EAAuBqC,GEpDpCE,EAAAxC,EAAA,IFwDKyC,EAAsBxC,EAAuBuC,GEvDlDE,EAAA1C,EAAA,IF2DK2C,EAA0B1C,EAAuByC,GExDtDE,EAAA5C,EAAA,IF4DK6C,EAAkB5C,EAAuB2C,EE3D9CL,GAAAnC,QAAA0C,IAAAT,EAAAjC,SACAmC,EAAAnC,QAAA0C,IAAAb,EAAA7B,SACAmC,EAAAnC,QAEA0C,IAAAhB,EAAA1B,SF+DCL,EAAQK,SACN2C,KE9DH,gBF+DGvC,KAAM,WACJ,GAAIwC,GAAUC,GAAGC,OAAOC,eE9D7B,iBF+DK,QACEH,QE9DPA,EF+DOI,ME9DP,yBF+DOC,aE9DP,UF+DOC,WACAC,aE9DP,EF+DOC,YE9DP,EF+DOC,WE9DP,KF+DOC,SE9DP,EF+DOC,gBACAC,aAAcZ,EAAQa,SAAWb,EAAQa,QE9DhDC,OF+DOC,aAAcf,EAAQa,SAAWb,EAAQa,QE9DhDG,OF+DOC,cAAejB,EAAQa,SAAWb,EAAQa,QE7DjDK,UFiEGC,YACAC,SACEJ,OAAQ,WACFK,KAAKrB,QAAQgB,QAAQK,KAAKrB,QAAQgB,OAAOK,KE/DpDf,UFiEKY,QAAS,WACP,GAAII,GE/DXC,QAEA,8EF8DgB,IAALD,IACFD,KAAKf,WACLe,KAAKV,gBACDU,KAAKrB,QAAQwB,iBAAiBH,KAAKI,iBAAiBJ,KAAKrB,QE7DtEwB,mBFiEKV,OAAQ,WACN,GAAIQ,GAAIC,QE7Df,cF8DgB,IAALD,GACFD,KE7DTK,YFiEKA,SAAU,WE7Df,GAAAC,GAAAN,IFgEO,OAAIA,MAAKX,aACP,EAAI/B,EAAevB,UACjBgD,ME/DX,aFgEWwB,KE/DX,UFgEWC,SE/DX,IFgEWC,OE/DX,GFgEWC,0BE/DX,EFgEWC,SE/DX,cFgEWC,QE9DX,8EFkEOZ,KAAKd,aE/DZ,EFgEOc,KAAKf,SAAU,EAAI9B,EAAOpB,SAASiE,KAAKZ,WAAWyB,SAASC,IAAI,SAAUC,GACxE,OACER,KAAMD,EAAMlB,WAAWyB,QAAQE,GAAKpC,QE/D/C4B,KFgEWS,WAAYV,EAAMlB,WAAWyB,QAAQE,GAAKpC,QE/DrDqC,WFgEWC,GAAIX,EAAMlB,WAAWyB,QAAQE,GAAKpC,QE/D7CsC,GFgEWC,UAAWZ,EAAMlB,WAAWyB,QAAQE,GAAKpC,QE/DpDuC,UACAC,QACA,UADAb,EAAAlB,WAAAyB,QAAAE,GAAApC,QAAA4B,KACAD,EAAAlB,WAAAyB,QAAAE,GACAK,QAAAd,EAAAlB,WAAAyB,QAAAE,GAEAM,YF8DOrB,KAAKb,YAAca,KAAKf,QE5D/BqC,OF6DmC,IAAxBtB,KAAKf,QAAQqC,QAA6C,IAA7BtB,KAAKV,aAAagC,YACjD,EAAIhE,EAAevB,UACjBgD,ME5DX,aF6DWwB,KE5DX,UF6DWC,SE5DX,IF6DWC,OE5DX,GF6DWE,SE5DX,cACAC,QAEA,yFF+DOZ,KAAKuB,QAAUtE,EAAUlB,QAAQyF,SAC/BC,KEvDT,iBFwDSC,WEtDT,4BFwDmC,IAAxB1B,KAAKf,QAAQqC,OACftB,KAAKrB,QAAQc,OAAOO,KAAKf,QAASe,KAAKV,aAAcU,KEvD9DuB,SFyDSvB,KAAKf,QAAQ0C,QAAQ,SAAUC,GAC7BtB,EAAMuB,cEvDjBD,SF2DKE,cAAe,WACb9B,KAAKf,WACLe,KAAKV,gBACDU,KAAKrB,QAAQwB,iBAAiBH,KAAKI,iBAAiBJ,KAAKrB,QEvDpEwB,kBFyDK4B,iBAAkB,WACZ/B,KAAKd,eAAiBc,KAAKb,aAC7Ba,KAAKrB,QAAQc,OAAOO,KAAKf,QAASe,KAAKV,aAAcU,KAAKuB,QAASvB,KEtD5E8B,gBFyDKD,cAAe,SAAuBD,GACpC,OAAQA,EEtDfrB,MFuDS,IEtDT,QFuDWP,KAAKgC,mBEtDhBJ,EACA,MFuDS,KEtDT,WFuDW5B,KAAKiC,kBEtDhBL,EACA,MFuDS,KEtDT,UFuDW5B,KAAKkC,qBEtDhBN,KF0DKI,mBAAoB,SAA4BJ,GEtDrD,GAAAO,GAAAnC,IFyDiC,UAAtBA,KAAKrB,QAAQyD,MACfpC,KExDTd,eFyDS0C,EAAKS,MAAQT,EAAKT,QAAQmB,IAAIC,QAAQ,GAAIX,EAAKT,QAAQqB,IAAID,QExDpE,IFyDSvC,KExDT+B,qBF0DS,EAAI3D,EAAoBrC,SAAS,OAAQiE,KAAKrB,QAAQyD,KAAMR,EAAKT,QAAQmB,IAAKV,EAAKT,QAAQqB,KExDpG9F,KAAA,SAAAC,GFyDWwF,EEvDXjD,eFwDevC,EAASR,KAAKsG,SAChBb,EAAKS,KAAO1F,EAASR,KAAKsG,OAAO,GAAGC,MEvDjD,MFyDWP,EEvDXJ,sBF2DKE,kBAAmB,SAA2BL,GErDnD,GAAAe,GAAA3C,KFwDW4C,IAIJ,IAHAhB,EAAKT,QAAQQ,QAAQ,SAAUkB,GAC7BD,EAAWE,MAAMD,EAAOP,IAAKO,EEvDtCL,QFyDiC,SAAtBxC,KAAKrB,QAAQyD,KACfpC,KEvDTd,eFwDS0C,EAAKS,KEvDdO,EFwDS5C,KEvDT+B,uBACA,CFwDS,GAAI5F,IACF4G,MEvDX,OFwDWC,OAAQhD,KAAKrB,QEvDxByD,KFwDWa,KEtDXL,IFwDS,EAAItE,EAAwBvC,SAASI,GAAMO,KAAK,SAAUC,GACxDgG,EEvDXzD,eFwDW0C,EAAKS,KAAO1F,EEvDvBsG,KFwDWN,EEvDXZ,uBF2DKG,qBAAsB,SAA8BN,GEvDzD,GAAAsB,GAAAlD,KF0DW4C,IAMJ,IALAhB,EAAKT,QAAQQ,QAAQ,SAAUsB,GAC7BA,EAAKtB,QAAQ,SAAUkB,GACrBD,EAAWE,MAAMD,EAAOP,IAAKO,EEvDxCL,UF0DiC,SAAtBxC,KAAKrB,QAAQyD,KACfpC,KEvDTd,eFwDS0C,EAAKS,KEvDdO,EFwDS5C,KEvDT+B,uBACA,CFwDS,GAAI5F,IACF4G,MEvDX,OFwDWC,OAAQhD,KAAKrB,QEvDxByD,KFwDWa,KEtDXL,IFwDS,EAAItE,EAAwBvC,SAASI,GAAMO,KAAK,SAAUC,GACxDuG,EEvDXhE,eFwDW0C,EAAKS,KAAO1F,EEvDvBsG,KFwDWC,EEvDXnB,uBF2DKoB,eAAgB,WACd,GAAIC,GEvDX,IF2EO,OAnBIpD,MAAKrB,QAAQ0E,MAAMC,OACjBtD,KAAKrB,QAAQ0E,MAAMC,KAAKA,MAAQtD,KAAKrB,QAAQ0E,MAAMC,KAAKC,UAC1DH,GACEI,aAAcxD,KEvD3BZ,WFwDa6D,MACEQ,mBErDf,IFwDgBzD,KAAKrB,QAAQ0E,MAAMC,KAAKC,SAC3BH,EAAYG,QEvDzB,GFyDgBvD,KAAKrB,QAAQ0E,MAAMC,KAAKA,OAC3BF,EAAYE,MEvDzB,GFyDWI,EAAEC,YAAYC,OAAOC,SACnBC,iBEtDb,KAGAV,GFyDKW,eAAgB,WACd,GAAIC,GEvDX,IF8FO,OAtCIhE,MAAKrB,QAAQ0E,MAAMY,OACrBD,GACEE,WEvDX,EFwDWC,QEvDX,EFwDWC,QErDX,GFwDapE,KAAKrB,QAAQ0E,MAAMY,KAAKI,MAC1BL,EAAYM,cACV/D,KEvDb,QFwDagE,OEvDb,EFwDaC,MAAOxE,KAAKrB,QAAQ6F,OAASxE,KEtD1ChB,cFyDWgF,EAAYM,cEvDvB,EFyDatE,KAAKrB,QAAQ0E,MAAMY,KAAKQ,SAC1BT,EAAYS,UACVC,cACEnE,KEvDf,WFwDeiE,MAAOxE,KAAKrB,QAAQ6F,OAASxE,KErD5ChB,eFyDWgF,EAAYS,UEvDvB,EFyDazE,KAAKrB,QAAQ0E,MAAMY,KAAKU,QAC1BX,EAAYW,SACVD,cACEnE,KEvDf,UFwDeiE,MAAOxE,KAAKrB,QAAQ6F,OAASxE,KEtD5ChB,cFwDayE,mBEtDb,GFyDWO,EAAYW,SEvDvB,GAGAX,GFyDKY,eAAgB,WACd,GAAIxB,GAAcpD,KEvDzBmD,iBFwDWa,EAAchE,KEtDzB+D,gBFwDO/D,MAAK6E,YAAc,GAAInB,GAAEoB,QAAQC,MAC/Bd,KEvDTD,EFwDSV,KEtDTF,IFwDOxE,GAAGoG,IAAIlE,IAAImE,WAAWjF,KEtD7B6E,aFwDO7E,KEvDPkF,iBFwDOlF,KEvDPmF,kBFyDKD,eAAgB,WACd,GAAIlF,KAAKrB,QAAQ0E,MAAMY,KEvD9B,CFwDS,GAAImB,GAAYC,SAASC,eEvDlC,qBFwDSF,GAAUG,YAAYvF,KAAK6E,YAAYW,UAAgB,KEvDhEC,mBFwDSL,EAAUG,YAAYvF,KAAK6E,YAAYW,UAAgB,KEvDhEE,mBFwDa1F,KAAKrB,QAAQ0E,MAAMY,KAAKI,QAC1BgB,SAASM,uBAAuB,kCAAkC,GEvD7EC,UACA,oCFwDa5F,KAAKrB,QAAQ0E,MAAMY,KAAKQ,WAC1BY,SAASM,uBAAuB,8BAA8B,GEtDzEC,UACA,mCFuDa5F,KAAKrB,QAAQ0E,MAAMY,KAAKU,UAC1BU,SAASM,uBAAuB,6BAA6B,GErDxEC,UACA,wCFwDKT,eAAgB,WACd,GAAInF,KAAKrB,QAAQ0E,MAAMC,KEpD9B,CFqDS,GAAI8B,GAAYC,SAASC,eEpDlC,qBFyDS,KAJItF,KAAKrB,QAAQ0E,MAAMC,KAAKA,MAAQtD,KAAKrB,QAAQ0E,MAAMC,KAAKC,UAC1D6B,EAAUG,YAAYvF,KAAK6E,YAAYW,UAAgB,KEpDlEC,mBFqDWL,EAAUG,YAAYvF,KAAK6E,YAAYW,UAAgB,KEpDlEE,oBFsDa1F,KAAKrB,QAAQ0E,MAAMC,KAAKA,KEpDrC,CFqDW,GAAIuC,GAAKR,SAASM,uBAAuB,0BEpDpD,EFqDWE,GAAGD,UEpDd,6BFsDS,GAAI5F,KAAKrB,QAAQ0E,MAAMC,KAAKC,OEpDrC,CFqDW,GAAIuC,GAAMT,SAASM,uBAAuB,4BEpDrD,EFqDWG,GAAIF,UEpDf,iCFwDKxF,iBAAkB,SAA0BD,GEnDjD,GAAA4F,GAAA/F,IFsDOA,MAAKZ,WErDZ4G,cFsDO7F,EAAgBwB,QAAQ,SAAUsE,IAChC,EAAIzH,EAAgBzC,SAAS,KAAM,KAAMkK,EErDlDC,QAAAxJ,KAAA,SAAAyJ,GFsDWA,EAASxE,QAAQ,SAAUyE,GACzBL,EAAOM,eAAeD,EAASH,EEpD5C/E,YFsDW,IAAIoF,GAASP,EAAO3G,WEpD/BmH,WFqDeD,GAAOE,YAAcF,EAAOG,YAC9B7H,GAAGoG,IAAIlE,IAAI4F,UAAUX,EAAO3G,WAAWmH,aACrCI,QEnDf,OAEAC,MAAA,SAAAC,GFqDWC,QAAQD,MEnDnBA,QFuDKR,eAAgB,SAAwBD,EAASlF,GAC/C,GAAImB,GElDX,IFmDO,QAAQ+D,EAAQW,SElDvBxG,MFmDS,IElDT,QFmDW8B,EAAOqB,EAAEsD,aAAatD,EAAEuD,OAAOb,EAAQW,SAASG,YAAYC,YAC1D5G,KElDb,QFmDaiE,MAAOxE,KAAKrB,QAAQ6F,OAASxE,KElD1ChB,aFmDauF,OElDb,EFmDa6C,OElDb,EFmDaC,QElDb,GFmDaC,YElDb,GFmDarG,GAAImF,EElDjBnF,GFmDaC,UElDbA,EFmDaF,WAAYoF,EEjDzBpF,aFmDeqB,GAAMA,EAAKkF,MAAMvH,KElDhCZ,WACA,MFmDS,KElDT,aFmDW,GAAIqF,GAAWzE,KAAKwH,kBAAkBpB,EAAQW,SElDzDG,YFmDW7E,GAAOqB,EAAEe,SAASA,GAChBlE,KElDb,WFmDaiE,MAAOxE,KAAKrB,QAAQ6F,OAASxE,KElD1ChB,aFmDaiC,GAAImF,EElDjBnF,GFmDaC,UElDbA,EFmDaF,WAAYoF,EEjDzBpF,aFmDeqB,GAAMA,EAAKkF,MAAMvH,KElDhCZ,WACA,MFmDS,KElDT,kBFmDW0H,QAAQW,KAAK,gDExCxBrB,EACA,MF0CS,KEzCT,UF0CW,GAAInD,GAAOjD,KAAK0H,kBAAkBtB,EAAQW,SEzCrDG,YF0CW7E,GAAOqB,EAAEiB,QAAQ1B,GACf1C,KEzCb,UF0CaiE,MAAOxE,KAAKrB,QAAQ6F,OAASxE,KEzC1ChB,aF0CaiC,GAAImF,EEzCjBnF,GF0CaC,UEzCbA,EF0CaF,WAAYoF,EExCzBpF,aF0CeqB,GAAMA,EAAKkF,MAAMvH,KEzChCZ,WACA,MF0CS,KEzCT,eF0CW0H,QAAQW,KAAK,6CE/BxBrB,KFoCKoB,kBAAmB,SAA2BnF,GAC5C,GAAIsF,KAMJ,OALAtF,GAAKV,QAAQ,SAAUkE,GACrB,GAAI+B,GAAS/B,EE9BtBsB,SFgCSQ,GAAa7E,KE/BtB8E,KAEAD,GFiCKD,kBAAmB,SAA2BrF,GAC5C,GAAIsF,KAOJ,OANAtF,GAAKV,QAAQ,SAAUkE,GACrB,GAAI+B,GAAS/B,EAAG/E,IAAI,SAAU+G,GAC5B,OAAQA,EAAM,GAAIA,EE/B7B,KFiCSF,GAAa7E,KE/BtB8E,KAEAD,GFiCKG,UAAW,WACT9H,KAAKZ,WAAW2I,UAAU,SAAUC,GAClCA,EAAMC,aAAaC,MAAMC,QE/BlC,UFkCKC,UAAW,WACTpI,KAAKZ,WAAW2I,UAAU,SAAUC,GAClCA,EAAMC,aAAaC,MAAMC,QE/BlC,YFmCGE,QAAS,WE/BZ,GAAAC,GAAAtI,IFkCKpB,IAAGoG,IAAIlE,IAAIyH,GAAG,eAAgB,SAAUC,GACtCA,EAAER,MAAMT,MAAMe,EEjCrBlJ,cFmCKR,GAAG6J,SAASC,IAAI,6BAA8B,SAAUC,GACtD/J,GAAGoG,IAAIlE,IAAI8H,IEjClB,gBFkCON,EEjCPR,cFmCKlJ,GAAG6J,SAASC,IAAI,2BAA4B,SAAUC,GACpD/J,GAAGoG,IAAIlE,IAAIyH,GAAG,eAAgB,SAAUC,GACtCA,EAAER,MAAMT,MAAMe,EEjCvBlJ,cFmCOkJ,EEjCPF,YFkCOE,EEjCPxG,kBFoCKlD,GAAGoG,IAAIlE,IAAIyH,GAAG,iBAAkB,SAAUC,GACxCF,EAAOjJ,SEjCd,IFmCKT,GAAGoG,IAAIlE,IAAIyH,GAAG,gBAAiB,SAAUC,GACvCF,EAAOjJ,SEjCd,IFoCKT,GAAGoG,IAAIlE,IAAIyH,GAAG,mBAAoB,SAAUC,GAC1CF,EAAOjJ,SEjCd,IFmCKT,GAAGoG,IAAIlE,IAAIyH,GAAG,kBAAmB,SAAUC,GACzCF,EAAOjJ,SEjCd,IFoCKT,GAAGoG,IAAIlE,IAAIyH,GAAG,iBAAkB,SAAUC,GACxCF,EAAOjJ,SEjCd,IFmCKT,GAAGoG,IAAIlE,IAAIyH,GAAG,gBAAiB,SAAUC,GACvCF,EAAOjJ,SEjCd,IFoCKT,GAAGoG,IAAIlE,IAAIyH,GAAG,eAAgB,SAAUC,IACtC,EAAIrL,EAAOpB,SAASyM,EAAEK,OAAOhI,SAASc,QAAQ,SAAUZ,GACtD,GAAIa,IACFrB,KAAMiI,EAAEK,OAAOhI,QAAQE,GAAKpC,QEjCvC4B,KFkCWS,WAAYwH,EAAEK,OAAOhI,QAAQE,GAAKpC,QEjC7CqC,WFkCWC,GAAIuH,EAAEK,OAAOhI,QAAQE,GAAKpC,QEjCrCsC,GFkCWC,UAAWsH,EAAEK,OAAOhI,QAAQE,GAAKpC,QEjC5CuC,UACAC,QACA,UADAqH,EAAAK,OAAAhI,QAAAE,GAAApC,QAAA4B,KACAiI,EAAAK,OAAAhI,QAAAE,GACAK,QAAAoH,EAAAK,OAAAhI,QAAAE,GAEAM,SF+BSiH,GAAOhJ,aAAawD,KE9B7BlB,OFkCK5B,KAAKZ,WAAasE,EEzBvBF,eF0BKxD,KAAKZ,WAAWmI,MAAM3I,GAAGoG,IExB9BlE,KF0BSd,KAAKrB,QAAQwB,iBAAiBH,KAAKI,iBAAiBJ,KAAKrB,QExBlEwB,iBF0BKH,KEvBL4E,iBFyBKhG,GAAGoG,IAAIlE,IAAIgI,eAAe,iBExB/B9C,iBF8BM+C,IACA,SAAUtN,EAAQC,EAASC,GG1jBjCD,EAAAD,EAAAC,QAAAC,EAAA,KAKAD,EAAAoH,MAAArH,EAAAwF,GAAA,w4BAA+5B,IAAQ+H,QAAA,EAAAC,SAAA,8BAAAC,SAAAC,SAAA,kiBAAAC,KAAA,WAAAC,gBAAA,8tCAAw2DC,WAAA,iBHmkBzwFC,IACA,SAAU9N,EAAQC,EAASC,GItkBjC,GAAA6N,GAAA7N,EAAA,IACA,iBAAA6N,SAAA/N,EAAAwF,GAAAuI,EAAA,KAEA7N,GAAA,GAAA6N,KACAA,GAAAC,SAAAhO,EAAAC,QAAA8N,EAAAC,SJ4lBMC,IACA,SAAUjO,EAAQC,EAASC,GKpmBjC,GAAAgO,GAAAC,CAIAjO,GAAA,KAGAgO,EAAAhO,EAAA,IAGA,IAAAkO,GAAAlO,EAAA,IACAiO,GAAAD,QAEA,gBAAAA,GAAA5N,SACA,kBAAA4N,GAAA5N,UAEA6N,EAAAD,IAAA5N,SAEA,kBAAA6N,KACAA,IAAAjL,SAGAiL,EAAAE,OAAAD,EAAAC,OACAF,EAAAG,gBAAAF,EAAAE,gBAEAtO,EAAAC,QAAAiO,GL2mBMK,IACA,SAAUvO,EAAQC,GMroBxBD,EAAAC,SAAgBoO,OAAA,WAAmB,GAAAG,GAAAjK,IAAaiK,GAAAC,cAChD,OAAAD,GAAAE,GAAA,OACAC,YAAA,gBACAC,OACApJ,GAAA,mBAEGgJ,EAAAE,GAAA,YACHG,aACA5L,KAAA,YACA6L,QAAA,gBAEAF,OACAtL,MAAAkL,EAAAlL,MACAyL,MAAA,gBACAC,SAAA,KAEGR,EAAAS,GAAA,KAAAT,EAAAU,GAAA,GAAAV,EAAAS,GAAA,KAAAT,EAAAE,GAAA,UACHC,YAAA,SACAC,OACA9J,KAAA,OACAqK,QAAA,UAEGX,EAAAE,GAAA,aACHC,YAAA,kBACAC,OACApJ,GAAA,iBACAlC,MAAA,sBACA8L,KAAA,QAEAtC,IACAuC,MAAAb,EAAAxK,UAEGwK,EAAAS,GAAA,iBAAAT,EAAAS,GAAA,KAAAT,EAAAE,GAAA,aACHG,aACA5L,KAAA,OACA6L,QAAA,SACArO,MAAA+N,EAAA,aACAc,WAAA,iBAEAX,YAAA,kBACAC,OACApJ,GAAA,iBACAlC,MAAA,4BACA8L,KAAA,QAEAtC,IACAuC,MAAAb,EAAAtK,UAEGsK,EAAAS,GAAA,aAAAT,EAAAS,GAAA,KAAAT,EAAAE,GAAA,aACHG,aACA5L,KAAA,OACA6L,QAAA,SACArO,MAAA+N,EAAA,cACAc,WAAA,kBAEAX,YAAA,kBACAC,OACApJ,GAAA,iBACAlC,MAAA,+BACA8L,KAAA,QAEAtC,IACAuC,MAAAb,EAAApK,WAEGoK,EAAAS,GAAA,uBACFX,iBAAA,WAA+B,GAAAE,GAAAjK,IAAaiK,GAAAC,cAC7C,OAAAD,GAAAE,GAAA,OACAC,YAAA,8CACAC,OACApJ,GAAA,wBAEGgJ,EAAAE,GAAA,OACHC,YAAA,kDACGH,EAAAE,GAAA,OACHE,OACApJ,GAAA","file":"static/js/20.js","sourcesContent":["webpackJsonp([20,30],{\n\n/***/ 99:\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\texports.default = function (data) {\n\t  return _axios2.default.post(_globals2.default.RL_TRANSFORM_POLY_SERVICE, {\n\t    headers: {\n\t      Accept: 'text/xml'\n\t    },\n\t    data: data\n\t  }).then(function (response) {\n\t    return response.data;\n\t  });\n\t};\n\t\n\tvar _axios = __webpack_require__(4);\n\t\n\tvar _axios2 = _interopRequireDefault(_axios);\n\t\n\tvar _globals = __webpack_require__(6);\n\t\n\tvar _globals2 = _interopRequireDefault(_globals);\n\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/***/ }),\n\n/***/ 232:\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _loading = __webpack_require__(33);\n\t\n\tvar _loading2 = _interopRequireDefault(_loading);\n\t\n\tvar _loading3 = __webpack_require__(30);\n\t\n\tvar _loading4 = _interopRequireDefault(_loading3);\n\t\n\tvar _keys = __webpack_require__(53);\n\t\n\tvar _keys2 = _interopRequireDefault(_keys);\n\t\n\tvar _notification = __webpack_require__(82);\n\t\n\tvar _notification2 = _interopRequireDefault(_notification);\n\t\n\tvar _notification3 = __webpack_require__(76);\n\t\n\tvar _notification4 = _interopRequireDefault(_notification3);\n\t\n\tvar _col = __webpack_require__(65);\n\t\n\tvar _col2 = _interopRequireDefault(_col);\n\t\n\tvar _col3 = __webpack_require__(64);\n\t\n\tvar _col4 = _interopRequireDefault(_col3);\n\t\n\tvar _row = __webpack_require__(42);\n\t\n\tvar _row2 = _interopRequireDefault(_row);\n\t\n\tvar _row3 = __webpack_require__(39);\n\t\n\tvar _row4 = _interopRequireDefault(_row3);\n\t\n\tvar _button = __webpack_require__(9);\n\t\n\tvar _button2 = _interopRequireDefault(_button);\n\t\n\tvar _base = __webpack_require__(5);\n\t\n\tvar _base2 = _interopRequireDefault(_base);\n\t\n\tvar _button3 = __webpack_require__(8);\n\t\n\tvar _button4 = _interopRequireDefault(_button3);\n\t\n\tvar _vue = __webpack_require__(1);\n\t\n\tvar _vue2 = _interopRequireDefault(_vue);\n\t\n\tvar _getCoordTransform = __webpack_require__(45);\n\t\n\tvar _getCoordTransform2 = _interopRequireDefault(_getCoordTransform);\n\t\n\tvar _getCoordTransformPoly = __webpack_require__(99);\n\t\n\tvar _getCoordTransformPoly2 = _interopRequireDefault(_getCoordTransformPoly);\n\t\n\tvar _getWFSFeature = __webpack_require__(35);\n\t\n\tvar _getWFSFeature2 = _interopRequireDefault(_getWFSFeature);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t_vue2.default.use(_button4.default);\n\t_vue2.default.use(_row4.default);\n\t_vue2.default.use(_col4.default);\n\t\n\texports.default = {\n\t  name: 'gv-draw-panel',\n\t  data: function data() {\n\t    var options = GV.config.getToolOptions('gv-draw-button');\n\t    return {\n\t      options: options,\n\t      title: 'Acquisizione Geometrie',\n\t      defaultColor: '#3388ff',\n\t      results: [],\n\t      requestCount: 0,\n\t      numRequests: 0,\n\t      drawnItems: null,\n\t      editing: false,\n\t      deletedItems: [],\n\t      submitButton: options.buttons && options.buttons.submit,\n\t      cancelButton: options.buttons && options.buttons.cancel,\n\t      refreshButton: options.buttons && options.buttons.refresh\n\t    };\n\t  },\n\t\n\t  computed: {},\n\t  methods: {\n\t    cancel: function cancel() {\n\t      if (this.options.cancel) this.options.cancel(this.results);\n\t    },\n\t    refresh: function refresh() {\n\t      var r = confirm(\"L'operazione cancella eventuali modifiche non salvate su DB.\\n\\nSei sicuro?\");\n\t      if (r == true) {\n\t        this.results = [];\n\t        this.deletedItems = [];\n\t        if (this.options.initWfsRequests) this.addLayerFeatures(this.options.initWfsRequests);\n\t      }\n\t      return;\n\t    },\n\t    submit: function submit() {\n\t      var r = confirm('Sei sicuro?');\n\t      if (r == true) {\n\t        this.submitOK();\n\t      }\n\t      return;\n\t    },\n\t    submitOK: function submitOK() {\n\t      var _this = this;\n\t\n\t      if (this.editing) {\n\t        (0, _notification4.default)({\n\t          title: 'Attenzione',\n\t          type: 'warning',\n\t          duration: 5000,\n\t          offset: 70,\n\t          dangerouslyUseHTMLString: true,\n\t          position: 'bottom-left',\n\t          message: 'Modifiche in corso, salva o annulla le modifiche prima di inviare i dati'\n\t        });\n\t        return;\n\t      }\n\t      this.requestCount = 0;\n\t      this.results = (0, _keys2.default)(this.drawnItems._layers).map(function (key) {\n\t        return {\n\t          type: _this.drawnItems._layers[key].options.type,\n\t          properties: _this.drawnItems._layers[key].options.properties,\n\t          id: _this.drawnItems._layers[key].options.id,\n\t          layerName: _this.drawnItems._layers[key].options.layerName,\n\t          latlngs: _this.drawnItems._layers[key].options.type === 'point' ? _this.drawnItems._layers[key]._latlng : _this.drawnItems._layers[key]._latlngs\n\t        };\n\t      });\n\t      this.numRequests = this.results.length;\n\t      if (this.results.length === 0 && this.deletedItems.length === 0) {\n\t        (0, _notification4.default)({\n\t          title: 'Attenzione',\n\t          type: 'warning',\n\t          duration: 5000,\n\t          offset: 70,\n\t          position: 'bottom-left',\n\t          message: \"Nessuna geometria da salvare, insersci le geometrie oppure premi il tasto 'Annulla'\"\n\t        });\n\t        return;\n\t      }\n\t\n\t      this.loading = _loading4.default.service({\n\t        text: 'Salvataggio...',\n\t        background: 'rgba(0, 0, 0, 0.8)'\n\t      });\n\t      if (this.results.length === 0) {\n\t        this.options.submit(this.results, this.deletedItems, this.loading);\n\t      } else {\n\t        this.results.forEach(function (item) {\n\t          _this.convertCoords(item);\n\t        });\n\t      }\n\t    },\n\t    submitRefresh: function submitRefresh() {\n\t      this.results = [];\n\t      this.deletedItems = [];\n\t      if (this.options.initWfsRequests) this.addLayerFeatures(this.options.initWfsRequests);\n\t    },\n\t    checkEndRequests: function checkEndRequests() {\n\t      if (this.requestCount === this.numRequests) {\n\t        this.options.submit(this.results, this.deletedItems, this.loading, this.submitRefresh);\n\t      }\n\t    },\n\t    convertCoords: function convertCoords(item) {\n\t      switch (item.type) {\n\t        case 'point':\n\t          this.convertCoordsPoint(item);\n\t          break;\n\t        case 'polyline':\n\t          this.convertCoordsLine(item);\n\t          break;\n\t        case 'polygon':\n\t          this.convertCoordsPolygon(item);\n\t          break;\n\t      }\n\t    },\n\t    convertCoordsPoint: function convertCoordsPoint(item) {\n\t      var _this2 = this;\n\t\n\t      if (this.options.epsg === '4326') {\n\t        this.requestCount++;\n\t        item.geom = [item.latlngs.lng.toFixed(6), item.latlngs.lat.toFixed(6)];\n\t        this.checkEndRequests();\n\t      } else {\n\t        (0, _getCoordTransform2.default)('4326', this.options.epsg, item.latlngs.lng, item.latlngs.lat).then(function (response) {\n\t          _this2.requestCount++;\n\t          if (response.data.points) {\n\t            item.geom = response.data.points[0].split(',');\n\t          }\n\t          _this2.checkEndRequests();\n\t        });\n\t      }\n\t    },\n\t    convertCoordsLine: function convertCoordsLine(item) {\n\t      var _this3 = this;\n\t\n\t      var resultLine = [];\n\t      item.latlngs.forEach(function (latlng) {\n\t        resultLine.push([latlng.lng, latlng.lat]);\n\t      });\n\t      if (this.options.epsg === '4326') {\n\t        this.requestCount++;\n\t        item.geom = resultLine;\n\t        this.checkEndRequests();\n\t      } else {\n\t        var data = {\n\t          srsIn: '4326',\n\t          srsOut: this.options.epsg,\n\t          poly: resultLine\n\t        };\n\t        (0, _getCoordTransformPoly2.default)(data).then(function (response) {\n\t          _this3.requestCount++;\n\t          item.geom = response.poly;\n\t          _this3.checkEndRequests();\n\t        });\n\t      }\n\t    },\n\t    convertCoordsPolygon: function convertCoordsPolygon(item) {\n\t      var _this4 = this;\n\t\n\t      var resultLine = [];\n\t      item.latlngs.forEach(function (poly) {\n\t        poly.forEach(function (latlng) {\n\t          resultLine.push([latlng.lng, latlng.lat]);\n\t        });\n\t      });\n\t      if (this.options.epsg === '4326') {\n\t        this.requestCount++;\n\t        item.geom = resultLine;\n\t        this.checkEndRequests();\n\t      } else {\n\t        var data = {\n\t          srsIn: '4326',\n\t          srsOut: this.options.epsg,\n\t          poly: resultLine\n\t        };\n\t        (0, _getCoordTransformPoly2.default)(data).then(function (response) {\n\t          _this4.requestCount++;\n\t          item.geom = response.poly;\n\t          _this4.checkEndRequests();\n\t        });\n\t      }\n\t    },\n\t    setEditOptions: function setEditOptions() {\n\t      var editOptions = null;\n\t      if (this.options.tools.edit) {\n\t        if (this.options.tools.edit.edit || this.options.tools.edit.remove) {\n\t          editOptions = {\n\t            featureGroup: this.drawnItems,\n\t            poly: {\n\t              allowIntersection: false\n\t            }\n\t          };\n\t          if (!this.options.tools.edit.remove) {\n\t            editOptions.remove = false;\n\t          }\n\t          if (!this.options.tools.edit.edit) {\n\t            editOptions.edit = false;\n\t          }\n\t          L.EditToolbar.Delete.include({\n\t            removeAllLayers: false\n\t          });\n\t        }\n\t      }\n\t      return editOptions;\n\t    },\n\t    setDrawOptions: function setDrawOptions() {\n\t      var drawOptions = null;\n\t      if (this.options.tools.draw) {\n\t        drawOptions = {\n\t          rectangle: false,\n\t          marker: false,\n\t          circle: false\n\t        };\n\t\n\t        if (this.options.tools.draw.point) {\n\t          drawOptions.circlemarker = {\n\t            type: 'point',\n\t            radius: 4,\n\t            color: this.options.color || this.defaultColor\n\t          };\n\t        } else {\n\t          drawOptions.circlemarker = false;\n\t        }\n\t        if (this.options.tools.draw.polyline) {\n\t          drawOptions.polyline = {\n\t            shapeOptions: {\n\t              type: 'polyline',\n\t              color: this.options.color || this.defaultColor\n\t            }\n\t          };\n\t        } else {\n\t          drawOptions.polyline = false;\n\t        }\n\t        if (this.options.tools.draw.polygon) {\n\t          drawOptions.polygon = {\n\t            shapeOptions: {\n\t              type: 'polygon',\n\t              color: this.options.color || this.defaultColor\n\t            },\n\t            allowIntersection: false\n\t          };\n\t        } else {\n\t          drawOptions.polygon = false;\n\t        }\n\t      }\n\t      return drawOptions;\n\t    },\n\t    addDrawControl: function addDrawControl() {\n\t      var editOptions = this.setEditOptions();\n\t      var drawOptions = this.setDrawOptions();\n\t\n\t      this.controlDraw = new L.Control.Draw({\n\t        draw: drawOptions,\n\t        edit: editOptions\n\t      });\n\t      GV.app.map.addControl(this.controlDraw);\n\t\n\t      this.addDrawToolbar();\n\t      this.addEditToolbar();\n\t    },\n\t    addDrawToolbar: function addDrawToolbar() {\n\t      if (this.options.tools.draw) {\n\t        var drawPanel = document.getElementById('gv-draw-panel-draw');\n\t        drawPanel.appendChild(this.controlDraw._toolbars['draw']._toolbarContainer);\n\t        drawPanel.appendChild(this.controlDraw._toolbars['draw']._actionsContainer);\n\t        if (this.options.tools.draw.point) {\n\t          document.getElementsByClassName('leaflet-draw-draw-circlemarker')[0].className = 'gv-draw-buttons ms ms-draw-point';\n\t        }\n\t        if (this.options.tools.draw.polyline) {\n\t          document.getElementsByClassName('leaflet-draw-draw-polyline')[0].className = 'gv-draw-buttons ms ms-draw-line';\n\t        }\n\t        if (this.options.tools.draw.polygon) {\n\t          document.getElementsByClassName('leaflet-draw-draw-polygon')[0].className = 'gv-draw-buttons ms ms-draw-polygon';\n\t        }\n\t      }\n\t    },\n\t    addEditToolbar: function addEditToolbar() {\n\t      if (this.options.tools.edit) {\n\t        var drawPanel = document.getElementById('gv-draw-panel-draw');\n\t        if (this.options.tools.edit.edit || this.options.tools.edit.remove) {\n\t          drawPanel.appendChild(this.controlDraw._toolbars['edit']._toolbarContainer);\n\t          drawPanel.appendChild(this.controlDraw._toolbars['edit']._actionsContainer);\n\t        }\n\t        if (this.options.tools.edit.edit) {\n\t          var el = document.getElementsByClassName('leaflet-draw-edit-edit')[0];\n\t          el.className = 'gv-draw-buttons fa fa-edit';\n\t        }\n\t        if (this.options.tools.edit.remove) {\n\t          var _el = document.getElementsByClassName('leaflet-draw-edit-remove')[0];\n\t          _el.className = 'gv-draw-buttons fa fa-trash';\n\t        }\n\t      }\n\t    },\n\t    addLayerFeatures: function addLayerFeatures(initWfsRequests) {\n\t      var _this5 = this;\n\t\n\t      this.drawnItems.clearLayers();\n\t      initWfsRequests.forEach(function (request) {\n\t        (0, _getWFSFeature2.default)(null, null, request.wfsURL).then(function (features) {\n\t          features.forEach(function (feature) {\n\t            _this5.createGeometry(feature, request.layerName);\n\t          });\n\t          var bounds = _this5.drawnItems.getBounds();\n\t          if (bounds._northEast && bounds._southWest) {\n\t            GV.app.map.fitBounds(_this5.drawnItems.getBounds(), {\n\t              maxZoom: 17\n\t            });\n\t          }\n\t        }).catch(function (error) {\n\t          console.error(error);\n\t        });\n\t      });\n\t    },\n\t    createGeometry: function createGeometry(feature, layerName) {\n\t      var geom = null;\n\t      switch (feature.geometry.type) {\n\t        case 'Point':\n\t          geom = L.circleMarker(L.latLng(feature.geometry.coordinates.reverse()), {\n\t            type: 'point',\n\t            color: this.options.color || this.defaultColor,\n\t            radius: 4,\n\t            weight: 4,\n\t            opacity: 0.5,\n\t            fillOpacity: 0.5,\n\t            id: feature.id,\n\t            layerName: layerName,\n\t            properties: feature.properties\n\t          });\n\t          if (geom) geom.addTo(this.drawnItems);\n\t          break;\n\t        case 'LineString':\n\t          var polyline = this.reverseCoordsLine(feature.geometry.coordinates);\n\t          geom = L.polyline(polyline, {\n\t            type: 'polyline',\n\t            color: this.options.color || this.defaultColor,\n\t            id: feature.id,\n\t            layerName: layerName,\n\t            properties: feature.properties\n\t          });\n\t          if (geom) geom.addTo(this.drawnItems);\n\t          break;\n\t        case 'MultiLineString':\n\t          console.warn('ATTENZIONE: geometria di tipo MultiLineString', feature);\n\t\n\t          break;\n\t        case 'Polygon':\n\t          var poly = this.reverseCoordsPoly(feature.geometry.coordinates);\n\t          geom = L.polygon(poly, {\n\t            type: 'polygon',\n\t            color: this.options.color || this.defaultColor,\n\t            id: feature.id,\n\t            layerName: layerName,\n\t            properties: feature.properties\n\t          });\n\t          if (geom) geom.addTo(this.drawnItems);\n\t          break;\n\t        case 'MultiPolygon':\n\t          console.warn('ATTENZIONE: geometria di tipo MultiPolygon', feature);\n\t\n\t          break;\n\t      }\n\t    },\n\t    reverseCoordsLine: function reverseCoordsLine(geom) {\n\t      var reversedGeom = [];\n\t      geom.forEach(function (el) {\n\t        var coords = el.reverse();\n\t\n\t        reversedGeom.push(coords);\n\t      });\n\t      return reversedGeom;\n\t    },\n\t    reverseCoordsPoly: function reverseCoordsPoly(geom) {\n\t      var reversedGeom = [];\n\t      geom.forEach(function (el) {\n\t        var coords = el.map(function (coord) {\n\t          return [coord[1], coord[0]];\n\t        });\n\t        reversedGeom.push(coords);\n\t      });\n\t      return reversedGeom;\n\t    },\n\t    hideLayer: function hideLayer() {\n\t      this.drawnItems.eachLayer(function (layer) {\n\t        layer.getElement().style.display = 'none';\n\t      });\n\t    },\n\t    showLayer: function showLayer() {\n\t      this.drawnItems.eachLayer(function (layer) {\n\t        layer.getElement().style.display = 'block';\n\t      });\n\t    }\n\t  },\n\t  mounted: function mounted() {\n\t    var _this6 = this;\n\t\n\t    GV.app.map.on('draw:created', function (e) {\n\t      e.layer.addTo(_this6.drawnItems);\n\t    });\n\t    GV.eventBus.$on('gv-control-draw-deactivate', function (ev) {\n\t      GV.app.map.off('draw:created');\n\t      _this6.hideLayer();\n\t    });\n\t    GV.eventBus.$on('gv-control-draw-activate', function (ev) {\n\t      GV.app.map.on('draw:created', function (e) {\n\t        e.layer.addTo(_this6.drawnItems);\n\t      });\n\t      _this6.showLayer();\n\t      _this6.submitRefresh();\n\t    });\n\t\n\t    GV.app.map.on('draw:editstart', function (e) {\n\t      _this6.editing = true;\n\t    });\n\t    GV.app.map.on('draw:editstop', function (e) {\n\t      _this6.editing = false;\n\t    });\n\t\n\t    GV.app.map.on('draw:deletestart', function (e) {\n\t      _this6.editing = true;\n\t    });\n\t    GV.app.map.on('draw:deletestop', function (e) {\n\t      _this6.editing = false;\n\t    });\n\t\n\t    GV.app.map.on('draw:drawstart', function (e) {\n\t      _this6.editing = true;\n\t    });\n\t    GV.app.map.on('draw:drawstop', function (e) {\n\t      _this6.editing = false;\n\t    });\n\t\n\t    GV.app.map.on('draw:deleted', function (e) {\n\t      (0, _keys2.default)(e.layers._layers).forEach(function (key) {\n\t        var item = {\n\t          type: e.layers._layers[key].options.type,\n\t          properties: e.layers._layers[key].options.properties,\n\t          id: e.layers._layers[key].options.id,\n\t          layerName: e.layers._layers[key].options.layerName,\n\t          latlngs: e.layers._layers[key].options.type === 'point' ? e.layers._layers[key]._latlng : e.layers._layers[key]._latlngs\n\t        };\n\t        _this6.deletedItems.push(item);\n\t      });\n\t    });\n\t\n\t    this.drawnItems = L.featureGroup();\n\t    this.drawnItems.addTo(GV.app.map);\n\t\n\t    if (this.options.initWfsRequests) this.addLayerFeatures(this.options.initWfsRequests);\n\t\n\t    this.addDrawControl();\n\t\n\t    GV.app.map.getLayerByName('InfoWmsHilite').clearLayers();\n\t  }\n\t};\n\n/***/ }),\n\n/***/ 448:\n/***/ (function(module, exports, __webpack_require__) {\n\n\texports = module.exports = __webpack_require__(2)();\n\t// imports\n\t\n\t\n\t// module\n\texports.push([module.id, \".gv-draw-panel{position:absolute;width:260px;left:0;top:0;margin-left:10px;margin-top:50px;z-index:800}.gv-draw-panel-body{padding:10px;overflow-y:auto;width:240px;height:80px}.gv-draw-panel-result{position:absolute;padding-left:3px;margin:0;width:230px}.gv-draw-buttons{width:20px;float:left;margin:4px}.gv-draw-buttons-reset{width:36px;padding-left:2px}.leaflet-bar{box-shadow:none}.leaflet-draw-actions{left:2px;top:54px!important}.leaflet-draw-actions a{padding:7px;margin:2px}.leaflet-draw-actions li:last-child a{border-radius:0 0 0 0}.leaflet-draw-actions li:first-child a{margin-left:4px}.leaflet-draw-toolbar a{background-image:none}.leaflet-draw-toolbar .leaflet-draw-draw-polyline{background-position:-2px -2px}.leaflet-bar a:first-child{border-top-left-radius:0;border-top-right-radius:0}.leaflet-bar a:last-child{border-bottom-left-radius:0;border-bottom-right-radius:0;margin-right:20px}\", \"\", {\"version\":3,\"sources\":[\"/./src/components/Draw.vue\"],\"names\":[],\"mappings\":\"AACA,eACE,kBAAmB,AACnB,YAAa,AACb,OAAU,AACV,MAAS,AACT,iBAAkB,AAClB,gBAAiB,AACjB,WAAa,CACd,AACD,oBACE,aAAc,AACd,gBAAiB,AACjB,YAAa,AACb,WAAa,CACd,AACD,sBACE,kBAAmB,AACnB,iBAAkB,AAClB,SAAY,AACZ,WAAa,CACd,AACD,iBACE,WAAY,AACZ,WAAY,AACZ,UAAY,CACb,AACD,uBACE,WAAY,AACZ,gBAAkB,CACnB,AACD,aACE,eAAiB,CAClB,AACD,sBACE,SAAU,AACV,kBAAqB,CACtB,AACD,wBACE,YAAa,AACb,UAAY,CACb,AACD,sCACE,qBAAuB,CACxB,AACD,uCACE,eAAiB,CAClB,AACD,wBACE,qBAAuB,CACxB,AACD,kDACE,6BAA+B,CAChC,AACD,2BACE,yBAA4B,AAC5B,yBAA6B,CAC9B,AACD,0BACE,4BAA+B,AAC/B,6BAAgC,AAChC,iBAAmB,CACpB\",\"file\":\"Draw.vue\",\"sourcesContent\":[\"\\n.gv-draw-panel {\\r\\n  position: absolute;\\r\\n  width: 260px;\\r\\n  left: 0px;\\r\\n  top: 0px;\\r\\n  margin-left: 10px;\\r\\n  margin-top: 50px;\\r\\n  z-index: 800;\\n}\\n.gv-draw-panel-body {\\r\\n  padding: 10px;\\r\\n  overflow-y: auto;\\r\\n  width: 240px;\\r\\n  height: 80px;\\n}\\n.gv-draw-panel-result {\\r\\n  position: absolute;\\r\\n  padding-left: 3px;\\r\\n  margin: 0px;\\r\\n  width: 230px;\\n}\\n.gv-draw-buttons {\\r\\n  width: 20px;\\r\\n  float: left;\\r\\n  margin: 4px;\\n}\\n.gv-draw-buttons-reset {\\r\\n  width: 36px;\\r\\n  padding-left: 2px;\\n}\\n.leaflet-bar {\\r\\n  box-shadow: none;\\n}\\n.leaflet-draw-actions {\\r\\n  left: 2px;\\r\\n  top: 54px !important;\\n}\\n.leaflet-draw-actions a {\\r\\n  padding: 7px;\\r\\n  margin: 2px;\\n}\\n.leaflet-draw-actions li:last-child a {\\r\\n  border-radius: 0 0 0 0;\\n}\\n.leaflet-draw-actions li:first-child a {\\r\\n  margin-left: 4px;\\n}\\n.leaflet-draw-toolbar a {\\r\\n  background-image: none;\\n}\\n.leaflet-draw-toolbar .leaflet-draw-draw-polyline {\\r\\n  background-position: -2px -2px;\\n}\\n.leaflet-bar a:first-child {\\r\\n  border-top-left-radius: 0px;\\r\\n  border-top-right-radius: 0px;\\n}\\n.leaflet-bar a:last-child {\\r\\n  border-bottom-left-radius: 0px;\\r\\n  border-bottom-right-radius: 0px;\\r\\n  margin-right: 20px;\\n}\\r\\n\"],\"sourceRoot\":\"webpack://\"}]);\n\t\n\t// exports\n\n\n/***/ }),\n\n/***/ 561:\n/***/ (function(module, exports, __webpack_require__) {\n\n\t// style-loader: Adds some css to the DOM by adding a <style> tag\n\t\n\t// load the styles\n\tvar content = __webpack_require__(448);\n\tif(typeof content === 'string') content = [[module.id, content, '']];\n\t// add the styles to the DOM\n\tvar update = __webpack_require__(3)(content, {});\n\tif(content.locals) module.exports = content.locals;\n\t// Hot Module Replacement\n\tif(false) {\n\t\t// When the styles change, update the <style> tags\n\t\tif(!content.locals) {\n\t\t\tmodule.hot.accept(\"!!./../../node_modules/css-loader/index.js?sourceMap!./../../node_modules/vue-loader/lib/style-rewriter.js?id=data-v-7d6181ab!./../../node_modules/vue-loader/lib/selector.js?type=styles&index=0!./Draw.vue\", function() {\n\t\t\t\tvar newContent = require(\"!!./../../node_modules/css-loader/index.js?sourceMap!./../../node_modules/vue-loader/lib/style-rewriter.js?id=data-v-7d6181ab!./../../node_modules/vue-loader/lib/selector.js?type=styles&index=0!./Draw.vue\");\n\t\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\t\tupdate(newContent);\n\t\t\t});\n\t\t}\n\t\t// When the module is disposed, remove the <style> tags\n\t\tmodule.hot.dispose(function() { update(); });\n\t}\n\n/***/ }),\n\n/***/ 631:\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __vue_exports__, __vue_options__\n\tvar __vue_styles__ = {}\n\t\n\t/* styles */\n\t__webpack_require__(561)\n\t\n\t/* script */\n\t__vue_exports__ = __webpack_require__(232)\n\t\n\t/* template */\n\tvar __vue_template__ = __webpack_require__(755)\n\t__vue_options__ = __vue_exports__ = __vue_exports__ || {}\n\tif (\n\t  typeof __vue_exports__.default === \"object\" ||\n\t  typeof __vue_exports__.default === \"function\"\n\t) {\n\t__vue_options__ = __vue_exports__ = __vue_exports__.default\n\t}\n\tif (typeof __vue_options__ === \"function\") {\n\t  __vue_options__ = __vue_options__.options\n\t}\n\t\n\t__vue_options__.render = __vue_template__.render\n\t__vue_options__.staticRenderFns = __vue_template__.staticRenderFns\n\t\n\tmodule.exports = __vue_exports__\n\n\n/***/ }),\n\n/***/ 755:\n/***/ (function(module, exports) {\n\n\tmodule.exports={render:function (){var _vm=this;var _h=_vm.$createElement;\n\t  return _vm._c('div', {\n\t    staticClass: \"gv-draw-panel\",\n\t    attrs: {\n\t      \"id\": \"gv-draw-panel\"\n\t    }\n\t  }, [_vm._c('gv-title', {\n\t    directives: [{\n\t      name: \"draggable\",\n\t      rawName: \"v-draggable\"\n\t    }],\n\t    attrs: {\n\t      \"title\": _vm.title,\n\t      \"divId\": 'gv-draw-panel',\n\t      \"noClose\": true\n\t    }\n\t  }), _vm._v(\" \"), _vm._m(0), _vm._v(\" \"), _vm._c('el-row', {\n\t    staticClass: \"row-bg\",\n\t    attrs: {\n\t      \"type\": \"flex\",\n\t      \"justify\": \"left\"\n\t    }\n\t  }, [_vm._c('el-button', {\n\t    staticClass: \"gv-color-scheme\",\n\t    attrs: {\n\t      \"id\": \"gv-draw-submit\",\n\t      \"title\": \"Salva i dati sul DB\",\n\t      \"size\": \"mini\"\n\t    },\n\t    on: {\n\t      \"click\": _vm.submit\n\t    }\n\t  }, [_vm._v(\"Salva su DB\")]), _vm._v(\" \"), _vm._c('el-button', {\n\t    directives: [{\n\t      name: \"show\",\n\t      rawName: \"v-show\",\n\t      value: (_vm.cancelButton),\n\t      expression: \"cancelButton\"\n\t    }],\n\t    staticClass: \"gv-color-scheme\",\n\t    attrs: {\n\t      \"id\": \"gv-draw-cancel\",\n\t      \"title\": \"Ritorno alla applicazione\",\n\t      \"size\": \"mini\"\n\t    },\n\t    on: {\n\t      \"click\": _vm.cancel\n\t    }\n\t  }, [_vm._v(\"Annulla\")]), _vm._v(\" \"), _vm._c('el-button', {\n\t    directives: [{\n\t      name: \"show\",\n\t      rawName: \"v-show\",\n\t      value: (_vm.refreshButton),\n\t      expression: \"refreshButton\"\n\t    }],\n\t    staticClass: \"gv-color-scheme\",\n\t    attrs: {\n\t      \"id\": \"gv-draw-cancel\",\n\t      \"title\": \"Ricarica dati salvati sul DB\",\n\t      \"size\": \"mini\"\n\t    },\n\t    on: {\n\t      \"click\": _vm.refresh\n\t    }\n\t  }, [_vm._v(\"Ricarica\")])], 1)], 1)\n\t},staticRenderFns: [function (){var _vm=this;var _h=_vm.$createElement;\n\t  return _vm._c('div', {\n\t    staticClass: \"gv-draw-panel-body gv-inverted-color-scheme\",\n\t    attrs: {\n\t      \"id\": \"gv-draw-panel-body\"\n\t    }\n\t  }, [_vm._c('div', {\n\t    staticClass: \"gv-draw-panel-result gv-inverted-color-scheme\"\n\t  }, [_vm._c('div', {\n\t    attrs: {\n\t      \"id\": \"gv-draw-panel-draw\"\n\t    }\n\t  })])])\n\t}]}\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// static/js/20.js","import axios from 'axios'\r\nimport globals from '../globals'\r\n\r\nexport default function (data) {\r\n  return axios\r\n    .post(globals.RL_TRANSFORM_POLY_SERVICE, {\r\n      headers: {\r\n        Accept: 'text/xml'\r\n      },\r\n      data: data,\r\n    })\r\n    .then(response => response.data)\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./E:/node-prj/geoviewer2/src/services/getCoordTransformPoly.js","<template>\r\n  <div id=\"gv-draw-panel\" class=\"gv-draw-panel\">\r\n    <gv-title :title=\"title\" :divId=\"'gv-draw-panel'\" v-draggable :noClose=\"true\"></gv-title>\r\n    <div id=\"gv-draw-panel-body\" class=\"gv-draw-panel-body gv-inverted-color-scheme\">\r\n      <div class=\"gv-draw-panel-result gv-inverted-color-scheme\">\r\n        <div id=\"gv-draw-panel-draw\"></div>\r\n      </div>\r\n    </div>\r\n    <el-row type=\"flex\" class=\"row-bg\" justify=\"left\">\r\n      <el-button\r\n        id=\"gv-draw-submit\"\r\n        title=\"Salva i dati sul DB\"\r\n        @click=\"submit\"\r\n        class=\"gv-color-scheme\"\r\n        size=\"mini\"\r\n        >Salva su DB</el-button\r\n      >\r\n      <el-button\r\n        id=\"gv-draw-cancel\"\r\n        v-show=\"cancelButton\"\r\n        title=\"Ritorno alla applicazione\"\r\n        @click=\"cancel\"\r\n        class=\"gv-color-scheme\"\r\n        size=\"mini\"\r\n        >Annulla</el-button\r\n      >\r\n      <el-button\r\n        id=\"gv-draw-cancel\"\r\n        v-show=\"refreshButton\"\r\n        title=\"Ricarica dati salvati sul DB\"\r\n        @click=\"refresh\"\r\n        class=\"gv-color-scheme\"\r\n        size=\"mini\"\r\n        >Ricarica</el-button\r\n      >\r\n    </el-row>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Vue from 'vue';\r\nimport getCoordTransform from '../services/getCoordTransform';\r\nimport getCoordTransformPoly from '../services/getCoordTransformPoly';\r\nimport getWFSFeature from '../services/getWFSFeature';\r\n\r\nimport { Button, Row, Col, Loading, Notification } from 'element-ui';\r\nVue.use(Button);\r\nVue.use(Row);\r\nVue.use(Col);\r\n\r\nexport default {\r\n  name: 'gv-draw-panel',\r\n  data() {\r\n    const options = GV.config.getToolOptions('gv-draw-button');\r\n    return {\r\n      options: options,\r\n      title: 'Acquisizione Geometrie',\r\n      defaultColor: '#3388ff',\r\n      results: [],\r\n      requestCount: 0,\r\n      numRequests: 0,\r\n      drawnItems: null,\r\n      editing: false,\r\n      deletedItems: [],\r\n      submitButton: options.buttons && options.buttons.submit,\r\n      cancelButton: options.buttons && options.buttons.cancel,\r\n      refreshButton: options.buttons && options.buttons.refresh,\r\n    };\r\n  },\r\n  computed: {},\r\n  methods: {\r\n    cancel() {\r\n      if (this.options.cancel) this.options.cancel(this.results);\r\n    },\r\n    refresh() {\r\n      var r = confirm(\r\n        \"L'operazione cancella eventuali modifiche non salvate su DB.\\n\\nSei sicuro?\"\r\n      );\r\n      if (r == true) {\r\n        this.results = [];\r\n        this.deletedItems = [];\r\n        if (this.options.initWfsRequests) this.addLayerFeatures(this.options.initWfsRequests);\r\n      }\r\n      return;\r\n    },\r\n    submit() {\r\n      var r = confirm('Sei sicuro?');\r\n      if (r == true) {\r\n        this.submitOK();\r\n      }\r\n      return;\r\n    },\r\n    submitOK() {\r\n      if (this.editing) {\r\n        Notification({\r\n          title: 'Attenzione',\r\n          type: 'warning',\r\n          duration: 5000,\r\n          offset: 70,\r\n          dangerouslyUseHTMLString: true,\r\n          position: 'bottom-left',\r\n          message: 'Modifiche in corso, salva o annulla le modifiche prima di inviare i dati',\r\n        });\r\n        return;\r\n      }\r\n      this.requestCount = 0;\r\n      this.results = Object.keys(this.drawnItems._layers).map(key => {\r\n        return {\r\n          type: this.drawnItems._layers[key].options.type,\r\n          properties: this.drawnItems._layers[key].options.properties,\r\n          id: this.drawnItems._layers[key].options.id,\r\n          layerName: this.drawnItems._layers[key].options.layerName,\r\n          latlngs:\r\n            this.drawnItems._layers[key].options.type === 'point'\r\n              ? this.drawnItems._layers[key]._latlng\r\n              : this.drawnItems._layers[key]._latlngs,\r\n        };\r\n      });\r\n      this.numRequests = this.results.length;\r\n      if (this.results.length === 0 && this.deletedItems.length === 0) {\r\n        Notification({\r\n          title: 'Attenzione',\r\n          type: 'warning',\r\n          duration: 5000,\r\n          offset: 70,\r\n          position: 'bottom-left',\r\n          message:\r\n            \"Nessuna geometria da salvare, insersci le geometrie oppure premi il tasto 'Annulla'\",\r\n        });\r\n        return;\r\n      }\r\n\r\n      // console.log('results', this.results[0]);\r\n      // console.log('deleted', this.deletedItems);\r\n      // return;\r\n\r\n      this.loading = Loading.service({\r\n        text: 'Salvataggio...',\r\n        background: 'rgba(0, 0, 0, 0.8)',\r\n      });\r\n      if (this.results.length === 0) {\r\n        this.options.submit(this.results, this.deletedItems, this.loading);\r\n      } else {\r\n        this.results.forEach(item => {\r\n          this.convertCoords(item);\r\n        });\r\n      }\r\n    },\r\n    submitRefresh() {\r\n      this.results = [];\r\n      this.deletedItems = [];\r\n      if (this.options.initWfsRequests) this.addLayerFeatures(this.options.initWfsRequests);\r\n    },\r\n    checkEndRequests() {\r\n      // Se sono finite le conversioni faccio submit\r\n      if (this.requestCount === this.numRequests) {\r\n        this.options.submit(this.results, this.deletedItems, this.loading, this.submitRefresh);\r\n      }\r\n    },\r\n    convertCoords(item) {\r\n      switch (item.type) {\r\n        case 'point':\r\n          this.convertCoordsPoint(item);\r\n          break;\r\n        case 'polyline':\r\n          this.convertCoordsLine(item);\r\n          break;\r\n        case 'polygon':\r\n          this.convertCoordsPolygon(item);\r\n          break;\r\n      }\r\n    },\r\n    convertCoordsPoint(item) {\r\n      if (this.options.epsg === '4326') {\r\n        this.requestCount++;\r\n        item.geom = [item.latlngs.lng.toFixed(6), item.latlngs.lat.toFixed(6)];\r\n        this.checkEndRequests();\r\n      } else {\r\n        getCoordTransform('4326', this.options.epsg, item.latlngs.lng, item.latlngs.lat).then(\r\n          response => {\r\n            this.requestCount++;\r\n            if (response.data.points) {\r\n              item.geom = response.data.points[0].split(',');\r\n            }\r\n            this.checkEndRequests();\r\n          }\r\n        );\r\n      }\r\n    },\r\n    convertCoordsLine(item) {\r\n      // console.log(item);\r\n      let resultLine = [];\r\n      item.latlngs.forEach(latlng => {\r\n        resultLine.push([latlng.lng, latlng.lat]);\r\n      });\r\n      if (this.options.epsg === '4326') {\r\n        this.requestCount++;\r\n        item.geom = resultLine;\r\n        this.checkEndRequests();\r\n      } else {\r\n        const data = {\r\n          srsIn: '4326',\r\n          srsOut: this.options.epsg,\r\n          poly: resultLine,\r\n        };\r\n        getCoordTransformPoly(data).then(response => {\r\n          this.requestCount++;\r\n          item.geom = response.poly;\r\n          this.checkEndRequests();\r\n        });\r\n      }\r\n    },\r\n    convertCoordsPolygon(item) {\r\n      let resultLine = [];\r\n      item.latlngs.forEach(poly => {\r\n        // console.log(poly);\r\n        // if (!Array.isArray(poly)) return;\r\n        poly.forEach(latlng => {\r\n          resultLine.push([latlng.lng, latlng.lat]);\r\n        });\r\n      });\r\n      if (this.options.epsg === '4326') {\r\n        this.requestCount++;\r\n        item.geom = resultLine;\r\n        this.checkEndRequests();\r\n      } else {\r\n        const data = {\r\n          srsIn: '4326',\r\n          srsOut: this.options.epsg,\r\n          poly: resultLine,\r\n        };\r\n        getCoordTransformPoly(data).then(response => {\r\n          this.requestCount++;\r\n          item.geom = response.poly;\r\n          this.checkEndRequests();\r\n        });\r\n      }\r\n    },\r\n    setEditOptions() {\r\n      let editOptions = null;\r\n      if (this.options.tools.edit) {\r\n        if (this.options.tools.edit.edit || this.options.tools.edit.remove) {\r\n          editOptions = {\r\n            featureGroup: this.drawnItems,\r\n            poly: {\r\n              allowIntersection: false,\r\n            },\r\n          };\r\n          if (!this.options.tools.edit.remove) {\r\n            editOptions.remove = false;\r\n          }\r\n          if (!this.options.tools.edit.edit) {\r\n            editOptions.edit = false;\r\n          }\r\n          L.EditToolbar.Delete.include({\r\n            removeAllLayers: false,\r\n          });\r\n        }\r\n      }\r\n      return editOptions;\r\n    },\r\n    setDrawOptions() {\r\n      let drawOptions = null;\r\n      if (this.options.tools.draw) {\r\n        drawOptions = {\r\n          rectangle: false,\r\n          marker: false,\r\n          circle: false,\r\n        };\r\n\r\n        if (this.options.tools.draw.point) {\r\n          drawOptions.circlemarker = {\r\n            type: 'point',\r\n            radius: 4,\r\n            color: this.options.color || this.defaultColor,\r\n          };\r\n        } else {\r\n          drawOptions.circlemarker = false;\r\n        }\r\n        if (this.options.tools.draw.polyline) {\r\n          drawOptions.polyline = {\r\n            shapeOptions: {\r\n              type: 'polyline',\r\n              color: this.options.color || this.defaultColor,\r\n            },\r\n          };\r\n        } else {\r\n          drawOptions.polyline = false;\r\n        }\r\n        if (this.options.tools.draw.polygon) {\r\n          drawOptions.polygon = {\r\n            shapeOptions: {\r\n              type: 'polygon',\r\n              color: this.options.color || this.defaultColor,\r\n            },\r\n            allowIntersection: false,\r\n          };\r\n        } else {\r\n          drawOptions.polygon = false;\r\n        }\r\n      }\r\n      return drawOptions;\r\n    },\r\n    addDrawControl() {\r\n      let editOptions = this.setEditOptions();\r\n      let drawOptions = this.setDrawOptions();\r\n\r\n      this.controlDraw = new L.Control.Draw({\r\n        draw: drawOptions,\r\n        edit: editOptions,\r\n      });\r\n      GV.app.map.addControl(this.controlDraw);\r\n\r\n      this.addDrawToolbar();\r\n      this.addEditToolbar();\r\n    },\r\n    addDrawToolbar() {\r\n      if (this.options.tools.draw) {\r\n        var drawPanel = document.getElementById('gv-draw-panel-draw');\r\n        drawPanel.appendChild(this.controlDraw._toolbars['draw']._toolbarContainer);\r\n        drawPanel.appendChild(this.controlDraw._toolbars['draw']._actionsContainer);\r\n        if (this.options.tools.draw.point) {\r\n          document.getElementsByClassName('leaflet-draw-draw-circlemarker')[0].className =\r\n            'gv-draw-buttons ms ms-draw-point';\r\n        }\r\n        if (this.options.tools.draw.polyline) {\r\n          document.getElementsByClassName('leaflet-draw-draw-polyline')[0].className =\r\n            'gv-draw-buttons ms ms-draw-line';\r\n        }\r\n        if (this.options.tools.draw.polygon) {\r\n          document.getElementsByClassName('leaflet-draw-draw-polygon')[0].className =\r\n            'gv-draw-buttons ms ms-draw-polygon';\r\n        }\r\n      }\r\n    },\r\n    addEditToolbar() {\r\n      if (this.options.tools.edit) {\r\n        var drawPanel = document.getElementById('gv-draw-panel-draw');\r\n        if (this.options.tools.edit.edit || this.options.tools.edit.remove) {\r\n          drawPanel.appendChild(this.controlDraw._toolbars['edit']._toolbarContainer);\r\n          drawPanel.appendChild(this.controlDraw._toolbars['edit']._actionsContainer);\r\n        }\r\n        if (this.options.tools.edit.edit) {\r\n          const el = document.getElementsByClassName('leaflet-draw-edit-edit')[0];\r\n          el.className = 'gv-draw-buttons fa fa-edit';\r\n        }\r\n        if (this.options.tools.edit.remove) {\r\n          const el = document.getElementsByClassName('leaflet-draw-edit-remove')[0];\r\n          el.className = 'gv-draw-buttons fa fa-trash';\r\n        }\r\n      }\r\n    },\r\n    addLayerFeatures(initWfsRequests) {\r\n      // console.log('initWfsRequests', initWfsRequests);\r\n      this.drawnItems.clearLayers();\r\n      initWfsRequests.forEach(request => {\r\n        getWFSFeature(null, null, request.wfsURL)\r\n          .then(features => {\r\n            features.forEach(feature => {\r\n              this.createGeometry(feature, request.layerName);\r\n            });\r\n            const bounds = this.drawnItems.getBounds();\r\n            if (bounds._northEast && bounds._southWest) {\r\n              GV.app.map.fitBounds(this.drawnItems.getBounds(), {\r\n                maxZoom: 17,\r\n              });\r\n            }\r\n          })\r\n          .catch(error => {\r\n            console.error(error);\r\n          });\r\n      });\r\n    },\r\n    createGeometry(feature, layerName) {\r\n      // Creo geometrie a partire da GeoJSON\r\n      let geom = null;\r\n      switch (feature.geometry.type) {\r\n        case 'Point':\r\n          geom = L.circleMarker(L.latLng(feature.geometry.coordinates.reverse()), {\r\n            type: 'point',\r\n            color: this.options.color || this.defaultColor,\r\n            radius: 4,\r\n            weight: 4,\r\n            opacity: 0.5,\r\n            fillOpacity: 0.5,\r\n            id: feature.id,\r\n            layerName: layerName,\r\n            properties: feature.properties,\r\n          });\r\n          if (geom) geom.addTo(this.drawnItems);\r\n          break;\r\n        case 'LineString':\r\n          const polyline = this.reverseCoordsLine(feature.geometry.coordinates);\r\n          geom = L.polyline(polyline, {\r\n            type: 'polyline',\r\n            color: this.options.color || this.defaultColor,\r\n            id: feature.id,\r\n            layerName: layerName,\r\n            properties: feature.properties,\r\n          });\r\n          if (geom) geom.addTo(this.drawnItems);\r\n          break;\r\n        case 'MultiLineString':\r\n          console.warn('ATTENZIONE: geometria di tipo MultiLineString', feature);\r\n          // feature.geometry.coordinates.forEach(el => {\r\n          //   geom = L.polygon(this.reverseCoordsLine(el), {\r\n          //     type: \"polyline\",\r\n          //     color: this.options.color || this.defaultColor,\r\n          //     id: feature.id,\r\n          //     layerName: layerName,\r\n          //     properties: feature.properties\r\n          //   });\r\n          //   if (geom) geom.addTo(this.drawnItems);\r\n          // });\r\n          break;\r\n        case 'Polygon':\r\n          const poly = this.reverseCoordsPoly(feature.geometry.coordinates);\r\n          geom = L.polygon(poly, {\r\n            type: 'polygon',\r\n            color: this.options.color || this.defaultColor,\r\n            id: feature.id,\r\n            layerName: layerName,\r\n            properties: feature.properties,\r\n          });\r\n          if (geom) geom.addTo(this.drawnItems);\r\n          break;\r\n        case 'MultiPolygon':\r\n          console.warn('ATTENZIONE: geometria di tipo MultiPolygon', feature);\r\n          // feature.geometry.coordinates.forEach(el => {\r\n          //   geom = L.polygon(this.reverseCoordsPoly(el), {\r\n          //     type: \"polygon\",\r\n          //     color: this.options.color || this.defaultColor,\r\n          //     id: feature.id,\r\n          //     layerName: layerName,\r\n          //     properties: feature.properties\r\n          //   });\r\n          //   if (geom) geom.addTo(this.drawnItems);\r\n          // });\r\n          break;\r\n      }\r\n    },\r\n    reverseCoordsLine(geom) {\r\n      // console.log(geom);\r\n      let reversedGeom = [];\r\n      geom.forEach(el => {\r\n        const coords = el.reverse();\r\n        // console.log(coords);\r\n        reversedGeom.push(coords);\r\n      });\r\n      return reversedGeom;\r\n    },\r\n    reverseCoordsPoly(geom) {\r\n      let reversedGeom = [];\r\n      geom.forEach(el => {\r\n        const coords = el.map(coord => {\r\n          return [coord[1], coord[0]];\r\n        });\r\n        reversedGeom.push(coords);\r\n      });\r\n      return reversedGeom;\r\n    },\r\n    hideLayer() {\r\n      this.drawnItems.eachLayer(layer => {\r\n        layer.getElement().style.display = 'none';\r\n      });\r\n    },\r\n    showLayer() {\r\n      this.drawnItems.eachLayer(layer => {\r\n        layer.getElement().style.display = 'block';\r\n      });\r\n    },\r\n  },\r\n  mounted: function() {\r\n    GV.app.map.on('draw:created', e => {\r\n      e.layer.addTo(this.drawnItems);\r\n    });\r\n    GV.eventBus.$on('gv-control-draw-deactivate', ev => {\r\n      GV.app.map.off('draw:created');\r\n      this.hideLayer();\r\n    });\r\n    GV.eventBus.$on('gv-control-draw-activate', ev => {\r\n      GV.app.map.on('draw:created', e => {\r\n        e.layer.addTo(this.drawnItems);\r\n      });\r\n      this.showLayer();\r\n      this.submitRefresh();\r\n    });\r\n\r\n    GV.app.map.on('draw:editstart', e => {\r\n      this.editing = true;\r\n    });\r\n    GV.app.map.on('draw:editstop', e => {\r\n      this.editing = false;\r\n    });\r\n\r\n    GV.app.map.on('draw:deletestart', e => {\r\n      this.editing = true;\r\n    });\r\n    GV.app.map.on('draw:deletestop', e => {\r\n      this.editing = false;\r\n    });\r\n\r\n    GV.app.map.on('draw:drawstart', e => {\r\n      this.editing = true;\r\n    });\r\n    GV.app.map.on('draw:drawstop', e => {\r\n      this.editing = false;\r\n    });\r\n\r\n    GV.app.map.on('draw:deleted', e => {\r\n      Object.keys(e.layers._layers).forEach(key => {\r\n        const item = {\r\n          type: e.layers._layers[key].options.type,\r\n          properties: e.layers._layers[key].options.properties,\r\n          id: e.layers._layers[key].options.id,\r\n          layerName: e.layers._layers[key].options.layerName,\r\n          latlngs:\r\n            e.layers._layers[key].options.type === 'point'\r\n              ? e.layers._layers[key]._latlng\r\n              : e.layers._layers[key]._latlngs,\r\n        };\r\n        this.deletedItems.push(item);\r\n      });\r\n    });\r\n\r\n    // GV.eventBus.$on('draw-saved-data', ev => {\r\n    //   // effettuo refresh\r\n    //   if (this.options.initWfsRequests) this.addLayerFeatures(this.options.initWfsRequests);\r\n    // });\r\n\r\n    this.drawnItems = L.featureGroup();\r\n    this.drawnItems.addTo(GV.app.map);\r\n\r\n    if (this.options.initWfsRequests) this.addLayerFeatures(this.options.initWfsRequests);\r\n\r\n    this.addDrawControl();\r\n\r\n    // rispulisco eventuali hilite\r\n    GV.app.map.getLayerByName('InfoWmsHilite').clearLayers();\r\n  },\r\n};\r\n</script>\r\n\r\n<style>\r\n.gv-draw-panel {\r\n  position: absolute;\r\n  width: 260px;\r\n  left: 0px;\r\n  top: 0px;\r\n  margin-left: 10px;\r\n  margin-top: 50px;\r\n  z-index: 800;\r\n}\r\n\r\n.gv-draw-panel-body {\r\n  padding: 10px;\r\n  overflow-y: auto;\r\n  width: 240px;\r\n  height: 80px;\r\n}\r\n\r\n.gv-draw-panel-result {\r\n  position: absolute;\r\n  padding-left: 3px;\r\n  margin: 0px;\r\n  width: 230px;\r\n}\r\n\r\n.gv-draw-buttons {\r\n  width: 20px;\r\n  float: left;\r\n  margin: 4px;\r\n}\r\n\r\n.gv-draw-buttons-reset {\r\n  width: 36px;\r\n  padding-left: 2px;\r\n}\r\n\r\n.leaflet-bar {\r\n  box-shadow: none;\r\n}\r\n.leaflet-draw-actions {\r\n  left: 2px;\r\n  top: 54px !important;\r\n}\r\n.leaflet-draw-actions a {\r\n  padding: 7px;\r\n  margin: 2px;\r\n}\r\n.leaflet-draw-actions li:last-child a {\r\n  -webkit-border-radius: 0 0 0 0;\r\n  border-radius: 0 0 0 0;\r\n}\r\n\r\n.leaflet-draw-actions li:first-child a {\r\n  margin-left: 4px;\r\n}\r\n.leaflet-draw-toolbar a {\r\n  background-image: none;\r\n}\r\n.leaflet-draw-toolbar .leaflet-draw-draw-polyline {\r\n  background-position: -2px -2px;\r\n}\r\n\r\n.leaflet-bar a:first-child {\r\n  border-top-left-radius: 0px;\r\n  border-top-right-radius: 0px;\r\n}\r\n.leaflet-bar a:last-child {\r\n  border-bottom-left-radius: 0px;\r\n  border-bottom-right-radius: 0px;\r\n  margin-right: 20px;\r\n}\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// Draw.vue?4e4291db","exports = module.exports = require(\"./../../node_modules/css-loader/lib/css-base.js\")();\n// imports\n\n\n// module\nexports.push([module.id, \".gv-draw-panel{position:absolute;width:260px;left:0;top:0;margin-left:10px;margin-top:50px;z-index:800}.gv-draw-panel-body{padding:10px;overflow-y:auto;width:240px;height:80px}.gv-draw-panel-result{position:absolute;padding-left:3px;margin:0;width:230px}.gv-draw-buttons{width:20px;float:left;margin:4px}.gv-draw-buttons-reset{width:36px;padding-left:2px}.leaflet-bar{box-shadow:none}.leaflet-draw-actions{left:2px;top:54px!important}.leaflet-draw-actions a{padding:7px;margin:2px}.leaflet-draw-actions li:last-child a{border-radius:0 0 0 0}.leaflet-draw-actions li:first-child a{margin-left:4px}.leaflet-draw-toolbar a{background-image:none}.leaflet-draw-toolbar .leaflet-draw-draw-polyline{background-position:-2px -2px}.leaflet-bar a:first-child{border-top-left-radius:0;border-top-right-radius:0}.leaflet-bar a:last-child{border-bottom-left-radius:0;border-bottom-right-radius:0;margin-right:20px}\", \"\", {\"version\":3,\"sources\":[\"/./src/components/Draw.vue\"],\"names\":[],\"mappings\":\"AACA,eACE,kBAAmB,AACnB,YAAa,AACb,OAAU,AACV,MAAS,AACT,iBAAkB,AAClB,gBAAiB,AACjB,WAAa,CACd,AACD,oBACE,aAAc,AACd,gBAAiB,AACjB,YAAa,AACb,WAAa,CACd,AACD,sBACE,kBAAmB,AACnB,iBAAkB,AAClB,SAAY,AACZ,WAAa,CACd,AACD,iBACE,WAAY,AACZ,WAAY,AACZ,UAAY,CACb,AACD,uBACE,WAAY,AACZ,gBAAkB,CACnB,AACD,aACE,eAAiB,CAClB,AACD,sBACE,SAAU,AACV,kBAAqB,CACtB,AACD,wBACE,YAAa,AACb,UAAY,CACb,AACD,sCACE,qBAAuB,CACxB,AACD,uCACE,eAAiB,CAClB,AACD,wBACE,qBAAuB,CACxB,AACD,kDACE,6BAA+B,CAChC,AACD,2BACE,yBAA4B,AAC5B,yBAA6B,CAC9B,AACD,0BACE,4BAA+B,AAC/B,6BAAgC,AAChC,iBAAmB,CACpB\",\"file\":\"Draw.vue\",\"sourcesContent\":[\"\\n.gv-draw-panel {\\r\\n  position: absolute;\\r\\n  width: 260px;\\r\\n  left: 0px;\\r\\n  top: 0px;\\r\\n  margin-left: 10px;\\r\\n  margin-top: 50px;\\r\\n  z-index: 800;\\n}\\n.gv-draw-panel-body {\\r\\n  padding: 10px;\\r\\n  overflow-y: auto;\\r\\n  width: 240px;\\r\\n  height: 80px;\\n}\\n.gv-draw-panel-result {\\r\\n  position: absolute;\\r\\n  padding-left: 3px;\\r\\n  margin: 0px;\\r\\n  width: 230px;\\n}\\n.gv-draw-buttons {\\r\\n  width: 20px;\\r\\n  float: left;\\r\\n  margin: 4px;\\n}\\n.gv-draw-buttons-reset {\\r\\n  width: 36px;\\r\\n  padding-left: 2px;\\n}\\n.leaflet-bar {\\r\\n  box-shadow: none;\\n}\\n.leaflet-draw-actions {\\r\\n  left: 2px;\\r\\n  top: 54px !important;\\n}\\n.leaflet-draw-actions a {\\r\\n  padding: 7px;\\r\\n  margin: 2px;\\n}\\n.leaflet-draw-actions li:last-child a {\\r\\n  border-radius: 0 0 0 0;\\n}\\n.leaflet-draw-actions li:first-child a {\\r\\n  margin-left: 4px;\\n}\\n.leaflet-draw-toolbar a {\\r\\n  background-image: none;\\n}\\n.leaflet-draw-toolbar .leaflet-draw-draw-polyline {\\r\\n  background-position: -2px -2px;\\n}\\n.leaflet-bar a:first-child {\\r\\n  border-top-left-radius: 0px;\\r\\n  border-top-right-radius: 0px;\\n}\\n.leaflet-bar a:last-child {\\r\\n  border-bottom-left-radius: 0px;\\r\\n  border-bottom-right-radius: 0px;\\r\\n  margin-right: 20px;\\n}\\r\\n\"],\"sourceRoot\":\"webpack://\"}]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/css-loader?sourceMap!./~/vue-loader/lib/style-rewriter.js?id=data-v-7d6181ab!./~/vue-loader/lib/selector.js?type=styles&index=0!./src/components/Draw.vue\n// module id = 448\n// module chunks = 20","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!./../../node_modules/css-loader/index.js?sourceMap!./../../node_modules/vue-loader/lib/style-rewriter.js?id=data-v-7d6181ab!./../../node_modules/vue-loader/lib/selector.js?type=styles&index=0!./Draw.vue\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// add the styles to the DOM\nvar update = require(\"!./../../node_modules/vue-style-loader/addStyles.js\")(content, {});\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!./../../node_modules/css-loader/index.js?sourceMap!./../../node_modules/vue-loader/lib/style-rewriter.js?id=data-v-7d6181ab!./../../node_modules/vue-loader/lib/selector.js?type=styles&index=0!./Draw.vue\", function() {\n\t\t\tvar newContent = require(\"!!./../../node_modules/css-loader/index.js?sourceMap!./../../node_modules/vue-loader/lib/style-rewriter.js?id=data-v-7d6181ab!./../../node_modules/vue-loader/lib/selector.js?type=styles&index=0!./Draw.vue\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/extract-text-webpack-plugin/loader.js?{\"omit\":1,\"extract\":true,\"remove\":true}!./~/vue-style-loader!./~/css-loader?sourceMap!./~/vue-loader/lib/style-rewriter.js?id=data-v-7d6181ab!./~/vue-loader/lib/selector.js?type=styles&index=0!./src/components/Draw.vue\n// module id = 561\n// module chunks = 20","var __vue_exports__, __vue_options__\nvar __vue_styles__ = {}\n\n/* styles */\nrequire(\"!!./../../node_modules/extract-text-webpack-plugin/loader.js?{\\\"omit\\\":1,\\\"extract\\\":true,\\\"remove\\\":true}!vue-style-loader!css-loader?sourceMap!vue-loader/lib/style-rewriter?id=data-v-7d6181ab!vue-loader/lib/selector?type=styles&index=0!./Draw.vue\")\n\n/* script */\n__vue_exports__ = require(\"!!babel-loader!vue-loader/lib/selector?type=script&index=0!./Draw.vue\")\n\n/* template */\nvar __vue_template__ = require(\"!!vue-loader/lib/template-compiler?id=data-v-7d6181ab!vue-loader/lib/selector?type=template&index=0!./Draw.vue\")\n__vue_options__ = __vue_exports__ = __vue_exports__ || {}\nif (\n  typeof __vue_exports__.default === \"object\" ||\n  typeof __vue_exports__.default === \"function\"\n) {\n__vue_options__ = __vue_exports__ = __vue_exports__.default\n}\nif (typeof __vue_options__ === \"function\") {\n  __vue_options__ = __vue_options__.options\n}\n\n__vue_options__.render = __vue_template__.render\n__vue_options__.staticRenderFns = __vue_template__.staticRenderFns\n\nmodule.exports = __vue_exports__\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/Draw.vue\n// module id = 631\n// module chunks = 20","module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;\n  return _vm._c('div', {\n    staticClass: \"gv-draw-panel\",\n    attrs: {\n      \"id\": \"gv-draw-panel\"\n    }\n  }, [_vm._c('gv-title', {\n    directives: [{\n      name: \"draggable\",\n      rawName: \"v-draggable\"\n    }],\n    attrs: {\n      \"title\": _vm.title,\n      \"divId\": 'gv-draw-panel',\n      \"noClose\": true\n    }\n  }), _vm._v(\" \"), _vm._m(0), _vm._v(\" \"), _vm._c('el-row', {\n    staticClass: \"row-bg\",\n    attrs: {\n      \"type\": \"flex\",\n      \"justify\": \"left\"\n    }\n  }, [_vm._c('el-button', {\n    staticClass: \"gv-color-scheme\",\n    attrs: {\n      \"id\": \"gv-draw-submit\",\n      \"title\": \"Salva i dati sul DB\",\n      \"size\": \"mini\"\n    },\n    on: {\n      \"click\": _vm.submit\n    }\n  }, [_vm._v(\"Salva su DB\")]), _vm._v(\" \"), _vm._c('el-button', {\n    directives: [{\n      name: \"show\",\n      rawName: \"v-show\",\n      value: (_vm.cancelButton),\n      expression: \"cancelButton\"\n    }],\n    staticClass: \"gv-color-scheme\",\n    attrs: {\n      \"id\": \"gv-draw-cancel\",\n      \"title\": \"Ritorno alla applicazione\",\n      \"size\": \"mini\"\n    },\n    on: {\n      \"click\": _vm.cancel\n    }\n  }, [_vm._v(\"Annulla\")]), _vm._v(\" \"), _vm._c('el-button', {\n    directives: [{\n      name: \"show\",\n      rawName: \"v-show\",\n      value: (_vm.refreshButton),\n      expression: \"refreshButton\"\n    }],\n    staticClass: \"gv-color-scheme\",\n    attrs: {\n      \"id\": \"gv-draw-cancel\",\n      \"title\": \"Ricarica dati salvati sul DB\",\n      \"size\": \"mini\"\n    },\n    on: {\n      \"click\": _vm.refresh\n    }\n  }, [_vm._v(\"Ricarica\")])], 1)], 1)\n},staticRenderFns: [function (){var _vm=this;var _h=_vm.$createElement;\n  return _vm._c('div', {\n    staticClass: \"gv-draw-panel-body gv-inverted-color-scheme\",\n    attrs: {\n      \"id\": \"gv-draw-panel-body\"\n    }\n  }, [_vm._c('div', {\n    staticClass: \"gv-draw-panel-result gv-inverted-color-scheme\"\n  }, [_vm._c('div', {\n    attrs: {\n      \"id\": \"gv-draw-panel-draw\"\n    }\n  })])])\n}]}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/vue-loader/lib/template-compiler.js?id=data-v-7d6181ab!./~/vue-loader/lib/selector.js?type=template&index=0!./src/components/Draw.vue\n// module id = 755\n// module chunks = 20"],"sourceRoot":""}