webpackJsonp([13,11],{0:function(e,t,n){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}var r=n(5),a=o(r),s=n(199),l=o(s),u=n(204),c=o(u),d=n(14),p=o(d),h=n(44),f=i(h),g=n(1),m=o(g),_=n(327),v=o(_);n(319),n(320),n(321),n(318),n(186),n(185),n(187),n(286).polyfill(),m.default.component("gv-app",v.default);var y=new m.default,L=function(e){GV.config=f,f.set(e)},b=function(e){return L(e),new m.default({el:"#gv-container",template:"<gv-app></gv-app>"})},w=function(){(0,p.default)({elId:"gv-legend",clear:!0,containerId:GV.config.containerId,vm:new m.default({template:'<gv-legend ref="gv-legend"></gv-legend>'})})};window.GV={initConfig:L,init:b,globals:a.default,log:c.default,eventBus:y,mountLegend:w,utils:{getUrlParam:l.default},Buttons:[]};var M=n(355);M.keys().forEach(function(e){M(e)})},5:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={DEFAULT_PROXY:"/geoservices/apps/proxy/proxy.jsp?url=",USE_SUBDOMAINS:!0,RL_MAP_CONFIG_SERVICE:"srvcarto.regione.liguria.it/geoservices/REST/geoportale/map/",RL_DYN_MAP_CONFIG_SERVICE:"/geoservices/REST/config/map/",RL_CREATE_SLD_SERVICE:"srvcarto.regione.liguria.it/geoservices/REST/config/create_sld/",RL_CATALOG_SERVICE:"srvcarto.regione.liguria.it/geoservices/REST/geoportale/catalogo/",RL_CANALI_SERVICE:"srvcarto.regione.liguria.it/geoservices/REST/config/ag_app_canali_tree/",RL_SCHEDA_SERVICE:"srvcarto.regione.liguria.it/geoservices/REST/geoportale/scheda/",RL_ENTI_SERVICE:"srvcarto.regione.liguria.it/geoservices/REST/geoportale/enti/",RL_METADATA_URL:"/geoservices/REST/metadata/scheda_xml/",GOOGLE_GEOCODE_PROXY:"geoportale.regione.liguria.it/geoservices/REST/proxy/google_geocode?region=it&language=it&sensor=false&bounds=7.43,43.75|10.00,44.70",MAX_BOUNDS:{X_MIN:43.4,Y_MIN:7.3,X_MAX:44.8,Y_MAX:10.5},LOADING_OPTIONS:{target:"gv-map",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"},INFO_WMS_MAX_FEATURES:10,BASE_SCALES:[591657550.5,295828775.3,147914387.6,73957193.82,36978596.91,18489298.45,9244649.227,4622324.614,2311162.307,1155581.153,577790.5767,288895.2884,144447.6442,72223.82209,36111.91104,18055.95552,9027.977761,4513.98888,2256.99444,1128.49722,564.24861,282.124305],BASE_SCALE_LABELS:{8:"1:1.600.000",9:"1:800.000",10:"1:400.000",11:"1:200.000",12:"1:100.000",13:"1:50.000",14:"1:25.000",15:"1:12.500",16:"1:6.250",17:"1:3.125",18:"1:1.560",19:"1:800",20:"1:400"},BASE_LAYERS:{BLANK:{label:"Sfondo Bianco",icon:"http://srvcarto.regione.liguria.it/geoviewer/img/legend/bianco.gif"},RL_ORTOFOTO_2013:{label:"AGEA: Ortofoto 2013",icon:"http://srvcarto.regione.liguria.it/geoviewer/img/legend/sfondi_rl.jpg"},RL_ORTOFOTO_2016:{label:"AGEA: Ortofoto 2016",icon:"http://srvcarto.regione.liguria.it/geoviewer/img/legend/sfondi_rl.jpg"},RL_CARTE_BASE:{label:"Carte di base regionali",icon:"http://srvcarto.regione.liguria.it/geoviewer/img/legend/sfondi_rl.jpg"},OSM:{label:"OpenStreetMap",icon:"http://srvcarto.regione.liguria.it/geoviewer/img/legend/openstreetmap.png"},ESRI_IMAGERY:{label:"ESRI Imagery",icon:"http://srvcarto.regione.liguria.it/geoviewer/img/legend/esri.gif"},ESRI_TOPOGRAPHIC:{label:"ESRI Topographic",icon:"http://srvcarto.regione.liguria.it/geoviewer/img/legend/esri.gif"},ESRI_GRAY:{label:"ESRI Gray",icon:"http://srvcarto.regione.liguria.it/geoviewer/img/legend/esri.gif"},ESRI_DARKGRAY:{label:"ESRI Dark Gray",icon:"http://srvcarto.regione.liguria.it/geoviewer/img/legend/esri.gif"},MAPBOX_STREETS:{label:"Mapbox Streets",icon:"http://srvcarto.regione.liguria.it/geoviewer/img/legend/mapbox.png"},MAPBOX_SATELLITE:{label:"Mapbox Satellite",icon:"http://srvcarto.regione.liguria.it/geoviewer/img/legend/mapbox.png"},MAPBOX_OUTDOOR:{label:"Mapbox Outdoor",icon:"http://srvcarto.regione.liguria.it/geoviewer/img/legend/mapbox.png"},MAPBOX_LIGHT:{label:"Mapbox Light",icon:"http://srvcarto.regione.liguria.it/geoviewer/img/legend/mapbox.png"},STAMEN_TERRAIN:{label:"Stamen Terrain",icon:"http://srvcarto.regione.liguria.it/geoviewer/img/legend/mapbox.png"},STAMEN_TONER_LIGHT:{label:"Stamen Toner Light",icon:"http://srvcarto.regione.liguria.it/geoviewer/img/legend/mapbox.png"},GOOGLE_ROADMAP:{label:"Google Stradario",icon:"http://srvcarto.regione.liguria.it/geoviewer/img/legend/google.png"},GOOGLE_HYBRID:{label:"Google Ibrido",icon:"http://srvcarto.regione.liguria.it/geoviewer/img/legend/google.png"},GOOGLE_TERRAIN:{label:"Google Terreno",icon:"http://srvcarto.regione.liguria.it/geoviewer/img/legend/google.png"},GOOGLE_SATELLITE:{label:"Google Satellite",icon:"http://srvcarto.regione.liguria.it/geoviewer/img/legend/google.png"}}};t.default=n},12:function(e,t){},14:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.elId,n=e.vm,i=e.toggleEl,o=document.getElementById(t);if(i&&o)o.style.display="none"!==o.style.display&&o.style.display?"none":"block";else{var a=(0,r.default)(e);n.$mount(a)}return n};var o=n(196),r=i(o)},28:function(e,t){},29:function(e,t){},41:function(e,t){},44:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e){var n=this;if(!e)throw new Error("Opzioni di inizializzazione non impostate!");t.debug=R=e.debug,t.idMap=N=e.idMap,t.geoserverUrl=j=e.geoserverUrl,e.application&&(t.application=D=e.application),e.containerId&&(t.containerId=z=e.containerId),D.layout=e.application&&e.application.layout?e.application.layout:{},e.application&&(D.proxy=e.application.proxy||I.default.DEFAULT_PROXY),e.application&&e.application.layout&&e.application.layout.title&&(t.title=U=e.application.layout.title),t.baseLayers=F=e.baseLayers,F.forEach(function(e){e.name=e.type,e.label=I.default.BASE_LAYERS[e.type].label,e.icon=I.default.BASE_LAYERS[e.type].icon}),e.idMap?!function(){var t=e.application?e.application.callback:null,n=e.idMap.split(",");n.forEach(function(e){return v(e,t,!0)})}():GV.eventBus.$on("gv-app-mounted",function(t){e.maps.forEach(function(e){n.addMapConfig(e),GV.app.setTitle(e)}),D&&D.callback&&D.callback(t)}),GV.eventBus.$on("map-zoom",function(e){var t=n.getAllLayersConfig();t.forEach(function(e){n.setLayerAttribute(e.name,"inRange",GV.app.map.layerInRange(e))})})}function r(e){c(e.id)||(e.ancillaryMaps&&e.ancillaryMaps.forEach(function(e){return r(e)}),e.layers.forEach(function(e){e.minScale=0===e.minScale?591657550:e.minScale,e.inRange=!GV.app||!GV.app.map||GV.app.map.layerInRange(e),e.opacityBase100=100*e.opacity,e.zIndex=V++}),e.layers.reverse(),Z.unshift(e),GV.eventBus.$emit("config-add-map",{config:e}))}function a(){var e=[];return Z.forEach(function(t){t.layers.forEach(function(t){e.push(t)})}),e}function s(e,t,n){Z.forEach(function(i){var o=i.layers;o.forEach(function(i){i.name===e&&(i[t]=n)})})}function l(e){var t=null;if(Z.forEach(function(n){var i=n.layers;t=i.find(function(t){return t.name===e})}),t)return t}function u(e){var t=F.find(function(t){return t.name===e});return t}function c(e){return Z.find(function(t){return t.id==e})}function d(e){var t=null;return D.layout&&D.layout.toolbar?(D.layout.toolbar.forEach(function(n){n.items.forEach(function(n){n.name===e&&(t=n)},this)},this),t):null}function p(e,t){var n=null;return D.layout&&D.layout.toolbar?(D.layout.toolbar.forEach(function(i){i.items.forEach(function(i){i.name===e&&(n=i.options[t])},this)},this),n):null}function h(e,t,n){var i=null;return D.layout&&D.layout.toolbar?(D.layout.toolbar.forEach(function(i){i.items.forEach(function(i){i.name===e&&(i.options[t]=n)},this)},this),i):null}function f(){var e=null;return F.forEach(function(t){t.visible&&(e=t)}),e}function g(e){F.forEach(function(t){t.visible=t.name===e})}function m(e){var t=c(e);GV.eventBus.$emit("config-remove-map",{config:t});var n=Z.findIndex(function(t){return t.id===e});n>-1&&Z.splice(n,1)}function _(e){var t=this;Z.forEach(function(n){var i=-1;n.layers.forEach(function(t,n){t.name===e&&(i=n)}),i>-1&&n.layers.splice(i,1),0===n.layers.length&&t.removeMap(n.id)}),GV.eventBus.$emit("config-remove-layer",{config:e})}function v(e,t,n){var i=this;return c(e)?c(e):void(0,O.default)(e).then(function(e){if(!e.data.success)throw new Error("Errore Caricamento Mappa: "+e.data.message);if(!e.data.data)throw new Error("Errore Caricamento Mappa: configurazione non trovata");var o=e.data.data;return r(o),GV.app&&GV.app.setTitle&&GV.app.setTitle(o),GV.app&&GV.app.map&&o.type&&"R"==o.type&&n&&u("BLANK")&&(GV.app.map.changeBaseLayer("BLANK"),GV.baseLayerSwitcher.activeBaseLayer="BLANK"),o.activeBaseLayer&&(GV.app.map.changeBaseLayer(o.activeBaseLayer),GV.baseLayerSwitcher.activeBaseLayer=o.activeBaseLayer),t&&t(i),o}).catch(function(e){console.error(e),M.default.error({title:"Attenzione",type:"error",duration:5e3,offset:70,message:e.message})})}function y(e){var t=this;(0,x.default)().then(function(n){t.catalog=t.catalogFull=n.children,(0,T.default)().then(function(n){t.enti=n,e.showMapCatalogPanel&&(0,k.default)({elId:"gv-map-catalog-panel",toggleEl:!1,vm:new E.default({template:"<gv-map-catalog-panel></gv-map-catalog-panel>"})})})})}Object.defineProperty(t,"__esModule",{value:!0}),t.containerId=t.setActiveBaseLayer=t.setLayerAttribute=t.setButtonOption=t.getButtonOption=t.getButton=t.removeLayer=t.removeMap=t.loadCatalog=t.getMapConfig=t.getActiveBaseLayer=t.getBaseLayerConfig=t.getLayerConfig=t.getAllLayersConfig=t.addRlMap=t.addMapConfig=t.set=t.geoserverUrl=t.title=t.maps=t.baseLayers=t.application=t.idMap=t.debug=void 0;var L=n(290),b=(i(L),n(12)),w=(i(b),n(273)),M=i(w),C=n(1),E=i(C),S=n(5),I=i(S),G=n(57),O=i(G),A=n(93),x=i(A),B=n(189),T=i(B),P=n(14),k=i(P),V=21,R=!1,z="gv-container",N=null,U=null,j=void 0,D={},F=[{type:"ESRI_IMAGERY",visible:!0}],Z=[];t.debug=R,t.idMap=N,t.application=D,t.baseLayers=F,t.maps=Z,t.title=U,t.geoserverUrl=j,t.set=o,t.addMapConfig=r,t.addRlMap=v,t.getAllLayersConfig=a,t.getLayerConfig=l,t.getBaseLayerConfig=u,t.getActiveBaseLayer=f,t.getMapConfig=c,t.loadCatalog=y,t.removeMap=m,t.removeLayer=_,t.getButton=d,t.getButtonOption=p,t.setButtonOption=h,t.setLayerAttribute=s,t.setActiveBaseLayer=g,t.containerId=z},57:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"generico";if(!e||"null"===e)throw new Error("Parametro idMap mancante");var n=e.startsWith("D")?""+l.default.RL_DYN_MAP_CONFIG_SERVICE+e+"?app="+t:window.location.href.split(":")[0]+"://"+l.default.RL_MAP_CONFIG_SERVICE+e+"?app="+t,i={};return GV.config.geoserverUrl&&(i.geoserverUrl=GV.config.geoserverUrl),a.default.get(n,{params:i})}Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var r=n(13),a=i(r),s=n(5),l=i(s)},93:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=window.location.href.split(":")[0]+"://"+l.default.RL_CATALOG_SERVICE;return e.idMap&&(t+=e.idMap),a.default.get(t,{params:e}).then(function(e){return e.data.data})}Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var r=n(13),a=i(r),s=n(5),l=i(s)},94:function(e,t){"use strict";function n(e,t,n){var i=[];for(var o in e)i.push(encodeURIComponent(n?o.toUpperCase():o)+"="+encodeURIComponent(e[o]));return(t&&t.indexOf("?")!==-1?"&":"?")+i.join("&")}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n},95:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e){try{var t=null;if((0,a.default)()){var n=new ActiveXObject("Microsoft.XMLDOM");n.async="false",n.loadXML(e),t=n}else{var i=new DOMParser;t=i.parseFromString(e,"text/xml")}return t}catch(e){console.error(e)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var r=n(202),a=i(r)},116:function(e,t,n){var i,o;n(311),i=n(166);var r=n(351);o=i=i||{},"object"!=typeof i.default&&"function"!=typeof i.default||(o=i=i.default),"function"==typeof o&&(o=o.options),o.render=r.render,o.staticRenderFns=r.staticRenderFns,e.exports=i},160:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(7),r=i(o),a=n(5),s=(i(a),n(203)),l=(i(s),n(197)),u=(i(l),n(14)),c=i(u),d=n(1),p=i(d),h=n(335),f=i(h),g=n(334),m=i(g),_=n(329),v=i(_);p.default.component("gv-map",f.default),p.default.component("gv-legend",m.default),p.default.component("gv-header",v.default),p.default.component("gv-iframe-panel",function(){return new r.default(function(e){n.e(8,function(t){e(n(330))})})}),p.default.component("gv-info-wms-list",function(){return new r.default(function(e){n.e(6,function(t){e(n(332))})})}),p.default.component("gv-info-wms-html",function(){return new r.default(function(e){n.e(7,function(t){e(n(331))})})}),t.default={name:"gv-app",data:function(){return{showHeader:GV.config.application.layout.header,showTitle:GV.config.application.layout.title,showLegend:GV.config.application.layout.legend}},created:function(){GV.log("gv-app: created"),GV.app=this},mounted:function(){GV.log("gv-app: mounted"),this.addToolbars(GV.config.application.layout.toolbar),GV.eventBus.$emit("gv-app-mounted",this),GV.loadingInstance&&GV.loadingInstance.close()},methods:{getTitle:function(){return GV.config.title},getMaps:function(){return GV.config.maps},addToolbars:function(){var e=this;if(GV.config.application.layout.toolbar){var t=GV.config.application.layout.toolbar;t.forEach(function(t){var n=t.position||"topleft";t.items.forEach(function(t){t.options=t.options||{},t.options.position=t.options.position||n,e.addButton(t)})})}},addButton:function(e){if(!GV.Buttons[e.name])throw new Error("Bottone "+e.name+" non esistente");var t=GV.Buttons[e.name](e.options,GV.app.map);t&&(t.name=e.name,t.addTo(GV.app.map),GV.app.map.buttons.push(t),t.options.vueComponent&&this.mountBtnComponent(t.options.vueComponent),t.options.callBack&&t.options.callBack(t),t.options.autoClick&&setTimeout(function(){t.button.click()},1))},mountBtnComponent:function(e){(0,c.default)({containerId:e.containerId,elId:e.id,vm:new p.default({template:"<"+e.id+"></"+e.id+">"}),toggleEl:!1})},setTitle:function(e){"{map.title}"===GV.config.application.layout.title&&(GV.config.title=e.name)}}}},162:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"gv-header",computed:{style:function(){return"height:"+GV.config.application.layout.header.height}},mounted:function(){this.$el.innerHTML=GV.config.application.layout.header.html}}},166:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e){GV.log("start info request: "+new Date),C=0,E=0,S=[];var t=function(e,t,n){var i=GV.app.map.latLngToContainerPoint(n,GV.app.map.getZoom()),o=GV.app.map.getSize(),r=GV.app.map.getBounds(),a=GV.app.map.options.crs.project(r.getSouthWest()),s=GV.app.map.options.crs.project(r.getNorthEast()),l={request:"GetFeatureInfo",service:"WMS",crs:"EPSG:3857",styles:"",version:"1.3.0",format:"application/json",bbox:a.x+","+a.y+","+s.x+","+s.y,height:o.y,width:o.x,layers:t,query_layers:t,FEATURE_COUNT:100,buffer:10,info_format:"application/json",i:i.x,j:i.y};return e+(0,m.default)(l,e,!0)};GV.config.maps.forEach(function(n){var i=null,o=[];if(n.layers.forEach(function(e){e.idMap===n.id&&"WMS"===e.type&&e.queryable&&e.visible&&GV.app.map.layerInRange(e)&&(i=e.wmsParams.url,i=l.default.DEFAULT_PROXY+i,o.push(e.wmsParams.name))}),i&&o.length>0){var a=o.join(","),s=t(i,a,e.latlng);E++,GV.app.map._container.style.cursor="progress",(0,v.default)(s).then(function(e){return r(e)}).catch(function(e){return console.error(e)})}})}function r(e){function t(e,t){var i,o=GV.app.map.getLayerByName(e).config;return i=o.cachePostGIS?n(t):t}function n(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n.toUpperCase()]=e[n]);return t}function i(e,t){var n,i;return n=o(e,"infoLabelAttr"),i=o(e,"infoIdAttr"),n&&t[n]?t[n]:i&&t[i]?t[i]:t[r(t)]}function o(e,t){var n=GV.app.map.getLayerByName(e).config;return n&&n.infoOptions&&n.infoOptions[t]?n.infoOptions[t]:null}function r(e){for(var t in e)if(e.hasOwnProperty(t)&&"function"!=typeof t)return t;return null}if(C++,e.forEach(function(e){var n=e.id.split(".")[0];e.layerName=n,e.layer=GV.app.map.getLayerByName(n),e.properties=t(n,e.properties),e.label=i(n,e.properties),e.infoOptions=e.layer.config.infoOptions}),Array.prototype.push.apply(S,e),C===E){if(GV.app.map._container.style.cursor="default",0===S.length)return void GV.log("Nessun elemento trovato");1===S.length?a(S[0]):(0,p.default)({elId:"gv-info-wms-list",clear:!0,vm:new c.default({template:'<gv-info-wms-list :items="items"></gv-info-wms-list>',data:{items:S}})}),GV.log("end info request: "+new Date)}}function a(e){function t(e,t){function o(e){try{var t='<?xml version="1.0" encoding="ISO-8859-1"?><msGMLOutput xmlns:gml="http://www.opengis.net/gml" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"></msGMLOutput>',n=(0,f.default)(t),i=e.layerName+"_layer",o=n.createElement(i),r=e.layerName+"_feature",a=n.createElement(r),s=e.properties;for(var l in s)if(s.hasOwnProperty(l)){var u=null;u=s[l]?n.createTextNode(s[l]):n.createTextNode("");var c=n.createElement(l);c.appendChild(u),a.appendChild(c)}return o.appendChild(a),n.documentElement.appendChild(o),n}catch(e){console.error(e)}}function r(e,t){try{if(window.XSLTProcessor){var n=new XSLTProcessor;n.importStylesheet(t);var i=n.transformToDocument(e);return(new XMLSerializer).serializeToString(i)}return e.transformNode(t)}catch(e){console.error(e)}}var a=o(t),s=e.infoUrl,l=e.infoTarget;(0,M.default)(s,t).then(function(o){Array.prototype.slice.call(o.getElementsByTagName("td")).forEach(function(e,n,i){"Titolo"===e.id&&(e.textContent=t.layer.legend.label,e.text=t.layer.legend.label)});var s=r(a,o);l&&"panel"!==l?i(s,null,e):n(s,null,e)})}function n(e,t,n){e&&(0,p.default)({elId:"gv-info-wms-html",vm:new c.default({template:'<gv-info-wms-html :html="html" :height="height" :width="width" :title="title"></gv-info-wms-html>',data:{title:"Risultato Info",html:e,width:n.infoWidth||400,height:n.infoHeight||400}})})}function i(e,t,n){var i=n.infoWidth||400,o=n.infoHeight||500,r=window.open(t,"","status=yes, toolbar=yes, menubar=no, width="+i+", height="+o+", resizable=yes, scrollbars=yes");r.document.open(),r.document.write(e),r.document.close(),r.focus()}var o=e.infoOptions,r=o.infoUrl;".xsl"===r.substr(r.length-4)||".xslt"===r.substr(r.length-5)?t(o,e):o.infoTarget&&"panel"!==o.infoTarget?i(r,null,o):n(r,null,o),(0,b.default)(e).then(function(e){var t=GV.app.map.getLayerByName("InfoWmsHilite");e&&e[0]&&e[0].geometry&&(t.clearLayers(),t.addData(e[0].geometry),GV.app.map.fitBounds(t.getBounds(),{maxZoom:15}),GV.app.map._container.style.cursor="default")}).catch(function(e){console.error(e)})}Object.defineProperty(t,"__esModule",{value:!0});var s=n(5),l=i(s),u=n(1),c=i(u),d=n(14),p=i(d),h=n(95),f=i(h),g=n(94),m=i(g),_=n(191),v=i(_),y=n(190),b=i(y),w=n(192),M=i(w),C=0,E=0,S=[];t.default={name:"gv-info-wms-manager",data:function(){return{}},methods:{activate:function(){GV.log("GV.app.infoWmsManager.activate"),GV.app.map.loadLayers([{name:"InfoWmsHilite",type:"JSON",style:{color:"#ffcc00",fillOpacity:0,weight:6,opacity:.6},pointToLayer:function(e,t){return L.circleMarker(t,{radius:8,color:"#ffcc00",fillColor:"#ffcc00",fill:!0,fillOpacity:.6,weight:6,opacity:.6})},visible:!0}]),GV.eventBus.$on("map-click",function(e){o(e)})},deactivate:function(){GV.eventBus.$off("map-click",function(e){})},showFeatureInfo:a},created:function(){GV.log("infoWmsManager mounted")}}},168:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(41),r=(i(o),n(37)),a=i(r),s=n(28),l=(i(s),n(25)),u=i(l),c=n(29),d=(i(c),n(12)),p=(i(d),n(26)),h=i(p),f=n(7),g=i(f),m=n(1),_=i(m),v=n(14),y=i(v);_.default.component("gv-map-info-panel",function(){return new g.default(function(e){n.e(1,function(t){e(n(85))})})}),_.default.component("gv-base-layer-switcher",function(){return new g.default(function(e){n.e(9,function(t){e(n(328))})})}),_.default.component("gv-multi-legend-panel",function(){return new g.default(function(e){n.e(5,function(t){e(n(337))})})}),_.default.component("gv-map-catalog-panel",function(){return new g.default(function(e){n.e(0,function(t){e(n(336))})})}),_.default.component("gv-layers-transparency",function(){return new g.default(function(e){n.e(2,function(t){e(n(333))})})}),_.default.use(h.default),_.default.use(u.default),_.default.use(a.default),t.default={name:"gv-legend",data:function(){return{baseLayers:GV.config.baseLayers,maps:GV.config.maps,options:GV.config.application.layout.legend.options,show:!0}},mounted:function(){if(GV.log("gv-legend: mounted"),GV.legend=this,this.options.showAddMap){var e=!GV.config.idMap;GV.config.loadCatalog({showMapCatalogPanel:e})}},methods:{isDownloadable:function(e){return e.metaData.flag_download},checkAddMap:function(e){return this.options.showAddMap&&GV.config.getMapConfig(e.id).metaData},hideLegend:function(e){this.show?(document.getElementById("gv-legend-wrapper").style.display="none",document.getElementById("gv-legend").style.width="220px"):(document.getElementById("gv-legend-wrapper").style.display="block",document.getElementById("gv-legend").style.width="260px"),this.show=!this.show},showMapInfoPanel:function(e){GV.config.schedaInfoCartografia=GV.config.getMapConfig(e.id).metaData,(0,y.default)({elId:"gv-map-info-panel",containerId:GV.config.containerId,clear:!0,vm:new _.default({template:'<gv-map-info-panel visible="true" idMap="'+e.id+'"></gv-map-info-panel>'})})},remove:function(e){GV.config.removeMap(e.id)},download:function(e){window.open(e.metaData.link_download)},addMap:function(){(0,y.default)({elId:"gv-map-catalog-panel",containerId:GV.config.containerId,toggleEl:!0,vm:new _.default({template:"<gv-map-catalog-panel></gv-map-catalog-panel>"})})},layerTransparency:function(e){(0,y.default)({elId:"gv-layers-transparency",containerId:GV.config.containerId,toggleEl:!1,vm:new _.default({template:'<gv-layers-transparency idMap="'+e.id+'"></gv-layers-transparency>'})})},iconUrl:function(e){return e.legend.icon},getClass:function(e){return e.inRange?"gv-list-legend-layer-item":"gv-list-legend-layer-item gv-list-legend-layer-disabled-item"},setLayerVisible:function(e,t){GV.eventBus.$emit("set-layer-visible",{layer:e,checked:t.currentTarget.checked})},showLegendPanel:function(e){if(e.inRange&&(e.multiClasse||e.legend.popUpFlag)){var t,n,i=null,o=null;if(e.legend.popUpUrl&&e.legend.popUpFlag)i=e.legend.popUpUrl,t=window.matchMedia("(max-width: 620px)").matches?400:600,n=window.matchMedia("(max-height: 620px)").matches?400:600;else if(e.multiClasse)if(e.flagGeoserver)i=e.wmsParams.url+"LAYER="+e.name+"&REQUEST=GetLegendGraphic&VERSION=1.0.0&FORMAT=image/png&WIDTH=20&HEIGHT=20&",t=window.matchMedia("(max-width: 450px)").matches?300:400,n=350;else{var r=e.classes;o="<table width=100% border=0>",r.forEach(function(e){o+="<tr>",o+='<td width=30><img src="'+e.legendIcon+'"></td>',o+="<td >"+e.legendLabel+"</td>",o+="</tr>"}),o+="</table>"}(0,y.default)({elId:"gv-multi-legend-panel",containerId:GV.config.containerId,vm:new _.default({template:'<gv-multi-legend-panel visible="true" :src="src" :html="html" :height="height" :width="width" :title="title"></gv-multi-legend-panel>',data:{title:"LEGENDA - "+e.legend.label,src:i,html:o,width:t,height:n}})})}}}}},169:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),r=i(o),a=n(182),s=i(a),l=n(116),u=i(l);r.default.component("gv-info-wms-manager",u.default);var c=["click","dblclick","mousedown","mouseup","mouseover","mouseout","mousemove","contextmenu","focus","blur","preclick","load","unload","viewreset","movestart","move","moveend","dragstart","drag","dragend","zoomstart","zoomend","zoomanim","zoomlevelschange","resize","autopanstart","layeradd","layerremove","baselayerchange","overlayadd","overlayremove","locationfound","locationerror","popupopen","popupclose"];t.default={name:"gv-map",data:function(){var e=document.documentElement.clientHeight;return{style:"height:"+e+"px"}},mounted:function(){GV.app.map=new s.default,this.registerMapEvents(),this.subscribeConfigEvents(),window.addEventListener("resize",this.handleResize),this.handleResize(),GV.config.application.mapOptions&&GV.config.application.mapOptions.click&&this.$refs.info.activate(),GV.log("gv-map: mounted")},methods:{handleResize:function(e){var t=document.documentElement.clientHeight-document.getElementById("gv-map").getBoundingClientRect().top;this.style="height:"+t+"px"},registerMapEvents:function(){c.forEach(function(e){var t="map-"+e;GV.app.map.on(e,function(e){GV.eventBus.$emit(t,e)})})},subscribeConfigEvents:function(){GV.eventBus.$on("config-add-map",function(e){var t=e.config;GV.app.map.loadLayers(t.layers),t.extent_3857&&GV.app.map.setExtent(t.extent_3857)}),GV.eventBus.$on("config-remove-map",function(e){var t=e.config;t.layers.forEach(function(e){var t=GV.app.map.getLayerByName(e.name);t&&GV.app.map.removeLayer(t)})})}}}},174:function(e,t){"use strict";GV.Buttons.div=function(e,t){var n="gv-button-div",i=L.Control.extend({onAdd:function(t){var i=document.createElement("div");return i.id=n,i.className="leaflet-bar leaflet-control",i.innerHTML=e.html,i}});return new i(e)}},175:function(e,t){"use strict";GV.Buttons.fullscreen=function(e,t){return L.control.fullscreen(e)}},176:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var o=n(7),r=i(o),a=n(1),s=i(a);GV.Buttons.geocoder=function(e,t){var i="gv-button-geocoder",o="gv-geocoder",a=L.Control.extend({onAdd:function(e){var t=document.createElement("div");return t.id=i,t.className="leaflet-bar leaflet-control",L.DomEvent.disableClickPropagation(t),t}});return s.default.component("gv-geocoder",function(){return new r.default(function(e){n.e(4,function(t){e(n(324))})})}),e.vueComponent={containerId:i,id:o},new a(e)}},177:function(e,t){"use strict";GV.Buttons.locate=function(e,t){return L.control.Locate(e)}},178:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var o=n(7),r=i(o),a=n(1),s=i(a);GV.Buttons.scalebar=function(e,t){var i="gv-button-scalebar",o="gv-scalebar",a=L.Control.extend({onAdd:function(e){var t=document.createElement("div");return t.id=i,t.className="leaflet-bar leaflet-control",L.DomEvent.disableClickPropagation(t),t}});return s.default.component("gv-scalebar",function(){return new r.default(function(e){n.e(10,function(t){e(n(325))})})}),e.vueComponent={containerId:i,id:o},new a(e)}},179:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var o=n(7),r=i(o),a=n(1),s=i(a);GV.Buttons.search=function(e,t){var i="gv-button-search",o="gv-search",a=L.Control.extend({onAdd:function(e){var t=document.createElement("div");return t.id=i,t.className="leaflet-control-search",L.DomEvent.disableClickPropagation(t),t}});return s.default.component("gv-search",function(){return new r.default(function(e){n.e(3,function(t){e(n(326))})})}),e.vueComponent={containerId:i,id:o},new a(e)}},180:function(e,t){"use strict";GV.Buttons.zoom=function(e,t){return L.control.zoom(e)}},181:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var n=void 0;if(t){var i=t.geomField||"location",o=e.hits.hits;n={type:"FeatureCollection",totalFeatures:e.hits.total,features:[],crs:{type:"name",properties:{name:"urn:ogc:def:crs:EPSG::4326"}}},o.forEach(function(e){var t=e._source[i];n.features.push({type:"Feature",id:e._id,geometry:{type:"Point",coordinates:t},geometry_name:"GEOMETRY",properties:e._source})})}else n="string"==typeof e?JSON.parse(e):e;return n}function r(e,t){if(M[e.type]){var n=M[e.type](e,t);return n.legend=e.legend,n.config=e,n}throw new Error("Layer di tipo "+e.type+" non gestito")}Object.defineProperty(t,"__esModule",{value:!0}),t.create=void 0;var a=n(58),s=i(a),l=n(115),u=i(l),c=n(5),d=i(c),p=n(201),h=i(p),f=n(94),g=i(f),m=n(200),_=i(m),v=n(193),y=i(v),L=n(198),b=i(L);n(183),n(184);var w='<a href="http://www.esri.com/">Esri</a>',M={BLANK:function(e){return e.legend={label:"Sfondo Bianco"},u.default.tileLayer("http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{opacity:0})},OSM:function(e){return e.legend={label:"OpenStreetMap"},u.default.tileLayer("http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'Map data © <a href="http://openstreetmap.org">OpenStreetMap</a> contributors'})},ESRI_IMAGERY:function(e){e.legend={label:"ESRI Imagery"},e.name=e.type;var t="DigitalGlobe, GeoEye, i-cubed, USDA, USGS, AEX, Getmapping, Aerogrid, IGN, IGP, swisstopo, and the GIS User Community";return u.default.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{attribution:"&copy; "+w+", "+t,maxZoom:19})},ESRI_STREETS:function(e){e.legend={label:"ESRI Streets"},e.name=e.type;var t="USGS, NOAA";return u.default.tileLayer("http://server.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}",{attribution:"&copy; "+w+", "+t,maxZoom:19})},ESRI_TOPOGRAPHIC:function(e){e.legend={label:"ESRI Topographic"},e.name=e.type;var t="USGS, NOAA";return u.default.tileLayer("http://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}",{attribution:"&copy; "+w+", "+t,maxZoom:19})},ESRI_GRAY:function(e){e.legend={label:"ESRI Gray"},e.name=e.type;var t="HERE, DeLorme, MapmyIndia, OpenStreetMap contributors";return u.default.tileLayer("http://server.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}",{attribution:"&copy; "+w+", "+t,maxZoom:16})},ESRI_DARKGRAY:function(e){e.legend={label:"ESRI Dark Gray"},e.name=e.type;var t="HERE, DeLorme, MapmyIndia, OpenStreetMap contributors";return u.default.tileLayer("http://server.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Base/MapServer/tile/{z}/{y}/{x}",{attribution:"&copy; "+w+", "+t,maxZoom:16})},MAPBOX_STREETS:function(e){return e.legend={label:"Mapbox Streets"},u.default.tileLayer("http://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1Ijoic3RlZmFub3Bhcm9kaSIsImEiOiJjaXRma2VzeWgwMGVmMnh0bzJzMmVjcGVtIn0.2lTBdEwBI6_2QBzboizE5g",{attribution:'Imagery from <a href="http://mapbox.com/about/maps/">MapBox</a> &mdash; Map data &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>',subdomains:"abcd",id:"mapbox.streets",accessToken:"pk.eyJ1Ijoic3RlZmFub3Bhcm9kaSIsImEiOiJjaXRma2VzeWgwMGVmMnh0bzJzMmVjcGVtIn0.2lTBdEwBI6_2QBzboizE5g"})},MAPBOX_SATELLITE:function(e){return e.legend={label:"Mapbox Satellite"},u.default.tileLayer("http://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1Ijoic3RlZmFub3Bhcm9kaSIsImEiOiJjaXRma2VzeWgwMGVmMnh0bzJzMmVjcGVtIn0.2lTBdEwBI6_2QBzboizE5g",{attribution:'Imagery from <a href="http://mapbox.com/about/maps/">MapBox</a> &mdash; Map data &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>',subdomains:"abcd",id:"mapbox.satellite",accessToken:"pk.eyJ1Ijoic3RlZmFub3Bhcm9kaSIsImEiOiJjaXRma2VzeWgwMGVmMnh0bzJzMmVjcGVtIn0.2lTBdEwBI6_2QBzboizE5g"})},MAPBOX_OUTDOOR:function(e){return e.legend={label:"Mapox Outdoor"},u.default.tileLayer("http://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1Ijoic3RlZmFub3Bhcm9kaSIsImEiOiJjaXRma2VzeWgwMGVmMnh0bzJzMmVjcGVtIn0.2lTBdEwBI6_2QBzboizE5g",{attribution:'Imagery from <a href="http://mapbox.com/about/maps/">MapBox</a> &mdash; Map data &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>',subdomains:"abcd",id:"mapbox.outdoors",accessToken:"pk.eyJ1Ijoic3RlZmFub3Bhcm9kaSIsImEiOiJjaXRma2VzeWgwMGVmMnh0bzJzMmVjcGVtIn0.2lTBdEwBI6_2QBzboizE5g"})},MAPBOX_LIGHT:function(e){return e.legend={label:"Mapox Light"
},u.default.tileLayer("http://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1Ijoic3RlZmFub3Bhcm9kaSIsImEiOiJjaXRma2VzeWgwMGVmMnh0bzJzMmVjcGVtIn0.2lTBdEwBI6_2QBzboizE5g",{attribution:'Imagery from <a href="http://mapbox.com/about/maps/">MapBox</a> &mdash; Map data &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>',subdomains:"abcd",id:"mapbox.light",accessToken:"pk.eyJ1Ijoic3RlZmFub3Bhcm9kaSIsImEiOiJjaXRma2VzeWgwMGVmMnh0bzJzMmVjcGVtIn0.2lTBdEwBI6_2QBzboizE5g"})},STAMEN_TERRAIN:function(e){return e.legend={label:"Stamen Terrain"},u.default.tileLayer("http://stamen-tiles-{s}.a.ssl.fastly.net/terrain/{z}/{x}/{y}.{ext}",{attribution:'Map tiles by <a href="http://stamen.com">Stamen Design</a>, <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> &mdash; Map data &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>',subdomains:"abcd",minZoom:0,maxZoom:18,ext:"png"})},STAMEN_TONER_LIGHT:function(e){return e.legend={label:"Stamen Toner Light"},u.default.tileLayer("http://stamen-tiles-{s}.a.ssl.fastly.net/toner-lite/{z}/{x}/{y}.{ext}",{attribution:'Map tiles by <a href="http://stamen.com">Stamen Design</a>, <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> &mdash; Map data &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>',subdomains:"abcd",minZoom:0,maxZoom:20,ext:"png"})},RL_ORTOFOTO_2013:function(){return this.TMS({visible:!1,tmsParams:{name:"L4419/webmercator",url:"http://mapproxy.regione.liguria.it/mapproxy/1661/tiles/"},zIndex:1})},RL_ORTOFOTO_2016:function(){return this.TMS({visible:!1,tmsParams:{name:"L5802/webmercator",url:"http://mapproxy.regione.liguria.it/mapproxy/1828/tiles/"},zIndex:1})},RL_CARTE_BASE:function(){return this.TMS({visible:!1,tmsParams:{name:"C1623/webmercator",url:"http://mapproxy.regione.liguria.it/mapproxy/1623/tiles/"},zIndex:1})},TMS:function(e){var t=e.tmsParams.url.replace("/tms/","/tiles/"),n=e.tmsParams.name,i=t+"/1.0.0/"+n+"/{z}/{x}/{y}.png",o=(0,b.default)(e.maxScale),r=new u.default.TileLayer(i,{minZoom:1,maxZoom:o});return r.setZIndex(e.zIndex),r.name=n.replace("/webmercator",""),r},WMS:function(e){var t=e.name,n=e.geomType,i=e.cacheMinZoomLevel,o=e.minScale,r=e.maxScale,a=e.wmsParams,l=e.flagGeoserver,c=e.zIndex;GV.log("layerFactory - Creazione Layer WMS: "+t);var p=!!i,h="VECTOR"===n?"image/png8":i?"image/jpeg":"image/png",f=o?(0,_.default)(o):8,g=r?(0,_.default)(r):20,m=a.url,v=e.opacity||1;l||(i=null,h="VECTOR"===n?"image/png":"image/jpeg");var y={subdomains:["1","2"],transparent:!0,FORMAT_OPTIONS:"antialias:text",layers:t,format:h,opacity:v,minZoom:f,maxZoom:g,bounds:u.default.latLngBounds(u.default.latLng(d.default.MAX_BOUNDS.X_MIN,d.default.MAX_BOUNDS.Y_MIN),u.default.latLng(d.default.MAX_BOUNDS.X_MAX,d.default.MAX_BOUNDS.Y_MAX))},L=null;return p?(d.default.USE_SUBDOMAINS&&m.indexOf("geoservizi.regione.liguria.it")>0&&(m=m.replace("geoservizi","geoservizi{s}")),(0,s.default)(y,{tiled:!0,TILESORIGIN:"-20037508,-20037508",tileSize:256,CACHE_VERSION:e.cacheVersion}),L=u.default.tileLayer.wms(m,y)):((0,s.default)(y,{tiled:!1,pane:"tilePane"}),L=u.default.nonTiledLayer.wms(m,y)),L.setZIndex(c),L.type="WMS",L.name=t,L},JSON:function(e){var t=e.data,n=e.url,i=e.name,r=e.wfsParams,a=e.esParams,l=e.classes,c=e.style,d=e.pointToLayer,p=e.tooltip,f=e.popup,m=e.cluster,_=null,v={};l&&l.length>0&&("POINT"===e.geomSubType?v.pointToLayer=function(e,t){var n;if(l.forEach(function(t){t.filter&&t.filter.key&&t.filter.value?e.properties[t.filter.key]===t.filter.value&&(n=t.style):n=t.style}),n.iconUrl){var i;switch(n.iconUrl){case"default":i=u.default.icon({iconUrl:"http://geoportale.regione.liguria.it/geoviewer2/static/img/marker-icon.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[0,-41]});break;case"default-small":i=u.default.icon({iconUrl:"http://geoportale.regione.liguria.it/geoviewer2/static/img/marker-icon.png",iconSize:[12,20],iconAnchor:[6,10],popupAnchor:[0,-20]});break;default:i=u.default.icon({iconUrl:n.iconUrl,iconSize:n.iconSize,iconAnchor:n.iconAnchor,popupAnchor:n.popupAnchor})}return u.default.marker(t,{icon:i})}return u.default.circleMarker(t,n)}:v.style=function(e){var t;return l.forEach(function(n){n.filter&&n.filter.key&&n.filter.value?e.properties[n.filter.key]===n.filter.value&&(t=n.style):t=n.style}),t},v.filter=function(e){var t=!1;return l.forEach(function(n){n.filter?n.filter.key&&n.filter.value&&e.properties[n.filter.key]===n.filter.value&&(t=!0):t=!0}),t}),c&&(v.style=c),d&&(v.pointToLayer=d),(p||f)&&(v.onEachFeature=function(e,t){p&&(t.options.title=(0,h.default)(p,e.properties)),f&&t.bindPopup((0,h.default)(f,e.properties))});var L=u.default.geoJson(t,v);L.name=i,L.setFilter=function(e){L.filter=e,e?L.eachLayer(function(t){var n=0;e.forEach(function(e){t.feature.properties[e.key]===e.value&&(n=L.config.opacity||1)}),t.setOpacity(n)}):L.eachLayer(function(e){var t=L.config.opacity||1;e.setOpacity(t)})};var b;if(r&&r.typeName&&r.url&&(b={service:"WFS",version:"2.0.0",request:"GetFeature",srsName:"EPSG:4326",outputFormat:"text/javascript",format_options:"callback: getJson",typeName:r.typeName},n=r.url+(0,g.default)(b)),a&&(b={},a.field?(b.q=a.field+":",a.query?b.q+=a.query:b.q+="*"):a.query&&(b.q=a.query),b.pretty="true",b.size=1e5,n=GV.config.application.proxy+a.url+(0,g.default)(b)),m){var w={showCoverageOnHover:!1};m.options&&(0,s.default)(w,m.options),_=u.default.markerClusterGroup(w),_.name=i}return n&&(0,y.default)(n).then(function(e){var t=o(e.data,a);L.addData(t),m&&_.addLayer(L),GV.eventBus.$emit("layer-loaded-json",L)}).catch(function(e){return console.error(e)}),t&&m&&_.addLayer(L),m?_:L}};t.create=r},182:function(e,t,n){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(58),a=o(r),s=n(5),l=o(s),u=n(181),c=i(u),d=n(115),p=o(d),h=p.default.Map.extend({layers:[],baseLayers:[],initialExtent:[],buttons:[],mapOptions:{zoomControl:!1,maxBounds:p.default.latLngBounds(p.default.latLng(l.default.MAX_BOUNDS.X_MIN,l.default.MAX_BOUNDS.Y_MIN),p.default.latLng(l.default.MAX_BOUNDS.X_MAX,l.default.MAX_BOUNDS.Y_MAX)),maxBoundsViscosity:1,minZoom:7},initialize:function(){(0,a.default)(this.mapOptions,GV.config.application.mapOptions),p.default.Map.prototype.initialize.call(this,"gv-map",p.default.extend(p.default.Map.prototype.options,this.mapOptions)),this.setInitialExtent(),this.setLoading(),this.loadBaseLayers(),this.loadControls(),this.eventMngr()},eventMngr:function(){var e=this,t=this;this.on("zoom",function(){GV.eventBus.$emit("map-zoom",this._zoom)}),GV.eventBus.$on("set-layer-visible",function(e){t.setLayerVisible(e.layer,e.checked)}),GV.eventBus.$on("set-layer-transparency",function(t){var n=e.getLayerByName(t.layerName);n.setOpacity(t.opacity)}),GV.eventBus.$on("change-base-layer",function(e){t.changeBaseLayer(e.layer)})},setInitialExtent:function(){var e=this.mapOptions.initialExtent||"830036,5402959,1123018,5597635",t=e.split(","),n=p.default.point(t[0],t[1]),i=p.default.point(t[2],t[3]),o=p.default.Projection.SphericalMercator.unproject(n),r=p.default.Projection.SphericalMercator.unproject(i);this.initialExtent=p.default.latLngBounds(o,r),this.fitBounds(this.initialExtent)},setExtent:function(e){var t=e.split(","),n=p.default.point(t[0],t[1]),i=p.default.point(t[2],t[3]),o=p.default.Projection.SphericalMercator.unproject(n),r=p.default.Projection.SphericalMercator.unproject(i);this.initialExtent=p.default.latLngBounds(o,r),this.fitBounds(this.initialExtent)},setLayerVisible:function(e,t){t?(e.visible=!0,this.loadLayers([e])):this.removeLayer(this.getLayerByName(e.name))},layerInRange:function(e){return!e.minScale&&!e.minScale||this.getScale()<e.minScale&&this.getScale()>e.maxScale},loadControls:function(){if(this.mapOptions.controls){var e;this.controls={},this.mapOptions.controls.forEach(function(t){switch(t.name){case"scale":e=p.default.control.scale({imperial:!1}).addTo(this),this.controls[t]=e}},this)}},loadBaseLayers:function(){GV.config.baseLayers.forEach(function(e){var t=c.create(e,this);this.baseLayers[t.config.type]=t,t&&e.visible&&(t.on("loading",function(){this.loading(!0,t)},this),t.on("load",function(){this.loading(!1,t)},this),t.addTo(this))},this)},loadLayers:function(e){e.forEach(function(e){if(!this.getLayerByName(e.name)){var t=c.create(e,this);t&&e.visible&&(t.on("loading",function(){this.loading(!0,t)},this),t.on("load",function(){this.loading(!1,t)},this),t.addTo(this))}},this)},getLayerByName:function(e){var t=null;return this.eachLayer(function(n){n.config&&n.config.name&&n.config.name===e&&(t=n)}),t},changeBaseLayer:function(e){var t=GV.config.getActiveBaseLayer().name;t!==e&&(this.removeLayer(this.baseLayers[t]),this.baseLayers[e].addTo(this),GV.config.setActiveBaseLayer(e))},getScaleLabel:function(){return l.default.BASE_SCALE_LABELS[this._zoom]},getScale:function(){return l.default.BASE_SCALES[this._zoom]},setLoading:function(){this._spinning=0,this.on("layerremove",function(e){e.layer.loading&&this.loading(!1),"function"==typeof e.layer.on&&(e.layer.off("load"),e.layer.off("loading"))},this)},loading:function(e,t){e?(0===this._spinning&&(GV.log("start load: "+t.config.name),this._container.style.cursor="progress"),this._spinning++):(this._spinning--,this._spinning<=0&&(GV.log("end load: "+t.config.name),this._container.style.cursor="default"))},addMarker:function(e){var t=p.default.icon({iconUrl:"http://srvcarto.regione.liguria.it/geoviewer2/static/img/marker-icon.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[0,-41]}),n={opacity:.8,icon:t,title:e.label};"circle"===e.type?p.default.circleMarker(e.location,n).addTo(this):p.default.marker(e.location,n).addTo(this),this.setView(e.location,e.zoomLevel||14)}});t.default=h},183:function(e,t){"use strict";!function(e,t,n){L.MarkerClusterGroup=L.FeatureGroup.extend({options:{maxClusterRadius:80,iconCreateFunction:null,spiderfyOnMaxZoom:!0,showCoverageOnHover:!0,zoomToBoundsOnClick:!0,singleMarkerMode:!1,disableClusteringAtZoom:null,removeOutsideVisibleBounds:!0,animate:!0,animateAddingMarkers:!1,spiderfyDistanceMultiplier:1,spiderLegPolylineOptions:{weight:1.5,color:"#222",opacity:.5},chunkedLoading:!1,chunkInterval:200,chunkDelay:50,chunkProgress:null,polygonOptions:{}},initialize:function(e){L.Util.setOptions(this,e),this.options.iconCreateFunction||(this.options.iconCreateFunction=this._defaultIconCreateFunction),this._featureGroup=L.featureGroup(),this._featureGroup.addEventParent(this),this._nonPointGroup=L.featureGroup(),this._nonPointGroup.addEventParent(this),this._inZoomAnimation=0,this._needsClustering=[],this._needsRemoving=[],this._currentShownBounds=null,this._queue=[];var t=L.DomUtil.TRANSITION&&this.options.animate;L.extend(this,t?this._withAnimation:this._noAnimation),this._markerCluster=t?L.MarkerCluster:L.MarkerClusterNonAnimated},addLayer:function(e){if(e instanceof L.LayerGroup)return this.addLayers([e]);if(!e.getLatLng)return this._nonPointGroup.addLayer(e),this;if(!this._map)return this._needsClustering.push(e),this;if(this.hasLayer(e))return this;this._unspiderfy&&this._unspiderfy(),this._addLayer(e,this._maxZoom),this._topClusterLevel._recalculateBounds();var t=e,n=this._map.getZoom();if(e.__parent)for(;t.__parent._zoom>=n;)t=t.__parent;return this._currentShownBounds.contains(t.getLatLng())&&(this.options.animateAddingMarkers?this._animationAddLayer(e,t):this._animationAddLayerNonAnimated(e,t)),this},removeLayer:function(e){return e instanceof L.LayerGroup?this.removeLayers([e]):e.getLatLng?this._map?e.__parent?(this._unspiderfy&&(this._unspiderfy(),this._unspiderfyLayer(e)),this._removeLayer(e,!0),this._topClusterLevel._recalculateBounds(),e.off("move",this._childMarkerMoved,this),this._featureGroup.hasLayer(e)&&(this._featureGroup.removeLayer(e),e.clusterShow&&e.clusterShow()),this):this:(!this._arraySplice(this._needsClustering,e)&&this.hasLayer(e)&&this._needsRemoving.push(e),this):(this._nonPointGroup.removeLayer(e),this)},addLayers:function(e){if(!L.Util.isArray(e))return this.addLayer(e);var t,n=this._featureGroup,i=this._nonPointGroup,o=this.options.chunkedLoading,r=this.options.chunkInterval,a=this.options.chunkProgress,s=e.length,l=0,u=!0;if(this._map){var c=(new Date).getTime(),d=L.bind(function(){for(var p=(new Date).getTime();l<s;l++){if(o&&l%200===0){var h=(new Date).getTime()-p;if(h>r)break}if(t=e[l],t instanceof L.LayerGroup)u&&(e=e.slice(),u=!1),this._extractNonGroupLayers(t,e),s=e.length;else if(t.getLatLng){if(!this.hasLayer(t)&&(this._addLayer(t,this._maxZoom),t.__parent&&2===t.__parent.getChildCount())){var f=t.__parent.getAllChildMarkers(),g=f[0]===t?f[1]:f[0];n.removeLayer(g)}}else i.addLayer(t)}a&&a(l,s,(new Date).getTime()-c),l===s?(this._topClusterLevel._recalculateBounds(),this._featureGroup.eachLayer(function(e){e instanceof L.MarkerCluster&&e._iconNeedsUpdate&&e._updateIcon()}),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds)):setTimeout(d,this.options.chunkDelay)},this);d()}else for(var p=this._needsClustering;l<s;l++)t=e[l],t instanceof L.LayerGroup?(u&&(e=e.slice(),u=!1),this._extractNonGroupLayers(t,e),s=e.length):t.getLatLng?this.hasLayer(t)||p.push(t):i.addLayer(t);return this},removeLayers:function(e){var t,n,i=e.length,o=this._featureGroup,r=this._nonPointGroup,a=!0;if(!this._map){for(t=0;t<i;t++)n=e[t],n instanceof L.LayerGroup?(a&&(e=e.slice(),a=!1),this._extractNonGroupLayers(n,e),i=e.length):(this._arraySplice(this._needsClustering,n),r.removeLayer(n),this.hasLayer(n)&&this._needsRemoving.push(n));return this}if(this._unspiderfy){this._unspiderfy();var s=e.slice(),l=i;for(t=0;t<l;t++)n=s[t],n instanceof L.LayerGroup?(this._extractNonGroupLayers(n,s),l=s.length):this._unspiderfyLayer(n)}for(t=0;t<i;t++)n=e[t],n instanceof L.LayerGroup?(a&&(e=e.slice(),a=!1),this._extractNonGroupLayers(n,e),i=e.length):n.__parent?(this._removeLayer(n,!0,!0),o.hasLayer(n)&&(o.removeLayer(n),n.clusterShow&&n.clusterShow())):r.removeLayer(n);return this._topClusterLevel._recalculateBounds(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds),o.eachLayer(function(e){e instanceof L.MarkerCluster&&e._updateIcon()}),this},clearLayers:function(){return this._map||(this._needsClustering=[],delete this._gridClusters,delete this._gridUnclustered),this._noanimationUnspiderfy&&this._noanimationUnspiderfy(),this._featureGroup.clearLayers(),this._nonPointGroup.clearLayers(),this.eachLayer(function(e){e.off("move",this._childMarkerMoved,this),delete e.__parent}),this._map&&this._generateInitialClusters(),this},getBounds:function(){var e=new L.LatLngBounds;this._topClusterLevel&&e.extend(this._topClusterLevel._bounds);for(var t=this._needsClustering.length-1;t>=0;t--)e.extend(this._needsClustering[t].getLatLng());return e.extend(this._nonPointGroup.getBounds()),e},eachLayer:function(e,t){var n,i=this._needsClustering.slice(),o=this._needsRemoving;for(this._topClusterLevel&&this._topClusterLevel.getAllChildMarkers(i),n=i.length-1;n>=0;n--)o.indexOf(i[n])===-1&&e.call(t,i[n]);this._nonPointGroup.eachLayer(e,t)},getLayers:function(){var e=[];return this.eachLayer(function(t){e.push(t)}),e},getLayer:function(e){var t=null;return e=parseInt(e,10),this.eachLayer(function(n){L.stamp(n)===e&&(t=n)}),t},hasLayer:function(e){if(!e)return!1;var t,n=this._needsClustering;for(t=n.length-1;t>=0;t--)if(n[t]===e)return!0;for(n=this._needsRemoving,t=n.length-1;t>=0;t--)if(n[t]===e)return!1;return!(!e.__parent||e.__parent._group!==this)||this._nonPointGroup.hasLayer(e)},zoomToShowLayer:function(e,t){"function"!=typeof t&&(t=function(){});var n=function n(){!e._icon&&!e.__parent._icon||this._inZoomAnimation||(this._map.off("moveend",n,this),this.off("animationend",n,this),e._icon?t():e.__parent._icon&&(this.once("spiderfied",t,this),e.__parent.spiderfy()))};if(e._icon&&this._map.getBounds().contains(e.getLatLng()))t();else if(e.__parent._zoom<this._map.getZoom())this._map.on("moveend",n,this),this._map.panTo(e.getLatLng());else{var i=function(){this._map.off("movestart",i,this),i=null};this._map.on("movestart",i,this),this._map.on("moveend",n,this),this.on("animationend",n,this),e.__parent.zoomToBounds(),i&&n.call(this)}},onAdd:function(e){this._map=e;var t,n,i;if(!isFinite(this._map.getMaxZoom()))throw"Map has no maxZoom specified";for(this._featureGroup.addTo(e),this._nonPointGroup.addTo(e),this._gridClusters||this._generateInitialClusters(),this._maxLat=e.options.crs.projection.MAX_LATITUDE,t=0,n=this._needsRemoving.length;t<n;t++)i=this._needsRemoving[t],this._removeLayer(i,!0);this._needsRemoving=[],this._zoom=this._map.getZoom(),this._currentShownBounds=this._getExpandedVisibleBounds(),this._map.on("zoomend",this._zoomEnd,this),this._map.on("moveend",this._moveEnd,this),this._spiderfierOnAdd&&this._spiderfierOnAdd(),this._bindEvents(),n=this._needsClustering,this._needsClustering=[],this.addLayers(n)},onRemove:function(e){e.off("zoomend",this._zoomEnd,this),e.off("moveend",this._moveEnd,this),this._unbindEvents(),this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim",""),this._spiderfierOnRemove&&this._spiderfierOnRemove(),delete this._maxLat,this._hideCoverage(),this._featureGroup.remove(),this._nonPointGroup.remove(),this._featureGroup.clearLayers(),this._map=null},getVisibleParent:function(e){for(var t=e;t&&!t._icon;)t=t.__parent;return t||null},_arraySplice:function(e,t){for(var n=e.length-1;n>=0;n--)if(e[n]===t)return e.splice(n,1),!0},_removeFromGridUnclustered:function(e,t){for(var n=this._map,i=this._gridUnclustered;t>=0&&i[t].removeObject(e,n.project(e.getLatLng(),t));t--);},_childMarkerMoved:function(e){this._ignoreMove||(e.target._latlng=e.oldLatLng,this.removeLayer(e.target),e.target._latlng=e.latlng,this.addLayer(e.target))},_removeLayer:function(e,t,n){var i=this._gridClusters,o=this._gridUnclustered,r=this._featureGroup,a=this._map;t&&this._removeFromGridUnclustered(e,this._maxZoom);var s,l=e.__parent,u=l._markers;for(this._arraySplice(u,e);l&&(l._childCount--,l._boundsNeedUpdate=!0,!(l._zoom<0));)t&&l._childCount<=1?(s=l._markers[0]===e?l._markers[1]:l._markers[0],i[l._zoom].removeObject(l,a.project(l._cLatLng,l._zoom)),o[l._zoom].addObject(s,a.project(s.getLatLng(),l._zoom)),this._arraySplice(l.__parent._childClusters,l),l.__parent._markers.push(s),s.__parent=l.__parent,l._icon&&(r.removeLayer(l),n||r.addLayer(s))):n&&l._icon||l._updateIcon(),l=l.__parent;delete e.__parent},_isOrIsParent:function(e,t){for(;t;){if(e===t)return!0;t=t.parentNode}return!1},fire:function(e,t,n){if(t&&t.layer instanceof L.MarkerCluster){if(t.originalEvent&&this._isOrIsParent(t.layer._icon,t.originalEvent.relatedTarget))return;e="cluster"+e}L.FeatureGroup.prototype.fire.call(this,e,t,n)},listens:function(e,t){return L.FeatureGroup.prototype.listens.call(this,e,t)||L.FeatureGroup.prototype.listens.call(this,"cluster"+e,t)},_defaultIconCreateFunction:function(e){var t=e.getChildCount(),n=" marker-cluster-";return n+=t<10?"small":t<100?"medium":"large",new L.DivIcon({html:"<div><span>"+t+"</span></div>",className:"marker-cluster"+n,iconSize:new L.Point(40,40)})},_bindEvents:function(){var e=this._map,t=this.options.spiderfyOnMaxZoom,n=this.options.showCoverageOnHover,i=this.options.zoomToBoundsOnClick;(t||i)&&this.on("clusterclick",this._zoomOrSpiderfy,this),n&&(this.on("clustermouseover",this._showCoverage,this),this.on("clustermouseout",this._hideCoverage,this),e.on("zoomend",this._hideCoverage,this))},_zoomOrSpiderfy:function(e){for(var t=e.layer,n=t;1===n._childClusters.length;)n=n._childClusters[0];n._zoom===this._maxZoom&&n._childCount===t._childCount&&this.options.spiderfyOnMaxZoom?t.spiderfy():this.options.zoomToBoundsOnClick&&t.zoomToBounds(),e.originalEvent&&13===e.originalEvent.keyCode&&this._map._container.focus()},_showCoverage:function(e){var t=this._map;this._inZoomAnimation||(this._shownPolygon&&t.removeLayer(this._shownPolygon),e.layer.getChildCount()>2&&e.layer!==this._spiderfied&&(this._shownPolygon=new L.Polygon(e.layer.getConvexHull(),this.options.polygonOptions),t.addLayer(this._shownPolygon)))},_hideCoverage:function(){this._shownPolygon&&(this._map.removeLayer(this._shownPolygon),this._shownPolygon=null)},_unbindEvents:function(){var e=this.options.spiderfyOnMaxZoom,t=this.options.showCoverageOnHover,n=this.options.zoomToBoundsOnClick,i=this._map;(e||n)&&this.off("clusterclick",this._zoomOrSpiderfy,this),t&&(this.off("clustermouseover",this._showCoverage,this),this.off("clustermouseout",this._hideCoverage,this),i.off("zoomend",this._hideCoverage,this))},_zoomEnd:function(){this._map&&(this._mergeSplitClusters(),this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds())},_moveEnd:function(){if(!this._inZoomAnimation){var e=this._getExpandedVisibleBounds();this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,this._zoom,e),this._topClusterLevel._recursivelyAddChildrenToMap(null,Math.round(this._map._zoom),e),this._currentShownBounds=e}},_generateInitialClusters:function(){var e=this._map.getMaxZoom(),t=this.options.maxClusterRadius,n=t;"function"!=typeof t&&(n=function(){return t}),this.options.disableClusteringAtZoom&&(e=this.options.disableClusteringAtZoom-1),this._maxZoom=e,this._gridClusters={},this._gridUnclustered={};for(var i=e;i>=0;i--)this._gridClusters[i]=new L.DistanceGrid(n(i)),this._gridUnclustered[i]=new L.DistanceGrid(n(i));this._topClusterLevel=new this._markerCluster(this,-1)},_addLayer:function(e,t){var n,i,o=this._gridClusters,r=this._gridUnclustered;for(this.options.singleMarkerMode&&this._overrideMarkerIcon(e),e.on("move",this._childMarkerMoved,this);t>=0;t--){n=this._map.project(e.getLatLng(),t);var a=o[t].getNearObject(n);if(a)return a._addChild(e),void(e.__parent=a);if(a=r[t].getNearObject(n)){var s=a.__parent;s&&this._removeLayer(a,!1);var l=new this._markerCluster(this,t,a,e);o[t].addObject(l,this._map.project(l._cLatLng,t)),a.__parent=l,e.__parent=l;var u=l;for(i=t-1;i>s._zoom;i--)u=new this._markerCluster(this,i,u),o[i].addObject(u,this._map.project(a.getLatLng(),i));return s._addChild(u),void this._removeFromGridUnclustered(a,t)}r[t].addObject(e,n)}this._topClusterLevel._addChild(e),e.__parent=this._topClusterLevel},_enqueue:function(e){this._queue.push(e),this._queueTimeout||(this._queueTimeout=setTimeout(L.bind(this._processQueue,this),300))},_processQueue:function(){for(var e=0;e<this._queue.length;e++)this._queue[e].call(this);this._queue.length=0,clearTimeout(this._queueTimeout),this._queueTimeout=null},_mergeSplitClusters:function(){var e=Math.round(this._map._zoom);this._processQueue(),this._zoom<e&&this._currentShownBounds.intersects(this._getExpandedVisibleBounds())?(this._animationStart(),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,this._zoom,this._getExpandedVisibleBounds()),this._animationZoomIn(this._zoom,e)):this._zoom>e?(this._animationStart(),this._animationZoomOut(this._zoom,e)):this._moveEnd()},_getExpandedVisibleBounds:function(){return this.options.removeOutsideVisibleBounds?L.Browser.mobile?this._checkBoundsMaxLat(this._map.getBounds()):this._checkBoundsMaxLat(this._map.getBounds().pad(1)):this._mapBoundsInfinite},_checkBoundsMaxLat:function(e){var t=this._maxLat;return t!==n&&(e.getNorth()>=t&&(e._northEast.lat=1/0),e.getSouth()<=-t&&(e._southWest.lat=-(1/0))),e},_animationAddLayerNonAnimated:function(e,t){if(t===e)this._featureGroup.addLayer(e);else if(2===t._childCount){t._addToMap();var n=t.getAllChildMarkers();this._featureGroup.removeLayer(n[0]),this._featureGroup.removeLayer(n[1])}else t._updateIcon()},_extractNonGroupLayers:function(e,t){var n,i=e.getLayers(),o=0;for(t=t||[];o<i.length;o++)n=i[o],n instanceof L.LayerGroup?this._extractNonGroupLayers(n,t):t.push(n);return t},_overrideMarkerIcon:function(e){var t=e.options.icon=this.options.iconCreateFunction({getChildCount:function(){return 1},getAllChildMarkers:function(){return[e]}});return t}}),L.MarkerClusterGroup.include({_mapBoundsInfinite:new L.LatLngBounds(new L.LatLng(-(1/0),-(1/0)),new L.LatLng(1/0,1/0))}),L.MarkerClusterGroup.include({_noAnimation:{_animationStart:function(){},_animationZoomIn:function(e,t){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,e),this._topClusterLevel._recursivelyAddChildrenToMap(null,t,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationZoomOut:function(e,t){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,e),this._topClusterLevel._recursivelyAddChildrenToMap(null,t,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationAddLayer:function(e,t){this._animationAddLayerNonAnimated(e,t)}},_withAnimation:{_animationStart:function(){this._map._mapPane.className+=" leaflet-cluster-anim",this._inZoomAnimation++},_animationZoomIn:function(e,t){var n,i=this._getExpandedVisibleBounds(),o=this._featureGroup;this._ignoreMove=!0,this._topClusterLevel._recursively(i,e,0,function(r){var a,s=r._latlng,l=r._markers;for(i.contains(s)||(s=null),r._isSingleParent()&&e+1===t?(o.removeLayer(r),r._recursivelyAddChildrenToMap(null,t,i)):(r.clusterHide(),r._recursivelyAddChildrenToMap(s,t,i)),n=l.length-1;n>=0;n--)a=l[n],i.contains(a._latlng)||o.removeLayer(a)}),this._forceLayout(),this._topClusterLevel._recursivelyBecomeVisible(i,t),o.eachLayer(function(e){e instanceof L.MarkerCluster||!e._icon||e.clusterShow()}),this._topClusterLevel._recursively(i,e,t,function(e){e._recursivelyRestoreChildPositions(t)}),this._ignoreMove=!1,this._enqueue(function(){this._topClusterLevel._recursively(i,e,0,function(e){o.removeLayer(e),e.clusterShow()}),this._animationEnd()})},_animationZoomOut:function(e,t){this._animationZoomOutSingle(this._topClusterLevel,e-1,t),this._topClusterLevel._recursivelyAddChildrenToMap(null,t,this._getExpandedVisibleBounds()),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,e,this._getExpandedVisibleBounds())},_animationAddLayer:function(e,t){var n=this,i=this._featureGroup;i.addLayer(e),t!==e&&(t._childCount>2?(t._updateIcon(),this._forceLayout(),this._animationStart(),e._setPos(this._map.latLngToLayerPoint(t.getLatLng())),e.clusterHide(),this._enqueue(function(){i.removeLayer(e),e.clusterShow(),n._animationEnd()})):(this._forceLayout(),n._animationStart(),n._animationZoomOutSingle(t,this._map.getMaxZoom(),this._map.getZoom())))}},_animationZoomOutSingle:function(e,t,n){var i=this._getExpandedVisibleBounds();e._recursivelyAnimateChildrenInAndAddSelfToMap(i,t+1,n);var o=this;this._forceLayout(),e._recursivelyBecomeVisible(i,n),this._enqueue(function(){if(1===e._childCount){var r=e._markers[0];this._ignoreMove=!0,r.setLatLng(r.getLatLng()),this._ignoreMove=!1,r.clusterShow&&r.clusterShow()}else e._recursively(i,n,0,function(e){e._recursivelyRemoveChildrenFromMap(i,t+1)});o._animationEnd()})},_animationEnd:function(){this._map&&(this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim","")),this._inZoomAnimation--,this.fire("animationend")},_forceLayout:function(){L.Util.falseFn(t.body.offsetWidth)}}),L.markerClusterGroup=function(e){return new L.MarkerClusterGroup(e)},L.MarkerCluster=L.Marker.extend({initialize:function(e,t,n,i){L.Marker.prototype.initialize.call(this,n?n._cLatLng||n.getLatLng():new L.LatLng(0,0),{icon:this}),this._group=e,this._zoom=t,this._markers=[],this._childClusters=[],this._childCount=0,this._iconNeedsUpdate=!0,this._boundsNeedUpdate=!0,this._bounds=new L.LatLngBounds,n&&this._addChild(n),i&&this._addChild(i)},getAllChildMarkers:function(e){e=e||[];for(var t=this._childClusters.length-1;t>=0;t--)this._childClusters[t].getAllChildMarkers(e);for(var n=this._markers.length-1;n>=0;n--)e.push(this._markers[n]);return e},getChildCount:function(){return this._childCount},zoomToBounds:function(){for(var e,t=this._childClusters.slice(),n=this._group._map,i=n.getBoundsZoom(this._bounds),o=this._zoom+1,r=n.getZoom();t.length>0&&i>o;){o++;var a=[];for(e=0;e<t.length;e++)a=a.concat(t[e]._childClusters);t=a}i>o?this._group._map.setView(this._latlng,o):i<=r?this._group._map.setView(this._latlng,r+1):this._group._map.fitBounds(this._bounds)},getBounds:function(){var e=new L.LatLngBounds;return e.extend(this._bounds),e},_updateIcon:function(){this._iconNeedsUpdate=!0,this._icon&&this.setIcon(this)},createIcon:function(){return this._iconNeedsUpdate&&(this._iconObj=this._group.options.iconCreateFunction(this),this._iconNeedsUpdate=!1),this._iconObj.createIcon()},createShadow:function(){return this._iconObj.createShadow()},_addChild:function(e,t){this._iconNeedsUpdate=!0,this._boundsNeedUpdate=!0,this._setClusterCenter(e),e instanceof L.MarkerCluster?(t||(this._childClusters.push(e),e.__parent=this),this._childCount+=e._childCount):(t||this._markers.push(e),this._childCount++),this.__parent&&this.__parent._addChild(e,!0)},_setClusterCenter:function(e){this._cLatLng||(this._cLatLng=e._cLatLng||e._latlng)},_resetBounds:function(){var e=this._bounds;e._southWest&&(e._southWest.lat=1/0,e._southWest.lng=1/0),e._northEast&&(e._northEast.lat=-(1/0),e._northEast.lng=-(1/0))},_recalculateBounds:function(){var e,t,n,i,o=this._markers,r=this._childClusters,a=0,s=0,l=this._childCount;if(0!==l){for(this._resetBounds(),e=0;e<o.length;e++)n=o[e]._latlng,this._bounds.extend(n),a+=n.lat,s+=n.lng;for(e=0;e<r.length;e++)t=r[e],t._boundsNeedUpdate&&t._recalculateBounds(),this._bounds.extend(t._bounds),n=t._wLatLng,i=t._childCount,a+=n.lat*i,s+=n.lng*i;this._latlng=this._wLatLng=new L.LatLng(a/l,s/l),this._boundsNeedUpdate=!1}},_addToMap:function(e){e&&(this._backupLatlng=this._latlng,this.setLatLng(e)),this._group._featureGroup.addLayer(this)},_recursivelyAnimateChildrenIn:function(e,t,n){this._recursively(e,0,n-1,function(e){var n,i,o=e._markers;for(n=o.length-1;n>=0;n--)i=o[n],i._icon&&(i._setPos(t),i.clusterHide())},function(e){var n,i,o=e._childClusters;for(n=o.length-1;n>=0;n--)i=o[n],i._icon&&(i._setPos(t),i.clusterHide())})},_recursivelyAnimateChildrenInAndAddSelfToMap:function(e,t,n){this._recursively(e,n,0,function(i){i._recursivelyAnimateChildrenIn(e,i._group._map.latLngToLayerPoint(i.getLatLng()).round(),t),i._isSingleParent()&&t-1===n?(i.clusterShow(),i._recursivelyRemoveChildrenFromMap(e,t)):i.clusterHide(),i._addToMap()})},_recursivelyBecomeVisible:function(e,t){this._recursively(e,0,t,null,function(e){e.clusterShow()})},_recursivelyAddChildrenToMap:function(e,t,n){this._recursively(n,-1,t,function(i){if(t!==i._zoom)for(var o=i._markers.length-1;o>=0;o--){var r=i._markers[o];n.contains(r._latlng)&&(e&&(r._backupLatlng=r.getLatLng(),r.setLatLng(e),r.clusterHide&&r.clusterHide()),i._group._featureGroup.addLayer(r))}},function(t){t._addToMap(e)})},_recursivelyRestoreChildPositions:function(e){for(var t=this._markers.length-1;t>=0;t--){var n=this._markers[t];n._backupLatlng&&(n.setLatLng(n._backupLatlng),delete n._backupLatlng)}if(e-1===this._zoom)for(var i=this._childClusters.length-1;i>=0;i--)this._childClusters[i]._restorePosition();else for(var o=this._childClusters.length-1;o>=0;o--)this._childClusters[o]._recursivelyRestoreChildPositions(e)},_restorePosition:function(){this._backupLatlng&&(this.setLatLng(this._backupLatlng),delete this._backupLatlng)},_recursivelyRemoveChildrenFromMap:function(e,t,n){var i,o;this._recursively(e,-1,t-1,function(e){for(o=e._markers.length-1;o>=0;o--)i=e._markers[o],n&&n.contains(i._latlng)||(e._group._featureGroup.removeLayer(i),i.clusterShow&&i.clusterShow())},function(e){for(o=e._childClusters.length-1;o>=0;o--)i=e._childClusters[o],n&&n.contains(i._latlng)||(e._group._featureGroup.removeLayer(i),i.clusterShow&&i.clusterShow())})},_recursively:function(e,t,n,i,o){var r,a,s=this._childClusters,l=this._zoom;if(t>l)for(r=s.length-1;r>=0;r--)a=s[r],
e.intersects(a._bounds)&&a._recursively(e,t,n,i,o);else if(i&&i(this),o&&this._zoom===n&&o(this),n>l)for(r=s.length-1;r>=0;r--)a=s[r],e.intersects(a._bounds)&&a._recursively(e,t,n,i,o)},_isSingleParent:function(){return this._childClusters.length>0&&this._childClusters[0]._childCount===this._childCount}}),L.Marker.include({clusterHide:function(){return this.options.opacityWhenUnclustered=this.options.opacity||1,this.setOpacity(0)},clusterShow:function(){var e=this.setOpacity(this.options.opacity||this.options.opacityWhenUnclustered);return delete this.options.opacityWhenUnclustered,e}}),L.DistanceGrid=function(e){this._cellSize=e,this._sqCellSize=e*e,this._grid={},this._objectPoint={}},L.DistanceGrid.prototype={addObject:function(e,t){var n=this._getCoord(t.x),i=this._getCoord(t.y),o=this._grid,r=o[i]=o[i]||{},a=r[n]=r[n]||[],s=L.Util.stamp(e);this._objectPoint[s]=t,a.push(e)},updateObject:function(e,t){this.removeObject(e),this.addObject(e,t)},removeObject:function(e,t){var n,i,o=this._getCoord(t.x),r=this._getCoord(t.y),a=this._grid,s=a[r]=a[r]||{},l=s[o]=s[o]||[];for(delete this._objectPoint[L.Util.stamp(e)],n=0,i=l.length;n<i;n++)if(l[n]===e)return l.splice(n,1),1===i&&delete s[o],!0},eachObject:function(e,t){var n,i,o,r,a,s,l,u=this._grid;for(n in u){a=u[n];for(i in a)for(s=a[i],o=0,r=s.length;o<r;o++)l=e.call(t,s[o]),l&&(o--,r--)}},getNearObject:function(e){var t,n,i,o,r,a,s,l,u=this._getCoord(e.x),c=this._getCoord(e.y),d=this._objectPoint,p=this._sqCellSize,h=null;for(t=c-1;t<=c+1;t++)if(o=this._grid[t])for(n=u-1;n<=u+1;n++)if(r=o[n])for(i=0,a=r.length;i<a;i++)s=r[i],l=this._sqDist(d[L.Util.stamp(s)],e),l<p&&(p=l,h=s);return h},_getCoord:function(e){return Math.floor(e/this._cellSize)},_sqDist:function(e,t){var n=t.x-e.x,i=t.y-e.y;return n*n+i*i}},function(){L.QuickHull={getDistant:function(e,t){var n=t[1].lat-t[0].lat,i=t[0].lng-t[1].lng;return i*(e.lat-t[0].lat)+n*(e.lng-t[0].lng)},findMostDistantPointFromBaseLine:function(e,t){var n,i,o,r=0,a=null,s=[];for(n=t.length-1;n>=0;n--)i=t[n],o=this.getDistant(i,e),o>0&&(s.push(i),o>r&&(r=o,a=i));return{maxPoint:a,newPoints:s}},buildConvexHull:function(e,t){var n=[],i=this.findMostDistantPointFromBaseLine(e,t);return i.maxPoint?(n=n.concat(this.buildConvexHull([e[0],i.maxPoint],i.newPoints)),n=n.concat(this.buildConvexHull([i.maxPoint,e[1]],i.newPoints))):[e[0]]},getConvexHull:function(e){var t,n=!1,i=!1,o=!1,r=!1,a=null,s=null,l=null,u=null,c=null,d=null;for(t=e.length-1;t>=0;t--){var p=e[t];(n===!1||p.lat>n)&&(a=p,n=p.lat),(i===!1||p.lat<i)&&(s=p,i=p.lat),(o===!1||p.lng>o)&&(l=p,o=p.lng),(r===!1||p.lng<r)&&(u=p,r=p.lng)}i!==n?(d=s,c=a):(d=u,c=l);var h=[].concat(this.buildConvexHull([d,c],e),this.buildConvexHull([c,d],e));return h}}}(),L.MarkerCluster.include({getConvexHull:function(){var e,t,n=this.getAllChildMarkers(),i=[];for(t=n.length-1;t>=0;t--)e=n[t].getLatLng(),i.push(e);return L.QuickHull.getConvexHull(i)}}),L.MarkerCluster.include({_2PI:2*Math.PI,_circleFootSeparation:25,_circleStartAngle:Math.PI/6,_spiralFootSeparation:28,_spiralLengthStart:11,_spiralLengthFactor:5,_circleSpiralSwitchover:9,spiderfy:function(){if(this._group._spiderfied!==this&&!this._group._inZoomAnimation){var e,t=this.getAllChildMarkers(),n=this._group,i=n._map,o=i.latLngToLayerPoint(this._latlng);this._group._unspiderfy(),this._group._spiderfied=this,t.length>=this._circleSpiralSwitchover?e=this._generatePointsSpiral(t.length,o):(o.y+=10,e=this._generatePointsCircle(t.length,o)),this._animationSpiderfy(t,e)}},unspiderfy:function(e){this._group._inZoomAnimation||(this._animationUnspiderfy(e),this._group._spiderfied=null)},_generatePointsCircle:function(e,t){var n,i,o=this._group.options.spiderfyDistanceMultiplier*this._circleFootSeparation*(2+e),r=o/this._2PI,a=this._2PI/e,s=[];for(s.length=e,n=e-1;n>=0;n--)i=this._circleStartAngle+n*a,s[n]=new L.Point(t.x+r*Math.cos(i),t.y+r*Math.sin(i))._round();return s},_generatePointsSpiral:function(e,t){var n,i=this._group.options.spiderfyDistanceMultiplier,o=i*this._spiralLengthStart,r=i*this._spiralFootSeparation,a=i*this._spiralLengthFactor*this._2PI,s=0,l=[];for(l.length=e,n=e-1;n>=0;n--)s+=r/o+5e-4*n,l[n]=new L.Point(t.x+o*Math.cos(s),t.y+o*Math.sin(s))._round(),o+=a/s;return l},_noanimationUnspiderfy:function(){var e,t,n=this._group,i=n._map,o=n._featureGroup,r=this.getAllChildMarkers();for(n._ignoreMove=!0,this.setOpacity(1),t=r.length-1;t>=0;t--)e=r[t],o.removeLayer(e),e._preSpiderfyLatlng&&(e.setLatLng(e._preSpiderfyLatlng),delete e._preSpiderfyLatlng),e.setZIndexOffset&&e.setZIndexOffset(0),e._spiderLeg&&(i.removeLayer(e._spiderLeg),delete e._spiderLeg);n.fire("unspiderfied",{cluster:this,markers:r}),n._ignoreMove=!1,n._spiderfied=null}}),L.MarkerClusterNonAnimated=L.MarkerCluster.extend({_animationSpiderfy:function(e,t){var n,i,o,r,a=this._group,s=a._map,l=a._featureGroup,u=this._group.options.spiderLegPolylineOptions;for(a._ignoreMove=!0,n=0;n<e.length;n++)r=s.layerPointToLatLng(t[n]),i=e[n],o=new L.Polyline([this._latlng,r],u),s.addLayer(o),i._spiderLeg=o,i._preSpiderfyLatlng=i._latlng,i.setLatLng(r),i.setZIndexOffset&&i.setZIndexOffset(1e6),l.addLayer(i);this.setOpacity(.3),a._ignoreMove=!1,a.fire("spiderfied",{cluster:this,markers:e})},_animationUnspiderfy:function(){this._noanimationUnspiderfy()}}),L.MarkerCluster.include({_animationSpiderfy:function(e,t){var i,o,r,a,s,l,u=this,c=this._group,d=c._map,p=c._featureGroup,h=this._latlng,f=d.latLngToLayerPoint(h),g=L.Path.SVG,m=L.extend({},this._group.options.spiderLegPolylineOptions),_=m.opacity;for(_===n&&(_=L.MarkerClusterGroup.prototype.options.spiderLegPolylineOptions.opacity),g?(m.opacity=0,m.className=(m.className||"")+" leaflet-cluster-spider-leg"):m.opacity=_,c._ignoreMove=!0,i=0;i<e.length;i++)o=e[i],l=d.layerPointToLatLng(t[i]),r=new L.Polyline([h,l],m),d.addLayer(r),o._spiderLeg=r,g&&(a=r._path,s=a.getTotalLength()+.1,a.style.strokeDasharray=s,a.style.strokeDashoffset=s),o.setZIndexOffset&&o.setZIndexOffset(1e6),o.clusterHide&&o.clusterHide(),p.addLayer(o),o._setPos&&o._setPos(f);for(c._forceLayout(),c._animationStart(),i=e.length-1;i>=0;i--)l=d.layerPointToLatLng(t[i]),o=e[i],o._preSpiderfyLatlng=o._latlng,o.setLatLng(l),o.clusterShow&&o.clusterShow(),g&&(r=o._spiderLeg,a=r._path,a.style.strokeDashoffset=0,r.setStyle({opacity:_}));this.setOpacity(.3),c._ignoreMove=!1,setTimeout(function(){c._animationEnd(),c.fire("spiderfied",{cluster:u,markers:e})},200)},_animationUnspiderfy:function(e){var t,n,i,o,r,a,s=this,l=this._group,u=l._map,c=l._featureGroup,d=e?u._latLngToNewLayerPoint(this._latlng,e.zoom,e.center):u.latLngToLayerPoint(this._latlng),p=this.getAllChildMarkers(),h=L.Path.SVG;for(l._ignoreMove=!0,l._animationStart(),this.setOpacity(1),n=p.length-1;n>=0;n--)t=p[n],t._preSpiderfyLatlng&&(t.setLatLng(t._preSpiderfyLatlng),delete t._preSpiderfyLatlng,a=!0,t._setPos&&(t._setPos(d),a=!1),t.clusterHide&&(t.clusterHide(),a=!1),a&&c.removeLayer(t),h&&(i=t._spiderLeg,o=i._path,r=o.getTotalLength()+.1,o.style.strokeDashoffset=r,i.setStyle({opacity:0})));l._ignoreMove=!1,setTimeout(function(){var e=0;for(n=p.length-1;n>=0;n--)t=p[n],t._spiderLeg&&e++;for(n=p.length-1;n>=0;n--)t=p[n],t._spiderLeg&&(t.clusterShow&&t.clusterShow(),t.setZIndexOffset&&t.setZIndexOffset(0),e>1&&c.removeLayer(t),u.removeLayer(t._spiderLeg),delete t._spiderLeg);l._animationEnd(),l.fire("unspiderfied",{cluster:s,markers:p})},200)}}),L.MarkerClusterGroup.include({_spiderfied:null,unspiderfy:function(){this._unspiderfy.apply(this,arguments)},_spiderfierOnAdd:function(){this._map.on("click",this._unspiderfyWrapper,this),this._map.options.zoomAnimation&&this._map.on("zoomstart",this._unspiderfyZoomStart,this),this._map.on("zoomend",this._noanimationUnspiderfy,this),L.Browser.touch||this._map.getRenderer(this)},_spiderfierOnRemove:function(){this._map.off("click",this._unspiderfyWrapper,this),this._map.off("zoomstart",this._unspiderfyZoomStart,this),this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._map.off("zoomend",this._noanimationUnspiderfy,this),this._noanimationUnspiderfy()},_unspiderfyZoomStart:function(){this._map&&this._map.on("zoomanim",this._unspiderfyZoomAnim,this)},_unspiderfyZoomAnim:function(e){L.DomUtil.hasClass(this._map._mapPane,"leaflet-touching")||(this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._unspiderfy(e))},_unspiderfyWrapper:function(){this._unspiderfy()},_unspiderfy:function(e){this._spiderfied&&this._spiderfied.unspiderfy(e)},_noanimationUnspiderfy:function(){this._spiderfied&&this._spiderfied._noanimationUnspiderfy()},_unspiderfyLayer:function(e){e._spiderLeg&&(this._featureGroup.removeLayer(e),e.clusterShow&&e.clusterShow(),e.setZIndexOffset&&e.setZIndexOffset(0),this._map.removeLayer(e._spiderLeg),delete e._spiderLeg)}}),L.MarkerClusterGroup.include({refreshClusters:function(e){return e?e instanceof L.MarkerClusterGroup?e=e._topClusterLevel.getAllChildMarkers():e instanceof L.LayerGroup?e=e._layers:e instanceof L.MarkerCluster?e=e.getAllChildMarkers():e instanceof L.Marker&&(e=[e]):e=this._topClusterLevel.getAllChildMarkers(),this._flagParentsIconsNeedUpdate(e),this._refreshClustersIcons(),this.options.singleMarkerMode&&this._refreshSingleMarkerModeMarkers(e),this},_flagParentsIconsNeedUpdate:function(e){var t,n;for(t in e)for(n=e[t].__parent;n;)n._iconNeedsUpdate=!0,n=n.__parent},_refreshClustersIcons:function(){this._featureGroup.eachLayer(function(e){e instanceof L.MarkerCluster&&e._iconNeedsUpdate&&e._updateIcon()})},_refreshSingleMarkerModeMarkers:function(e){var t,n;for(t in e)n=e[t],this.hasLayer(n)&&n.setIcon(this._overrideMarkerIcon(n))}}),L.Marker.include({refreshIconOptions:function(e,t){var n=this.options.icon;return L.setOptions(n,e),this.setIcon(n),t&&this.__parent&&this.__parent._group.refreshClusters(this),this}})}(window,document)},184:function(e,t){"use strict";L.NonTiledLayer=L.Layer.extend({includes:L.Evented,options:{attribution:"",opacity:1,zIndex:void 0,minZoom:0,maxZoom:18,pointerEvents:null,errorImageUrl:"data:image/gif;base64,R0lGODlhAQABAHAAACH5BAUAAAAALAAAAAABAAEAAAICRAEAOw==",bounds:L.latLngBounds([-85.05,-180],[85.05,180])},url:"",initialize:function(e){L.setOptions(this,e)},onAdd:function(e){this._map=e,this._div||(this._div=L.DomUtil.create("div","leaflet-image-layer"),this.options.pointerEvents&&(this._div.style["pointer-events"]=this.options.pointerEvents),void 0!==this.options.zIndex&&(this._div.style.zIndex=this.options.zIndex),void 0!==this.options.opacity&&(this._div.style.opacity=this.options.opacity)),this.getPane().appendChild(this._div),this._bufferImage=this._initImage(),this._currentImage=this._initImage(),this._update()},onRemove:function(e){this.getPane().removeChild(this._div),this._div.removeChild(this._bufferImage),this._div.removeChild(this._currentImage)},addTo:function(e){return e.addLayer(this),this},getEvents:function(){var e={moveend:this._update,zoom:this._viewreset};return this._zoomAnimated&&(e.zoomanim=this._animateZoom),e},getElement:function(){return this._div},setOpacity:function(e){return this.options.opacity=e,this._div&&L.DomUtil.setOpacity(this._div,this.options.opacity),this},setZIndex:function(e){return e&&(this.options.zIndex=e,this._div&&(this._div.style.zIndex=e)),this},bringToFront:function(){return this._div&&this._pane.appendChild(this._div),this},bringToBack:function(){return this._div&&this._pane.insertBefore(this._div,this._pane.firstChild),this},getAttribution:function(){return this.options.attribution},_initImage:function(e){var e=L.DomUtil.create("img","leaflet-image-layer");return this._div.appendChild(e),this._map.options.zoomAnimation&&L.Browser.any3d?L.DomUtil.addClass(e,"leaflet-zoom-animated"):L.DomUtil.addClass(e,"leaflet-zoom-hide"),L.extend(e,{galleryimg:"no",onselectstart:L.Util.falseFn,onmousemove:L.Util.falseFn,onload:L.bind(this._onImageLoad,this),onerror:L.bind(this._onImageError,this)}),e},redraw:function(){return this._map&&this._update(),this},_animateZoom:function(e){this._currentImage._bounds&&this._animateImage(this._currentImage,e),this._bufferImage._bounds&&this._animateImage(this._bufferImage,e)},_animateImage:function(e,t){var n=this._map.getZoomScale(t.zoom),i=this._map._latLngToNewLayerPoint(e._bounds.getNorthWest(),t.zoom,t.center);L.DomUtil.setTransform(e,i,n)},_resetImage:function(e){var t=new L.Bounds(this._map.latLngToLayerPoint(e._bounds.getNorthWest()),this._map.latLngToLayerPoint(e._bounds.getSouthEast())),n=t.getSize();L.DomUtil.setPosition(e,t.min),e.style.width=n.x+"px",e.style.height=n.y+"px"},_getClippedBounds:function(){var e=this._map.getBounds(),t=e.getSouth(),n=e.getNorth(),i=e.getWest(),o=e.getEast(),r=this.options.bounds.getSouth(),a=this.options.bounds.getNorth(),s=this.options.bounds.getWest(),l=this.options.bounds.getEast();t<r&&(t=r),n>a&&(n=a),i<s&&(i=s),o>l&&(o=l);var u=new L.LatLng(n,i),c=new L.LatLng(t,o);return new L.LatLngBounds(u,c)},_viewreset:function(){this._bufferImage._bounds&&this._resetImage(this._bufferImage),this._currentImage._bounds&&this._resetImage(this._currentImage)},_update:function(){if(this._map.getZoom()<this.options.minZoom||this._map.getZoom()>this.options.maxZoom)return void(this._div.style.visibility="hidden");this._div.style.visibility="visible",this._bufferImage._bounds&&this._resetImage(this._bufferImage);var e=this._getClippedBounds(),t=this._map.latLngToContainerPoint(e.getNorthWest()),n=this._map.latLngToContainerPoint(e.getSouthEast()),i=n.x-t.x,o=n.y-t.y;if(!(i<32||o<32)){this._currentImage._bounds=e,this._resetImage(this._currentImage);var r=this._currentImage;this.getImageUrl?r.src=this.getImageUrl(e.getNorthWest(),e.getSouthEast(),i,o):this.getImageUrlAsync(e.getNorthWest(),e.getSouthEast(),i,o,function(e,t){r.src=e,r.tag=t}),this.url=r.src,L.DomUtil.setOpacity(this._currentImage,0)}},_onImageError:function(e){this.fire("error",e),L.DomUtil.addClass(e.target,"invalid"),e.target.src!==this.options.errorImageUrl&&(e.target.src=this.options.errorImageUrl,this._onImageDone(!1,e))},_onImageLoad:function(e){if(e.target.src!==this.options.errorImageUrl){if(L.DomUtil.removeClass(e.target,"invalid"),e.target.src!==this.url)return;this._onImageDone(!0,e)}},_onImageDone:function(e,t){L.DomUtil.setOpacity(this._currentImage,1),L.DomUtil.setOpacity(this._bufferImage,0),this._addInteraction&&this._addInteraction(this._currentImage.tag);var n=this._bufferImage;this._bufferImage=this._currentImage,this._currentImage=n,this.fire("load",t)}}),L.nonTiledLayer=function(){return new L.NonTiledLayer},L.NonTiledLayer.WMS=L.NonTiledLayer.extend({defaultWmsParams:{service:"WMS",request:"GetMap",version:"1.1.1",layers:"",styles:"",format:"image/jpeg",transparent:!1},options:{crs:null,uppercase:!1},initialize:function(e,t){this._wmsUrl=e;var n=L.extend({},this.defaultWmsParams);for(var i in t)L.NonTiledLayer.prototype.options.hasOwnProperty(i)||L.Layer.prototype.options.hasOwnProperty(i)||(n[i]=t[i]);this.wmsParams=n,L.setOptions(this,t)},onAdd:function(e){this._crs=this.options.crs||e.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var t=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[t]=this._crs.code,L.NonTiledLayer.prototype.onAdd.call(this,e)},getImageUrl:function(e,t,n,i){var o=this.wmsParams;o.width=n,o.height=i;var r=this._crs.project(e),a=this._crs.project(t),s=this._wmsUrl,l=l=(this._wmsVersion>=1.3&&this._crs===L.CRS.EPSG4326?[a.y,r.x,r.y,a.x]:[r.x,a.y,a.x,r.y]).join(",");return s+L.Util.getParamString(this.wmsParams,s,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+l},setParams:function(e,t){return L.extend(this.wmsParams,e),t||this.redraw(),this}}),L.nonTiledLayer.wms=function(e,t){return new L.NonTiledLayer.WMS(e,t)}},185:function(e,t){"use strict";Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(e){if(null==this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var t=Object(this),n=t.length>>>0,i=arguments[1],o=0;o!==n;o++)if(e.call(i,this[o],o,t))return this[o]}})},186:function(e,t){"use strict";Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(e){if(null==this)throw new TypeError('"this" is null or not defined');var t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var i=arguments[1],o=0;o<n;){var r=t[o];if(e.call(i,r,o,t))return o;o++}return-1}})},187:function(e,t){"use strict";String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return this.substr(t||0,e.length)===e})},189:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(){var e=window.location.href.split(":")[0]+"://"+l.default.RL_ENTI_SERVICE;return a.default.get(e).then(function(e){return e.data.data})}Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var r=n(13),a=i(r),s=n(5),l=i(s)},190:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=e.layer.config,n="M"+t.idMap,i=u.default.DEFAULT_PROXY+t.wfsParams.url.replace("/"+n,"")+"service=WFS&version=2.0.0&request=GetFeature&srsName=EPSG%3A4326&outputFormat=application%2Fjson",o=t.cachePostGIS?t.infoOptions.infoIdAttr.toLowerCase():t.infoOptions.infoIdAttr;return i+"&typeName="+n+":"+t.wfsParams.typeName+"&cql_filter="+o+"="+e.properties[t.infoOptions.infoIdAttr]}function r(e){var t=o(e),n={};return s.default.get(t,{params:n}).then(function(e){return e.data.features})}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var a=n(13),s=i(a),l=n(5),u=i(l)},191:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e){var t={};return a.default.get(e,{params:t}).then(function(e){return e.data.features})}Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var r=n(13),a=i(r)},192:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){return a.default.get("/geoservices/REST/config/xsl_info_service?",{headers:{Accept:"text/xml"},params:{xslUrl:e,ambiente:null,idLayer:t.layerName.replace("L",""),featureAttributes:t.properties}}).then(function(e){return e.data}).then(function(e){return(0,l.default)(e)})}Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var r=n(13),a=i(r),s=n(95),l=i(s)},193:function(e,t,n){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function r(e){var t={};return s.default.get(e,{params:t})}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var a=n(13),s=o(a),l=n(44),u=(i(l),n(5));o(u)},196:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.elType||"div",n=e.containerId||"gv-container",i=e.elId,o=e.clear;o&&document.getElementById(i)&&document.getElementById(i).remove();var r=document.createElement(t);return r.id=i,document.getElementById(n)?document.getElementById(n).appendChild(r):(console.log("Elemento "+n+" non trovato faccio mount su body"),document.body.appendChild(r)),r}},197:function(e,t){"use strict";function n(){return window.location.href.split(":")[0]}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n},198:function(e,t){"use strict";function n(e){var t=12;return(e<=2e3||null==e)&&(t=17),e>2e3&&e<=6250&&(t=16),e>6250&&e<=12500&&(t=15),e>12500&&e<=25e3&&(t=14),e>25e3&&e<=5e4&&(t=13),t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n},199:function(e,t){"use strict";function n(e){var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(window.location.href);return t?decodeURIComponent(t[1]):null}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n},200:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=a.default.BASE_SCALES.findIndex(function(t){return e>t});return t-1}Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var r=n(5),a=i(r)},201:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=/\{ *([\w_\-]+) *\}/g;return e.replace(n,function(e,n){var i=t[n];if(void 0===i)throw new Error("No value provided for variable "+e);return"function"==typeof i&&(i=i(t)),i})}},202:function(e,t){"use strict";function n(){return navigator.userAgent.indexOf("MSIE ")>0||navigator.userAgent.indexOf("Trident")>0||navigator.userAgent.indexOf("Edge")>0}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n},203:function(e,t){"use strict";function n(){return window.matchMedia("(pointer: coarse)").matches}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n},204:function(e,t){"use strict";function n(e){GV.config.debug&&console.log(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n},290:function(e,t){},295:function(e,t){},296:function(e,t){},303:function(e,t){},304:function(e,t){},305:function(e,t){},311:function(e,t){},312:function(e,t){},315:function(e,t){},316:function(e,t){},318:function(e,t,n){var i=n(295);"string"==typeof i&&(i=[[e.id,i,""]]);n(54)(i,{});i.locals&&(e.exports=i.locals)},319:function(e,t,n){var i=n(296);"string"==typeof i&&(i=[[e.id,i,""]]);n(54)(i,{});i.locals&&(e.exports=i.locals)},320:function(e,t,n){var i=n(315);"string"==typeof i&&(i=[[e.id,i,""]]);n(54)(i,{});i.locals&&(e.exports=i.locals)},321:function(e,t,n){var i=n(316);"string"==typeof i&&(i=[[e.id,i,""]]);n(54)(i,{});i.locals&&(e.exports=i.locals)},327:function(e,t,n){var i,o;n(305),i=n(160);var r=n(345);o=i=i||{},"object"!=typeof i.default&&"function"!=typeof i.default||(o=i=i.default),"function"==typeof o&&(o=o.options),o.render=r.render,o.staticRenderFns=r.staticRenderFns,e.exports=i},329:function(e,t,n){var i,o;n(303),i=n(162);var r=n(343);o=i=i||{},"object"!=typeof i.default&&"function"!=typeof i.default||(o=i=i.default),"function"==typeof o&&(o=o.options),o.render=r.render,o.staticRenderFns=r.staticRenderFns,o._scopeId="data-v-3f78502f",e.exports=i},334:function(e,t,n){var i,o;n(312),i=n(168);var r=n(352);o=i=i||{},"object"!=typeof i.default&&"function"!=typeof i.default||(o=i=i.default),"function"==typeof o&&(o=o.options),o.render=r.render,o.staticRenderFns=r.staticRenderFns,e.exports=i},335:function(e,t,n){var i,o;n(304),i=n(169);var r=n(344);o=i=i||{},"object"!=typeof i.default&&"function"!=typeof i.default||(o=i=i.default),"function"==typeof o&&(o=o.options),o.render=r.render,o.staticRenderFns=r.staticRenderFns,o._scopeId="data-v-4020fcaa",e.exports=i},343:function(e,t){e.exports={render:function(){var e=this;e.$createElement;return e._c("div",{style:e.style,attrs:{id:"gv-header"}},[e._t("default")],2)},staticRenderFns:[]}},344:function(e,t){e.exports={render:function(){var e=this;e.$createElement;return e._c("div",{style:e.style,attrs:{id:"gv-map"}},[e._c("gv-info-wms-manager",{ref:"info"})],1)},staticRenderFns:[]}},345:function(e,t){e.exports={render:function(){var e=this;e.$createElement;return e._c("div",{attrs:{id:"gv-container"}},[e.showHeader?e._c("gv-header"):e._e(),e._v(" "),e._c("gv-map",{ref:"gv-map"}),e._v(" "),e._c("div",{directives:[{name:"show",rawName:"v-show",value:e.showTitle,expression:"showTitle"}],staticClass:"gv-color-scheme",attrs:{id:"gv-title"}},[e._v(e._s(this.getTitle()))]),e._v(" "),e.showLegend?e._c("gv-legend",{ref:"gv-legend"}):e._e()],1)},staticRenderFns:[]}},351:function(e,t){e.exports={render:function(){var e=this;e.$createElement;return e._c("div")},staticRenderFns:[]}},352:function(e,t){e.exports={render:function(){var e=this;e.$createElement;return e._c("div",{staticClass:"gv-inverted-color-scheme",attrs:{id:"gv-legend"}},[e._c("div",{staticClass:"gv-legend-title gv-color-scheme"},[e._c("b",[e._v("LEGENDA")]),e._v(" "),e._c("button",{staticClass:"gv-legend-close",attrs:{type:"button"},on:{click:e.hideLegend}},[e._v("×")]),e._v(" "),e._c("el-button",{directives:[{name:"show",rawName:"v-show",value:e.options.showAddMap,expression:"options.showAddMap"}],staticClass:"gv-inverted-color-scheme gv-legend-buttons ms ms-layers-add",attrs:{title:"Aggiungi Mappe",type:"primary",size:"mini"},on:{click:e.addMap}})],1),e._v(" "),e._c("div",{staticClass:"gv-legend-wrapper",attrs:{id:"gv-legend-wrapper"}},[e._c("div",{attrs:{id:"gv-legend-body"}},e._l(e.maps,function(t){return e._c("ul",{key:t.id,staticClass:"gv-list-group"},[e._c("div",{staticClass:"gv-list-legend-map-item gv-inverted-color-scheme"},[e._c("li",[e._v("\n                        "+e._s(t.name)+"\n                    ")]),e._v(" "),e._c("div",{staticClass:"gv-legend-map-tools gv-inverted-color-scheme"},[e.checkAddMap(t)?e._c("el-button",{staticClass:"gv-legend-map-tools-add fa fa-file-text-o",attrs:{title:"Visualizza scheda",type:"primary",size:"mini"},on:{click:function(n){e.showMapInfoPanel(t)}}}):e._e(),e._v(" "),e.isDownloadable(t)?e._c("el-button",{staticClass:"gv-button-download fa fa-download",attrs:{title:"Download",type:"primary",size:"mini"},on:{click:function(n){e.download(t)}}}):e._e(),e._v(" "),e._c("el-button",{staticClass:"gv-legend-map-tools-add fa fa-trash",attrs:{title:"Cancella",type:"primary",size:"mini"},on:{click:function(n){e.remove(t)}}}),e._v(" "),e._c("el-button",{staticClass:"gv-legend-map-tools-add ms ms-transparency",attrs:{title:"Trasparenza Livelli",type:"primary",size:"mini"},on:{click:function(n){e.layerTransparency(t)}}})],1)]),e._v(" "),e._c("ul",{staticClass:"gv-list-group"},e._l(t.layers,function(t){return e._c("li",{key:t.id,class:e.getClass(t),attrs:{layer:t}},[e._c("img",{staticClass:"gv-legend-layer-icon",attrs:{src:e.iconUrl(t)},on:{click:function(n){e.showLegendPanel(t)}}}),e._v(" "),e._c("span",{staticClass:"gv-layer-visibility-span"},[e._c("input",{directives:[{name:"model",rawName:"v-model",value:t.visible,expression:"layer.visible"}],staticClass:"gv-layer-visibility-cb",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.visible)?e._i(t.visible,null)>-1:t.visible},on:{click:function(n){e.setLayerVisible(t,n)},change:function(n){var i=t.visible,o=n.target,r=!!o.checked;if(Array.isArray(i)){var a=null,s=e._i(i,a);o.checked?s<0&&(t.visible=i.concat([a])):s>-1&&(t.visible=i.slice(0,s).concat(i.slice(s+1)))}else e.$set(t,"visible",r)}}})]),e._v(" "),e._c("span",{staticClass:"gv-layer-title-span"},[e._v(e._s(t.legend.label))])])}))])})),e._v(" "),e._c("div",{staticClass:"gv-legend-footer gv-inverted-color-scheme"},[e._c("gv-base-layer-switcher",{directives:[{name:"show",rawName:"v-show",value:e.options.showBaseLayerSwitcher,expression:"options.showBaseLayerSwitcher"}],ref:"gv-base-layer-switcher"})],1)])])},staticRenderFns:[]}},355:function(e,t,n){function i(e){return n(o(e))}function o(e){return r[e]||function(){throw new Error("Cannot find module '"+e+"'.")}()}var r={"./div.js":174,"./fullscreen.js":175,"./geocoder.js":176,"./locate.js":177,"./scalebar.js":178,"./search.js":179,"./zoom.js":180};i.keys=function(){return Object.keys(r)},i.resolve=o,e.exports=i,i.id=355},356:function(e,t){}});
//# sourceMappingURL=GV.js.map